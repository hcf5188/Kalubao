; generated by Component: ARM Compiler 5.04 update 1 (build 49) Tool: ArmCC [5040049]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o..\obj\obdtask.o --asm_dir=.\Listings\ --list_dir=.\Listings\ --depend=..\obj\obdtask.d --cpu=Cortex-M3 --apcs=interwork -O0 -I..\OBD -I..\SYSTEM -I..\USER -I..\LIB\inc -I..\UCOSII\CONFIG -I..\UCOSII\PORT -I..\UCOSII\CORE -I..\HAEDWARE -I..\GPS -I..\CDMA -I..\DEAL -ID:\Keil_v5\ARM\RV31\INC -ID:\Keil_v5\ARM\PACK\ARM\CMSIS\4.1.1\CMSIS\Include -ID:\Keil_v5\ARM\Inc\ST\STM32F10x -D__MICROLIB -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER --omf_browse=..\obj\obdtask.crf ..\OBD\OBDTask.c]
                          THUMB

                          AREA ||i.CANTestChannel||, CODE, READONLY, ALIGN=2

                  CANTestChannel PROC
;;;7      
;;;8      void CANTestChannel(void )
000000  b510              PUSH     {r4,lr}
;;;9      {
;;;10     	int i;
;;;11     
;;;12     	dataToSend.testIsOK = 0;
000002  2000              MOVS     r0,#0
000004  4923              LDR      r1,|L1.148|
000006  7208              STRB     r0,[r1,#8]
;;;13     	
;;;14     	for(i=0;i<NUMOFCAN;i++)
000008  2400              MOVS     r4,#0
00000a  e03f              B        |L1.140|
                  |L1.12|
;;;15     	{
;;;16     		CAN1_BaudSet(CANSearchLib[i].canBaud);
00000c  4922              LDR      r1,|L1.152|
00000e  eb0101c4          ADD      r1,r1,r4,LSL #3
000012  7948              LDRB     r0,[r1,#5]
000014  f7fffffe          BL       CAN1_BaudSet
;;;17     		CAN1_ClearFilter();
000018  f7fffffe          BL       CAN1_ClearFilter
;;;18     		
;;;19     		CAN1_TxMsg.IDE     = CANSearchLib[i].canIde;
00001c  481e              LDR      r0,|L1.152|
00001e  eb0000c4          ADD      r0,r0,r4,LSL #3
000022  7900              LDRB     r0,[r0,#4]
000024  491d              LDR      r1,|L1.156|
000026  7208              STRB     r0,[r1,#8]
;;;20     		CAN1_TxMsg.StdId   = CANSearchLib[i].canId.dword;
000028  481b              LDR      r0,|L1.152|
00002a  f8500034          LDR      r0,[r0,r4,LSL #3]
00002e  6008              STR      r0,[r1,#0]  ; CAN1_TxMsg
;;;21     		CAN1_TxMsg.DLC     = 0x08;
000030  2008              MOVS     r0,#8
000032  7288              STRB     r0,[r1,#0xa]
;;;22     		
;;;23     		CAN1_TxMsg.Data[0] = 0x02;
000034  2002              MOVS     r0,#2
000036  72c8              STRB     r0,[r1,#0xb]
;;;24     		CAN1_TxMsg.Data[1] = 0x01;
000038  2101              MOVS     r1,#1
00003a  4818              LDR      r0,|L1.156|
00003c  7301              STRB     r1,[r0,#0xc]
;;;25     		CAN1_TxMsg.Data[2] = 0x0D;
00003e  210d              MOVS     r1,#0xd
000040  7341              STRB     r1,[r0,#0xd]
;;;26     		CAN1_TxMsg.Data[3] = 0x00;
000042  2100              MOVS     r1,#0
000044  7381              STRB     r1,[r0,#0xe]
;;;27     		CAN1_TxMsg.Data[4] = 0x00;
000046  73c1              STRB     r1,[r0,#0xf]
;;;28     		CAN1_TxMsg.Data[5] = 0x00;
000048  7401              STRB     r1,[r0,#0x10]
;;;29     		CAN1_TxMsg.Data[6] = 0x00;
00004a  7441              STRB     r1,[r0,#0x11]
;;;30     		CAN1_TxMsg.Data[7] = 0x00;
00004c  7481              STRB     r1,[r0,#0x12]
;;;31     		CAN_Transmit(CAN1,&CAN1_TxMsg);
00004e  4601              MOV      r1,r0
000050  4813              LDR      r0,|L1.160|
000052  f7fffffe          BL       CAN_Transmit
;;;32     
;;;33     		dataToSend.canId = CANSearchLib[i].canId.dword;
000056  4810              LDR      r0,|L1.152|
000058  f8500034          LDR      r0,[r0,r4,LSL #3]
00005c  490d              LDR      r1,|L1.148|
00005e  6008              STR      r0,[r1,#0]  ; dataToSend
;;;34     		dataToSend.ide   = CANSearchLib[i].canIde;
000060  480d              LDR      r0,|L1.152|
000062  eb0000c4          ADD      r0,r0,r4,LSL #3
000066  7900              LDRB     r0,[r0,#4]
000068  6048              STR      r0,[r1,#4]  ; dataToSend
;;;35     		OSTimeDlyHMSM(0,0,0,100);   //仿真板的回复时间比较长，有的达到60ms以上，故需要延时时间长一点。
00006a  2364              MOVS     r3,#0x64
00006c  2200              MOVS     r2,#0
00006e  4611              MOV      r1,r2
000070  4610              MOV      r0,r2
000072  f7fffffe          BL       OSTimeDlyHMSM
;;;36     		if(dataToSend.testIsOK == 1)//CAN数据测试通过
000076  4807              LDR      r0,|L1.148|
000078  7a00              LDRB     r0,[r0,#8]  ; dataToSend
00007a  2801              CMP      r0,#1
00007c  d100              BNE      |L1.128|
;;;37     			break;
00007e  e007              B        |L1.144|
                  |L1.128|
;;;38     		else if(i == (NUMOFCAN - 1))
000080  2c03              CMP      r4,#3
000082  d102              BNE      |L1.138|
;;;39     			dataToSend.testIsOK = 2;
000084  2002              MOVS     r0,#2
000086  4903              LDR      r1,|L1.148|
000088  7208              STRB     r0,[r1,#8]
                  |L1.138|
00008a  1c64              ADDS     r4,r4,#1              ;14
                  |L1.140|
00008c  2c04              CMP      r4,#4                 ;14
00008e  dbbd              BLT      |L1.12|
                  |L1.144|
000090  bf00              NOP                            ;37
;;;40     	}
;;;41     }
000092  bd10              POP      {r4,pc}
;;;42     uint8_t a[8] = {0x02,0x01,0x0D,0x00,0x00,0x00,0x00,0x00};
                          ENDP

                  |L1.148|
                          DCD      dataToSend
                  |L1.152|
                          DCD      CANSearchLib
                  |L1.156|
                          DCD      CAN1_TxMsg
                  |L1.160|
                          DCD      0x40006400

                          AREA ||i.OBDTask||, CODE, READONLY, ALIGN=2

                  OBDTask PROC
;;;44     
;;;45     void OBDTask(void *pdata)
000000  2300              MOVS     r3,#0
;;;46     {
;;;47     	OSTimeDlyHMSM(0,0,2,0);
000002  2202              MOVS     r2,#2
000004  4619              MOV      r1,r3
000006  4618              MOV      r0,r3
000008  f7fffffe          BL       OSTimeDlyHMSM
;;;48     	CANTestChannel();
00000c  f7fffffe          BL       CANTestChannel
;;;49     	dataToSend.pdat = a;
000010  4810              LDR      r0,|L2.84|
000012  4911              LDR      r1,|L2.88|
000014  60c8              STR      r0,[r1,#0xc]  ; dataToSend
;;;50     	
;;;51     	while(1)
000016  e01b              B        |L2.80|
                  |L2.24|
;;;52     	{
;;;53     		GPIO_ResetBits(GPIO_LED,LED_GPIO_OBD);
000018  2120              MOVS     r1,#0x20
00001a  4810              LDR      r0,|L2.92|
00001c  f7fffffe          BL       GPIO_ResetBits
;;;54     		OSTimeDlyHMSM(0,0,0,150);
000020  2396              MOVS     r3,#0x96
000022  2200              MOVS     r2,#0
000024  4611              MOV      r1,r2
000026  4610              MOV      r0,r2
000028  f7fffffe          BL       OSTimeDlyHMSM
;;;55     		GPIO_SetBits(GPIO_LED,LED_GPIO_OBD);
00002c  2120              MOVS     r1,#0x20
00002e  480b              LDR      r0,|L2.92|
000030  f7fffffe          BL       GPIO_SetBits
;;;56     		OSTimeDlyHMSM(0,0,0,150);
000034  2396              MOVS     r3,#0x96
000036  2200              MOVS     r2,#0
000038  4611              MOV      r1,r2
00003a  4610              MOV      r0,r2
00003c  f7fffffe          BL       OSTimeDlyHMSM
;;;57     		if(dataToSend.testIsOK == 1)
000040  4805              LDR      r0,|L2.88|
000042  7a00              LDRB     r0,[r0,#8]  ; dataToSend
000044  2801              CMP      r0,#1
000046  d103              BNE      |L2.80|
;;;58     			OBD_CAN_SendData(dataToSend);
000048  4803              LDR      r0,|L2.88|
00004a  c80f              LDM      r0,{r0-r3}
00004c  f7fffffe          BL       OBD_CAN_SendData
                  |L2.80|
000050  e7e2              B        |L2.24|
;;;59     	}
;;;60     }
;;;61     
                          ENDP

000052  0000              DCW      0x0000
                  |L2.84|
                          DCD      a
                  |L2.88|
                          DCD      dataToSend
                  |L2.92|
                          DCD      0x40010c00

                          AREA ||.bss||, DATA, NOINIT, ALIGN=2

                  CAN1_TxMsg
                          %        20
                  dataToSend
                          %        16

                          AREA ||.data||, DATA, ALIGN=0

                  a
000000  02010d00          DCB      0x02,0x01,0x0d,0x00
000004  00000000          DCB      0x00,0x00,0x00,0x00

;*** Start embedded assembler ***

#line 1 "..\\OBD\\OBDTask.c"
	AREA ||.rev16_text||, CODE
	THUMB
	EXPORT |__asm___9_OBDTask_c_bb9fee60____REV16|
#line 129 "D:\\Keil_v5\\ARM\\PACK\\ARM\\CMSIS\\4.1.1\\CMSIS\\Include\\core_cmInstr.h"
|__asm___9_OBDTask_c_bb9fee60____REV16| PROC
#line 130

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE
	THUMB
	EXPORT |__asm___9_OBDTask_c_bb9fee60____REVSH|
#line 144
|__asm___9_OBDTask_c_bb9fee60____REVSH| PROC
#line 145

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
