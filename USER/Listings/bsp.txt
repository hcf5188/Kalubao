; generated by ARM C/C++ Compiler, 5.03 [Build 76]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o..\obj\bsp.o --asm_dir=.\Listings\ --list_dir=.\Listings\ --depend=..\obj\bsp.d --cpu=Cortex-M3 --apcs=interwork -O0 -I..\OBD -I..\SYSTEM -I..\USER -I..\LIB\inc -I..\UCOSII\CONFIG -I..\UCOSII\PORT -I..\UCOSII\CORE -I..\HAEDWARE -I..\GPS -I..\CDMA -I..\DEAL -ID:\Keil_v4\ARM\RV31\INC -ID:\Keil_v4\ARM\CMSIS\Include -ID:\Keil_v4\ARM\Inc\ST\STM32F10x -D__MICROLIB -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER --omf_browse=..\obj\bsp.crf ..\HAEDWARE\bsp.c]
                          THUMB

                          AREA ||i.BspClockInit||, CODE, READONLY, ALIGN=2

                  BspClockInit PROC
;;;23     //使能外设时钟
;;;24     void BspClockInit(void)
000000  b510              PUSH     {r4,lr}
;;;25     {
;;;26     	RCC_AHBPeriphClockCmd(RCC_AHBPeriph_DMA1, ENABLE);
000002  2101              MOVS     r1,#1
000004  4608              MOV      r0,r1
000006  f7fffffe          BL       RCC_AHBPeriphClockCmd
;;;27     	
;;;28     	//RCC_APB1Periph_CAN1	
;;;29     	RCC_APB1PeriphClockCmd(RCC_APB1Periph_USART2   \
00000a  2101              MOVS     r1,#1
00000c  4804              LDR      r0,|L1.32|
00000e  f7fffffe          BL       RCC_APB1PeriphClockCmd
;;;30     							|RCC_APB1Periph_USART3 \
;;;31     							|RCC_APB1Periph_UART4  \
;;;32     							|RCC_APB1Periph_I2C1   \
;;;33     							|RCC_APB1Periph_TIM2   \
;;;34     							|RCC_APB1Periph_TIM3, ENABLE);
;;;35     
;;;36       	RCC_APB2PeriphClockCmd(RCC_APB2Periph_USART1
000012  2101              MOVS     r1,#1
000014  f245201d          MOV      r0,#0x521d
000018  f7fffffe          BL       RCC_APB2PeriphClockCmd
;;;37     							|RCC_APB2Periph_GPIOA 
;;;38     							|RCC_APB2Periph_GPIOB 
;;;39     							|RCC_APB2Periph_GPIOC
;;;40     							|RCC_APB2Periph_AFIO
;;;41     							|RCC_APB2Periph_SPI1
;;;42     							|RCC_APB2Periph_ADC1, ENABLE);
;;;43     }
00001c  bd10              POP      {r4,pc}
;;;44     
                          ENDP

00001e  0000              DCW      0x0000
                  |L1.32|
                          DCD      0x002e0003

                          AREA ||i.CDMAUart2Init||, CODE, READONLY, ALIGN=2

                  CDMAUart2Init PROC
;;;63     
;;;64     void CDMAUart2Init(void)
000000  b500              PUSH     {lr}
;;;65     {
000002  b087              SUB      sp,sp,#0x1c
;;;66     	GPIO_InitTypeDef GPIO_InitStructure;
;;;67     	NVIC_InitTypeDef NVIC_InitStructure;
;;;68     	USART_InitTypeDef USART_InitStructure;
;;;69     	
;;;70     	//GPRS 模块复位按钮默认L
;;;71     	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_12;//GPIOB_12
000004  f44f5080          MOV      r0,#0x1000
000008  f8ad0018          STRH     r0,[sp,#0x18]
;;;72     	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;
00000c  2010              MOVS     r0,#0x10
00000e  f88d001b          STRB     r0,[sp,#0x1b]
;;;73     	GPIO_Init(GPIOB, &GPIO_InitStructure);
000012  a906              ADD      r1,sp,#0x18
000014  4836              LDR      r0,|L2.240|
000016  f7fffffe          BL       GPIO_Init
;;;74     	GPIO_SetBits(GPIOB, GPIO_Pin_12);
00001a  f44f5180          MOV      r1,#0x1000
00001e  4834              LDR      r0,|L2.240|
000020  f7fffffe          BL       GPIO_SetBits
;;;75     
;;;76     	
;;;77     	//GPRS 电源
;;;78     	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_15;
000024  f44f4000          MOV      r0,#0x8000
000028  f8ad0018          STRH     r0,[sp,#0x18]
;;;79     	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;
00002c  2010              MOVS     r0,#0x10
00002e  f88d001b          STRB     r0,[sp,#0x1b]
;;;80     	GPIO_Init(GPIOB, &GPIO_InitStructure);
000032  a906              ADD      r1,sp,#0x18
000034  482e              LDR      r0,|L2.240|
000036  f7fffffe          BL       GPIO_Init
;;;81     	GPIO_SetBits(GPIOB, GPIO_Pin_15);
00003a  f44f4100          MOV      r1,#0x8000
00003e  482c              LDR      r0,|L2.240|
000040  f7fffffe          BL       GPIO_SetBits
;;;82     
;;;83     
;;;84     	//GPRS Status 状态
;;;85     	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_13;
000044  f44f5000          MOV      r0,#0x2000
000048  f8ad0018          STRH     r0,[sp,#0x18]
;;;86     	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
00004c  2003              MOVS     r0,#3
00004e  f88d001a          STRB     r0,[sp,#0x1a]
;;;87     	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING;
000052  2004              MOVS     r0,#4
000054  f88d001b          STRB     r0,[sp,#0x1b]
;;;88     	GPIO_Init(GPIOB, &GPIO_InitStructure);
000058  a906              ADD      r1,sp,#0x18
00005a  4825              LDR      r0,|L2.240|
00005c  f7fffffe          BL       GPIO_Init
;;;89     	
;;;90     	//USART2 RX
;;;91     	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_3;
000060  2008              MOVS     r0,#8
000062  f8ad0018          STRH     r0,[sp,#0x18]
;;;92     	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING;
000066  2004              MOVS     r0,#4
000068  f88d001b          STRB     r0,[sp,#0x1b]
;;;93     	GPIO_Init(GPIOA, &GPIO_InitStructure);
00006c  a906              ADD      r1,sp,#0x18
00006e  4821              LDR      r0,|L2.244|
000070  f7fffffe          BL       GPIO_Init
;;;94     
;;;95     	//USART2 TX
;;;96     	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_2;
000074  2004              MOVS     r0,#4
000076  f8ad0018          STRH     r0,[sp,#0x18]
;;;97     	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;
00007a  2018              MOVS     r0,#0x18
00007c  f88d001b          STRB     r0,[sp,#0x1b]
;;;98     	GPIO_Init(GPIOA, &GPIO_InitStructure);
000080  a906              ADD      r1,sp,#0x18
000082  481c              LDR      r0,|L2.244|
000084  f7fffffe          BL       GPIO_Init
;;;99     	
;;;100    	USART_InitStructure.USART_BaudRate            = 115200  ;
000088  f44f30e1          MOV      r0,#0x1c200
00008c  9001              STR      r0,[sp,#4]
;;;101    	USART_InitStructure.USART_WordLength          = USART_WordLength_8b;
00008e  2000              MOVS     r0,#0
000090  f8ad0008          STRH     r0,[sp,#8]
;;;102    	USART_InitStructure.USART_StopBits            = USART_StopBits_1;
000094  f8ad000a          STRH     r0,[sp,#0xa]
;;;103    	USART_InitStructure.USART_Parity              = USART_Parity_No ;
000098  f8ad000c          STRH     r0,[sp,#0xc]
;;;104    	USART_InitStructure.USART_HardwareFlowControl = USART_HardwareFlowControl_None;
00009c  f8ad0010          STRH     r0,[sp,#0x10]
;;;105    	USART_InitStructure.USART_Mode                = USART_Mode_Rx | USART_Mode_Tx;	
0000a0  200c              MOVS     r0,#0xc
0000a2  f8ad000e          STRH     r0,[sp,#0xe]
;;;106    	USART_Init(USART2, &USART_InitStructure);
0000a6  a901              ADD      r1,sp,#4
0000a8  4813              LDR      r0,|L2.248|
0000aa  f7fffffe          BL       USART_Init
;;;107    	
;;;108    	USART_ITConfig(USART2, USART_IT_RXNE, ENABLE);
0000ae  2201              MOVS     r2,#1
0000b0  f2405125          MOV      r1,#0x525
0000b4  4810              LDR      r0,|L2.248|
0000b6  f7fffffe          BL       USART_ITConfig
;;;109    	USART_ITConfig(USART2, USART_IT_TC, ENABLE);
0000ba  2201              MOVS     r2,#1
0000bc  f2406126          MOV      r1,#0x626
0000c0  480d              LDR      r0,|L2.248|
0000c2  f7fffffe          BL       USART_ITConfig
;;;110    	USART_Cmd(USART2, ENABLE); 
0000c6  2101              MOVS     r1,#1
0000c8  480b              LDR      r0,|L2.248|
0000ca  f7fffffe          BL       USART_Cmd
;;;111    	
;;;112    	NVIC_InitStructure.NVIC_IRQChannel = USART2_IRQn;
0000ce  2026              MOVS     r0,#0x26
0000d0  f88d0014          STRB     r0,[sp,#0x14]
;;;113    	NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 2;
0000d4  2002              MOVS     r0,#2
0000d6  f88d0015          STRB     r0,[sp,#0x15]
;;;114    	NVIC_InitStructure.NVIC_IRQChannelSubPriority = 4;
0000da  2004              MOVS     r0,#4
0000dc  f88d0016          STRB     r0,[sp,#0x16]
;;;115    	NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
0000e0  2001              MOVS     r0,#1
0000e2  f88d0017          STRB     r0,[sp,#0x17]
;;;116    	NVIC_Init(&NVIC_InitStructure);
0000e6  a805              ADD      r0,sp,#0x14
0000e8  f7fffffe          BL       NVIC_Init
;;;117    }
0000ec  b007              ADD      sp,sp,#0x1c
0000ee  bd00              POP      {pc}
;;;118    
                          ENDP

                  |L2.240|
                          DCD      0x40010c00
                  |L2.244|
                          DCD      0x40010800
                  |L2.248|
                          DCD      0x40004400

                          AREA ||i.GPIOLEDInit||, CODE, READONLY, ALIGN=2

                  GPIOLEDInit PROC
;;;44     
;;;45     void GPIOLEDInit(void)
000000  b508              PUSH     {r3,lr}
;;;46     {
;;;47     	GPIO_InitTypeDef  GPIO_InitStructure;
;;;48     	RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB, ENABLE);	 //使能PB端口时钟
000002  2101              MOVS     r1,#1
000004  2008              MOVS     r0,#8
000006  f7fffffe          BL       RCC_APB2PeriphClockCmd
;;;49     	
;;;50     //  禁用JTAG接口，采用SWD接口进行调试（恢复PB3、PB4的IO功能）
;;;51     	RCC_APB2PeriphClockCmd(RCC_APB2Periph_AFIO, ENABLE);
00000a  2101              MOVS     r1,#1
00000c  4608              MOV      r0,r1
00000e  f7fffffe          BL       RCC_APB2PeriphClockCmd
;;;52     	GPIO_PinRemapConfig(GPIO_Remap_SWJ_JTAGDisable , ENABLE);
000012  2101              MOVS     r1,#1
000014  480a              LDR      r0,|L3.64|
000016  f7fffffe          BL       GPIO_PinRemapConfig
;;;53     //	GPIO_PinRemapConfig(GPIO_Remap_SWJ_Disable, ENABLE);
;;;54     
;;;55     	GPIO_InitStructure.GPIO_Pin   = GPIO_Pin_3 | GPIO_Pin_4 | GPIO_Pin_5; //LED 端口配置
00001a  2038              MOVS     r0,#0x38
00001c  f8ad0000          STRH     r0,[sp,#0]
;;;56     	GPIO_InitStructure.GPIO_Mode  = GPIO_Mode_Out_PP; 		 //推挽输出
000020  2010              MOVS     r0,#0x10
000022  f88d0003          STRB     r0,[sp,#3]
;;;57     	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;		 //IO口速度为50MHz
000026  2003              MOVS     r0,#3
000028  f88d0002          STRB     r0,[sp,#2]
;;;58     	GPIO_Init(GPIOB, &GPIO_InitStructure);					 //根据设定参数初始化GPIOB.5
00002c  4669              MOV      r1,sp
00002e  4805              LDR      r0,|L3.68|
000030  f7fffffe          BL       GPIO_Init
;;;59     
;;;60     	GPIO_ResetBits(GPIOB,GPIO_Pin_3 | GPIO_Pin_5|GPIO_Pin_4);		     //复位，双灯亮
000034  2138              MOVS     r1,#0x38
000036  4803              LDR      r0,|L3.68|
000038  f7fffffe          BL       GPIO_ResetBits
;;;61     }
00003c  bd08              POP      {r3,pc}
;;;62     
                          ENDP

00003e  0000              DCW      0x0000
                  |L3.64|
                          DCD      0x00300200
                  |L3.68|
                          DCD      0x40010c00

                          AREA ||i.KLineInit||, CODE, READONLY, ALIGN=2

                  KLineInit PROC
;;;118    
;;;119    void KLineInit(void )
000000  b500              PUSH     {lr}
;;;120    {
000002  b087              SUB      sp,sp,#0x1c
;;;121    	GPIO_InitTypeDef  GPIO_InitStructure;
;;;122    	NVIC_InitTypeDef NVIC_InitStructure;
;;;123    	USART_InitTypeDef USART_InitStructure;
;;;124    	
;;;125    	
;;;126    	//USART3 RX
;;;127    	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_KWP_RX;
000004  f44f6000          MOV      r0,#0x800
000008  f8ad0018          STRH     r0,[sp,#0x18]
;;;128      	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING;
00000c  2004              MOVS     r0,#4
00000e  f88d001b          STRB     r0,[sp,#0x1b]
;;;129      	GPIO_Init(GPIOB, &GPIO_InitStructure);
000012  a906              ADD      r1,sp,#0x18
000014  4820              LDR      r0,|L4.152|
000016  f7fffffe          BL       GPIO_Init
;;;130    	//USART3 TX
;;;131    	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_KWP_TX;
00001a  f44f6080          MOV      r0,#0x400
00001e  f8ad0018          STRH     r0,[sp,#0x18]
;;;132      	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;
000022  2018              MOVS     r0,#0x18
000024  f88d001b          STRB     r0,[sp,#0x1b]
;;;133      	GPIO_Init(GPIOB, &GPIO_InitStructure);
000028  a906              ADD      r1,sp,#0x18
00002a  481b              LDR      r0,|L4.152|
00002c  f7fffffe          BL       GPIO_Init
;;;134    	
;;;135    	USART_InitStructure.USART_BaudRate            = 10400  ;		  //KWP2000 波特率10400
000030  f64200a0          MOV      r0,#0x28a0
000034  9001              STR      r0,[sp,#4]
;;;136    	USART_InitStructure.USART_WordLength          = USART_WordLength_8b;
000036  2000              MOVS     r0,#0
000038  f8ad0008          STRH     r0,[sp,#8]
;;;137    	USART_InitStructure.USART_StopBits            = USART_StopBits_1;
00003c  f8ad000a          STRH     r0,[sp,#0xa]
;;;138    	USART_InitStructure.USART_Parity              = USART_Parity_No ;
000040  f8ad000c          STRH     r0,[sp,#0xc]
;;;139    	USART_InitStructure.USART_HardwareFlowControl = USART_HardwareFlowControl_None;
000044  f8ad0010          STRH     r0,[sp,#0x10]
;;;140    	USART_InitStructure.USART_Mode                = USART_Mode_Rx | USART_Mode_Tx;
000048  200c              MOVS     r0,#0xc
00004a  f8ad000e          STRH     r0,[sp,#0xe]
;;;141    
;;;142    	USART_Init(USART3, &USART_InitStructure);
00004e  a901              ADD      r1,sp,#4
000050  4812              LDR      r0,|L4.156|
000052  f7fffffe          BL       USART_Init
;;;143    	USART_ITConfig(USART3, USART_IT_RXNE, ENABLE);
000056  2201              MOVS     r2,#1
000058  f2405125          MOV      r1,#0x525
00005c  480f              LDR      r0,|L4.156|
00005e  f7fffffe          BL       USART_ITConfig
;;;144    	USART_ITConfig(USART3, USART_IT_TC, ENABLE);
000062  2201              MOVS     r2,#1
000064  f2406126          MOV      r1,#0x626
000068  480c              LDR      r0,|L4.156|
00006a  f7fffffe          BL       USART_ITConfig
;;;145    	USART_Cmd(USART3, ENABLE); 
00006e  2101              MOVS     r1,#1
000070  480a              LDR      r0,|L4.156|
000072  f7fffffe          BL       USART_Cmd
;;;146    	
;;;147    	NVIC_InitStructure.NVIC_IRQChannel = USART3_IRQn;
000076  2027              MOVS     r0,#0x27
000078  f88d0014          STRB     r0,[sp,#0x14]
;;;148    	NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 2;
00007c  2002              MOVS     r0,#2
00007e  f88d0015          STRB     r0,[sp,#0x15]
;;;149    	NVIC_InitStructure.NVIC_IRQChannelSubPriority = 1;
000082  2001              MOVS     r0,#1
000084  f88d0016          STRB     r0,[sp,#0x16]
;;;150    	NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
000088  f88d0017          STRB     r0,[sp,#0x17]
;;;151    	NVIC_Init(&NVIC_InitStructure);
00008c  a805              ADD      r0,sp,#0x14
00008e  f7fffffe          BL       NVIC_Init
;;;152    }
000092  b007              ADD      sp,sp,#0x1c
000094  bd00              POP      {pc}
;;;153    
                          ENDP

000096  0000              DCW      0x0000
                  |L4.152|
                          DCD      0x40010c00
                  |L4.156|
                          DCD      0x40004800

                          AREA ||i.SysTickInit||, CODE, READONLY, ALIGN=2

                  SysTickInit PROC
;;;16     //系统时钟滴答初始化
;;;17     void SysTickInit(void)
000000  b570              PUSH     {r4-r6,lr}
;;;18     {
;;;19     	SystemCoreClockUpdate();
000002  f7fffffe          BL       SystemCoreClockUpdate
;;;20     	SysTick_CLKSourceConfig(SysTick_CLKSource_HCLK);
000006  2004              MOVS     r0,#4
000008  f7fffffe          BL       SysTick_CLKSourceConfig
;;;21     	SysTick_Config(SystemCoreClock / OS_TICKS_PER_SEC);
00000c  4813              LDR      r0,|L5.92|
00000e  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
000010  f44f72fa          MOV      r2,#0x1f4
000014  fbb0f1f2          UDIV     r1,r0,r2
000018  1e48              SUBS     r0,r1,#1
00001a  f1b07f80          CMP      r0,#0x1000000
00001e  d300              BCC      |L5.34|
000020  e01b              B        |L5.90|
                  |L5.34|
000022  1e48              SUBS     r0,r1,#1
000024  f04f22e0          MOV      r2,#0xe000e000
000028  6150              STR      r0,[r2,#0x14]
00002a  1750              ASRS     r0,r2,#29
00002c  220f              MOVS     r2,#0xf
00002e  2800              CMP      r0,#0
000030  da07              BGE      |L5.66|
000032  0713              LSLS     r3,r2,#28
000034  0e1d              LSRS     r5,r3,#24
000036  4b0a              LDR      r3,|L5.96|
000038  f000040f          AND      r4,r0,#0xf
00003c  1f24              SUBS     r4,r4,#4
00003e  551d              STRB     r5,[r3,r4]
000040  e003              B        |L5.74|
                  |L5.66|
000042  0713              LSLS     r3,r2,#28
000044  0e1c              LSRS     r4,r3,#24
000046  4b07              LDR      r3,|L5.100|
000048  541c              STRB     r4,[r3,r0]
                  |L5.74|
00004a  bf00              NOP      
00004c  2000              MOVS     r0,#0
00004e  f04f22e0          MOV      r2,#0xe000e000
000052  6190              STR      r0,[r2,#0x18]
000054  2007              MOVS     r0,#7
000056  6110              STR      r0,[r2,#0x10]
000058  bf00              NOP      
                  |L5.90|
;;;22     }
00005a  bd70              POP      {r4-r6,pc}
;;;23     //使能外设时钟
                          ENDP

                  |L5.92|
                          DCD      SystemCoreClock
                  |L5.96|
                          DCD      0xe000ed18
                  |L5.100|
                          DCD      0xe000e400

                          AREA ||i.SystemBspInit||, CODE, READONLY, ALIGN=1

                  SystemBspInit PROC
;;;6      //芯片初始化，包括系统时钟、芯片外设、时钟滴答等等
;;;7      void SystemBspInit(void )
000000  b510              PUSH     {r4,lr}
;;;8      {
;;;9      	SysTickInit();
000002  f7fffffe          BL       SysTickInit
;;;10     	BspClockInit();
000006  f7fffffe          BL       BspClockInit
;;;11     	GPIOLEDInit();
00000a  f7fffffe          BL       GPIOLEDInit
;;;12     
;;;13     	CAN1Config();
00000e  f7fffffe          BL       CAN1Config
;;;14     	
;;;15     }
000012  bd10              POP      {r4,pc}
;;;16     //系统时钟滴答初始化
                          ENDP


;*** Start embedded assembler ***

#line 1 "..\\HAEDWARE\\bsp.c"
	AREA ||.rev16_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___5_bsp_c_275da96f____REV16|
#line 129 "D:\\Keil_v4\\ARM\\CMSIS\\Include\\core_cmInstr.h"
|__asm___5_bsp_c_275da96f____REV16| PROC
#line 130

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___5_bsp_c_275da96f____REVSH|
#line 144
|__asm___5_bsp_c_275da96f____REVSH| PROC
#line 145

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
