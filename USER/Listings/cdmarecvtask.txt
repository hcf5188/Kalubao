; generated by Component: ARM Compiler 5.06 update 5 (build 528) Tool: ArmCC [4d3621]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o..\obj\cdmarecvtask.o --asm_dir=.\Listings\ --list_dir=.\Listings\ --depend=..\obj\cdmarecvtask.d --cpu=Cortex-M3 --apcs=interwork -O0 --diag_suppress=9931 -I..\OBD -I..\SYSTEM -I..\USER -I..\LIB\inc -I..\UCOSII\CONFIG -I..\UCOSII\PORT -I..\UCOSII\CORE -I..\HAEDWARE -I..\GPS -I..\CDMA -I..\DEAL -I..\USB\CONFIG -I..\USB\STM32_USB-FS-Device_Driver\inc -I.\RTE\_Project -ID:\Keil_v5\ARM\PACK\ARM\CMSIS\5.2.0\CMSIS\Include -ID:\Keil_v5\ARM\PACK\Keil\STM32F1xx_DFP\2.2.0\Device\Include -D__MICROLIB -D__UVISION_VERSION=524 -D_RTE_ -DSTM32F10X_HD -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER --omf_browse=..\obj\cdmarecvtask.crf ..\CDMA\CDMARecvTask.c]
                          THUMB

                          AREA ||i.CDMARecvTask||, CODE, READONLY, ALIGN=2

                  CDMARecvTask PROC
;;;19     //本任务用来上发登录报文、处理OTA升级、配置文件升级、模式切换（强动力模式、节油模式等）
;;;20     void CDMARecvTask(void *pdata)
000000  b508              PUSH     {r3,lr}
;;;21     {
;;;22     	uint8_t  err;
;;;23     	uint16_t cmdId;
;;;24     	uint8_t* ptrRECV = NULL;
000002  2600              MOVS     r6,#0
;;;25     	uint8_t* ptrDeal = NULL;
000004  2500              MOVS     r5,#0
;;;26     	while(1)
000006  e06f              B        |L1.232|
                  |L1.8|
;;;27     	{
;;;28     		ptrRECV = OSQPend(ZIPRecv_Q,30000,&err);  //等待60s后服务器无响应，则退出
000008  466a              MOV      r2,sp
00000a  f2475130          MOV      r1,#0x7530
00000e  4837              LDR      r0,|L1.236|
000010  6800              LDR      r0,[r0,#0]  ; ZIPRecv_Q
000012  f7fffffe          BL       OSQPend
000016  4606              MOV      r6,r0
;;;29     		if(err == OS_ERR_NONE)
000018  f89d0000          LDRB     r0,[sp,#0]
00001c  2800              CMP      r0,#0
00001e  d14b              BNE      |L1.184|
;;;30     		{
;;;31     			ptrDeal = RecvDataAnalysis(ptrRECV);  //将接收到的数据进行加工
000020  4630              MOV      r0,r6
000022  f7fffffe          BL       RecvDataAnalysis
000026  4605              MOV      r5,r0
;;;32     			if(ptrDeal == NULL)                   //接收到错误的数据
000028  b905              CBNZ     r5,|L1.44|
;;;33     				continue; 
00002a  e05d              B        |L1.232|
                  |L1.44|
;;;34     			
;;;35     			cmdId = ptrDeal[3];
00002c  78ec              LDRB     r4,[r5,#3]
;;;36     			cmdId = (cmdId<<8) + ptrDeal[4];
00002e  7928              LDRB     r0,[r5,#4]
000030  eb002004          ADD      r0,r0,r4,LSL #8
000034  b284              UXTH     r4,r0
;;;37     			
;;;38     			if(cmdId == 0x5001)                          //接收到登录报文
000036  f2450001          MOV      r0,#0x5001
00003a  4284              CMP      r4,r0
00003c  d103              BNE      |L1.70|
;;;39     				RecvLoginDatDeal(ptrDeal);
00003e  4628              MOV      r0,r5
000040  f7fffffe          BL       RecvLoginDatDeal
000044  e030              B        |L1.168|
                  |L1.70|
;;;40     			
;;;41     			else if(cmdId == 0x5015)                     //模式切换
000046  f2450015          MOV      r0,#0x5015
00004a  4284              CMP      r4,r0
00004c  d103              BNE      |L1.86|
;;;42     				FuelModeChange(ptrDeal);
00004e  4628              MOV      r0,r5
000050  f7fffffe          BL       FuelModeChange
000054  e028              B        |L1.168|
                  |L1.86|
;;;43     			
;;;44     			else if(cmdId == 0x5017)                     //服务器下发的测试指令
000056  f2450017          MOV      r0,#0x5017
00005a  4284              CMP      r4,r0
00005c  d103              BNE      |L1.102|
;;;45     				CanTestCmd(ptrDeal);
00005e  4628              MOV      r0,r5
000060  f7fffffe          BL       CanTestCmd
000064  e020              B        |L1.168|
                  |L1.102|
;;;46     			
;;;47     			else if(((cmdId >= 0x4000)&&(cmdId < 0x5000))||(cmdId == 0x5012)||(cmdId == 0x5018)) //第一、二部分的配置文件
000066  f5b44f80          CMP      r4,#0x4000
00006a  db02              BLT      |L1.114|
00006c  f5b44fa0          CMP      r4,#0x5000
000070  db06              BLT      |L1.128|
                  |L1.114|
000072  f2450012          MOV      r0,#0x5012
000076  4284              CMP      r4,r0
000078  d002              BEQ      |L1.128|
00007a  1d80              ADDS     r0,r0,#6
00007c  4284              CMP      r4,r0
00007e  d103              BNE      |L1.136|
                  |L1.128|
;;;48     				ConfigUpdata(ptrDeal);
000080  4628              MOV      r0,r5
000082  f7fffffe          BL       ConfigUpdata
000086  e00f              B        |L1.168|
                  |L1.136|
;;;49     			
;;;50     			else if((cmdId >= 0x8000)&&(cmdId < 0x9000)) //程序升级报文    
000088  f5b44f00          CMP      r4,#0x8000
00008c  db06              BLT      |L1.156|
00008e  f5b44f10          CMP      r4,#0x9000
000092  da03              BGE      |L1.156|
;;;51     				OTA_Updata(ptrDeal);
000094  4628              MOV      r0,r5
000096  f7fffffe          BL       OTA_Updata
00009a  e005              B        |L1.168|
                  |L1.156|
;;;52     			else if(cmdId == 0x5021)
00009c  f2450021          MOV      r0,#0x5021
0000a0  4284              CMP      r4,r0
0000a2  d101              BNE      |L1.168|
;;;53     				ClearFaultCmd();
0000a4  f7fffffe          BL       ClearFaultCmd
                  |L1.168|
;;;54     			Mem_free(ptrDeal);             //释放内存块
0000a8  4628              MOV      r0,r5
0000aa  f7fffffe          BL       Mem_free
;;;55     			varOperation.isLoginDeal = 1;  //登录报文处理完毕
0000ae  2001              MOVS     r0,#1
0000b0  490f              LDR      r1,|L1.240|
0000b2  f8810030          STRB     r0,[r1,#0x30]
0000b6  e016              B        |L1.230|
                  |L1.184|
;;;56     		}
;;;57     		else   //等待超时
;;;58     		{
;;;59     			varOperation.isLoginDeal = 1; 
0000b8  2001              MOVS     r0,#1
0000ba  490d              LDR      r1,|L1.240|
0000bc  f8810030          STRB     r0,[r1,#0x30]
;;;60     			if(sysUpdateVar.isSoftUpdate == 1)//OTA升级超时
0000c0  480c              LDR      r0,|L1.244|
0000c2  7800              LDRB     r0,[r0,#0]  ; sysUpdateVar
0000c4  2801              CMP      r0,#1
0000c6  d10e              BNE      |L1.230|
;;;61     			{
;;;62     				sysUpdateVar.isSoftUpdate = 0;
0000c8  2000              MOVS     r0,#0
0000ca  490a              LDR      r1,|L1.244|
0000cc  7008              STRB     r0,[r1,#0]
;;;63     				varOperation.isDataFlow   = 0;//重启数据流
0000ce  4908              LDR      r1,|L1.240|
0000d0  f881002d          STRB     r0,[r1,#0x2d]
;;;64     				if(OSSemAccept(LoginMes) == 0)//启动CAN
0000d4  4808              LDR      r0,|L1.248|
0000d6  6800              LDR      r0,[r0,#0]  ; LoginMes
0000d8  f7fffffe          BL       OSSemAccept
0000dc  b918              CBNZ     r0,|L1.230|
;;;65     					OSSemPost(LoginMes);	
0000de  4806              LDR      r0,|L1.248|
0000e0  6800              LDR      r0,[r0,#0]  ; LoginMes
0000e2  f7fffffe          BL       OSSemPost
                  |L1.230|
0000e6  bf00              NOP                            ;33
                  |L1.232|
0000e8  e78e              B        |L1.8|
;;;66     			} 
;;;67     		}
;;;68     	}
;;;69     }
;;;70     //登录报文
                          ENDP

0000ea  0000              DCW      0x0000
                  |L1.236|
                          DCD      ZIPRecv_Q
                  |L1.240|
                          DCD      varOperation
                  |L1.244|
                          DCD      sysUpdateVar
                  |L1.248|
                          DCD      LoginMes

                          AREA ||i.CanTestCmd||, CODE, READONLY, ALIGN=2

                  CanTestCmd PROC
;;;551    extern CAN1DataToSend  dataToSend; 
;;;552    static void CanTestCmd(uint8_t* ptrDeal)//服务器下发的  CAN测试指令
000000  e92d4ff0          PUSH     {r4-r11,lr}
;;;553    {
000004  b087              SUB      sp,sp,#0x1c
000006  4606              MOV      r6,r0
;;;554    	uint32_t flowId;
;;;555    	uint32_t canRxId;
;;;556    //	uint32_t recordId;
;;;557    	uint32_t canTxId;
;;;558    	uint8_t*  pidVerCmd;
;;;559    	uint16_t cmdId;
;;;560    	uint8_t offset = 3,err = 0,i = 0,cmdManyPackNum = 0;
000008  2403              MOVS     r4,#3
00000a  2000              MOVS     r0,#0
00000c  9005              STR      r0,[sp,#0x14]
00000e  4681              MOV      r9,r0
000010  9004              STR      r0,[sp,#0x10]
;;;561    	CanRxMsg* CAN1_RxMsg;
;;;562    	CAN_InitTypeDef   CAN_InitStructure;
;;;563    	
;;;564    //	recordId = dataToSend.canId;//记录之前的  CANID
;;;565    	
;;;566    	pidVerCmd = Mem_malloc(8);
000012  2008              MOVS     r0,#8
000014  f7fffffe          BL       Mem_malloc
000018  4605              MOV      r5,r0
;;;567    	
;;;568    	cmdId     = ptrDeal[offset ++];
00001a  4621              MOV      r1,r4
00001c  1c64              ADDS     r4,r4,#1
00001e  5c70              LDRB     r0,[r6,r1]
000020  9006              STR      r0,[sp,#0x18]
;;;569    	cmdId     = (cmdId << 8) + ptrDeal[offset ++];
000022  4621              MOV      r1,r4
000024  1c64              ADDS     r4,r4,#1
000026  5c71              LDRB     r1,[r6,r1]
000028  9806              LDR      r0,[sp,#0x18]
00002a  eb012000          ADD      r0,r1,r0,LSL #8
00002e  b280              UXTH     r0,r0
000030  9006              STR      r0,[sp,#0x18]
;;;570    	
;;;571    	flowId = ptrDeal[offset ++];//流水ID
000032  4621              MOV      r1,r4
000034  1c64              ADDS     r4,r4,#1
000036  5c77              LDRB     r7,[r6,r1]
;;;572    	flowId = (flowId<<8) + ptrDeal[offset++];
000038  4621              MOV      r1,r4
00003a  1c64              ADDS     r4,r4,#1
00003c  5c70              LDRB     r0,[r6,r1]
00003e  eb002707          ADD      r7,r0,r7,LSL #8
;;;573    	flowId = (flowId<<8) + ptrDeal[offset++];
000042  4621              MOV      r1,r4
000044  1c64              ADDS     r4,r4,#1
000046  5c70              LDRB     r0,[r6,r1]
000048  eb002707          ADD      r7,r0,r7,LSL #8
;;;574    	flowId = (flowId<<8) + ptrDeal[offset++];
00004c  4621              MOV      r1,r4
00004e  1c64              ADDS     r4,r4,#1
000050  5c70              LDRB     r0,[r6,r1]
000052  eb002707          ADD      r7,r0,r7,LSL #8
;;;575    	
;;;576    	canRxId = ptrDeal[offset ++];//卡路宝ID
000056  4620              MOV      r0,r4
000058  1c61              ADDS     r1,r4,#1
00005a  b2cc              UXTB     r4,r1
00005c  f816a000          LDRB     r10,[r6,r0]
;;;577    	canRxId = (canRxId<<8) + ptrDeal[offset++];
000060  4620              MOV      r0,r4
000062  1c61              ADDS     r1,r4,#1
000064  b2cc              UXTB     r4,r1
000066  5c30              LDRB     r0,[r6,r0]
000068  eb002a0a          ADD      r10,r0,r10,LSL #8
;;;578    	canRxId = (canRxId<<8) + ptrDeal[offset++];
00006c  4620              MOV      r0,r4
00006e  1c61              ADDS     r1,r4,#1
000070  b2cc              UXTB     r4,r1
000072  5c30              LDRB     r0,[r6,r0]
000074  eb002a0a          ADD      r10,r0,r10,LSL #8
;;;579    	canRxId = (canRxId<<8) + ptrDeal[offset++];
000078  4620              MOV      r0,r4
00007a  1c61              ADDS     r1,r4,#1
00007c  b2cc              UXTB     r4,r1
00007e  5c30              LDRB     r0,[r6,r0]
000080  eb002a0a          ADD      r10,r0,r10,LSL #8
;;;580    	
;;;581    	canTxId = ptrDeal[offset ++];//ECU ID 
000084  4620              MOV      r0,r4
000086  1c61              ADDS     r1,r4,#1
000088  b2cc              UXTB     r4,r1
00008a  f816b000          LDRB     r11,[r6,r0]
;;;582    	canTxId = (canTxId<<8) + ptrDeal[offset++];
00008e  4620              MOV      r0,r4
000090  1c61              ADDS     r1,r4,#1
000092  b2cc              UXTB     r4,r1
000094  5c30              LDRB     r0,[r6,r0]
000096  eb002b0b          ADD      r11,r0,r11,LSL #8
;;;583    	canTxId = (canTxId<<8) + ptrDeal[offset++];
00009a  4620              MOV      r0,r4
00009c  1c61              ADDS     r1,r4,#1
00009e  b2cc              UXTB     r4,r1
0000a0  5c30              LDRB     r0,[r6,r0]
0000a2  eb002b0b          ADD      r11,r0,r11,LSL #8
;;;584    	canTxId = (canTxId<<8) + ptrDeal[offset++];
0000a6  4620              MOV      r0,r4
0000a8  1c61              ADDS     r1,r4,#1
0000aa  b2cc              UXTB     r4,r1
0000ac  5c30              LDRB     r0,[r6,r0]
0000ae  eb002b0b          ADD      r11,r0,r11,LSL #8
;;;585    	
;;;586    	memcpy(pidVerCmd,&ptrDeal[offset],8);//要测试的 PID 指令
0000b2  1930              ADDS     r0,r6,r4
0000b4  6801              LDR      r1,[r0,#0]
0000b6  6029              STR      r1,[r5,#0]
0000b8  6840              LDR      r0,[r0,#4]
0000ba  6068              STR      r0,[r5,#4]
;;;587    	
;;;588    	varOperation.pidTset = 1;
0000bc  2001              MOVS     r0,#1
0000be  49b1              LDR      r1,|L2.900|
0000c0  f8810093          STRB     r0,[r1,#0x93]
;;;589    	
;;;590    	CAN_DeInit(CAN1);  
0000c4  48b0              LDR      r0,|L2.904|
0000c6  f7fffffe          BL       CAN_DeInit
;;;591    	CAN_StructInit(&CAN_InitStructure);
0000ca  a801              ADD      r0,sp,#4
0000cc  f7fffffe          BL       CAN_StructInit
;;;592    	CAN1_BaudSet(canDataConfig.canBaud);  //先用flash中的CAN配置进行测试
0000d0  49ae              LDR      r1,|L2.908|
0000d2  7c88              LDRB     r0,[r1,#0x12]  ; canDataConfig
0000d4  f7fffffe          BL       CAN1_BaudSet
;;;593    	CAN1_SetFilter(canRxId ,CAN_ID_EXT); 
0000d8  2104              MOVS     r1,#4
0000da  4650              MOV      r0,r10
0000dc  f7fffffe          BL       CAN1_SetFilter
;;;594    	CAN_ITConfig(CAN1,CAN_IT_FMP1,ENABLE);//重置CAN滤波器
0000e0  2201              MOVS     r2,#1
0000e2  2110              MOVS     r1,#0x10
0000e4  48a8              LDR      r0,|L2.904|
0000e6  f7fffffe          BL       CAN_ITConfig
;;;595    	
;;;596    	for(i = 0;i < 200;i ++)//清空消息队列
0000ea  bf00              NOP      
0000ec  e011              B        |L2.274|
                  |L2.238|
;;;597    	{
;;;598    		CAN1_RxMsg = OSQPend(canRecieveQ,40,&err);
0000ee  aa05              ADD      r2,sp,#0x14
0000f0  2128              MOVS     r1,#0x28
0000f2  48a7              LDR      r0,|L2.912|
0000f4  6800              LDR      r0,[r0,#0]  ; canRecieveQ
0000f6  f7fffffe          BL       OSQPend
0000fa  4680              MOV      r8,r0
;;;599    		if(err != OS_ERR_NONE)//消息队列没数据了
0000fc  f89d0014          LDRB     r0,[sp,#0x14]
000100  b100              CBZ      r0,|L2.260|
;;;600    			break;
000102  e009              B        |L2.280|
                  |L2.260|
;;;601    		Mem_free(CAN1_RxMsg);
000104  4640              MOV      r0,r8
000106  f7fffffe          BL       Mem_free
00010a  f1090001          ADD      r0,r9,#1              ;596
00010e  f00009ff          AND      r9,r0,#0xff           ;596
                  |L2.274|
000112  f1b90fc8          CMP      r9,#0xc8              ;596
000116  dbea              BLT      |L2.238|
                  |L2.280|
000118  bf00              NOP                            ;600
;;;602    	}
;;;603    	dataToSend.canId = canTxId;
00011a  489e              LDR      r0,|L2.916|
00011c  f8c0b000          STR      r11,[r0,#0]  ; dataToSend
;;;604    	dataToSend.pdat  = pidVerCmd;
000120  6085              STR      r5,[r0,#8]  ; dataToSend
;;;605    	OBD_CAN_SendData(dataToSend.canId,CAN_ID_EXT,dataToSend.pdat);//发送PID指令
000122  4601              MOV      r1,r0
000124  688a              LDR      r2,[r1,#8]  ; dataToSend
000126  6808              LDR      r0,[r1,#0]  ; dataToSend
000128  2104              MOVS     r1,#4
00012a  f7fffffe          BL       OBD_CAN_SendData
;;;606    
;;;607    	CAN1_RxMsg = OSQPend(canRecieveQ,500,&err); // 接收到OBD回复
00012e  aa05              ADD      r2,sp,#0x14
000130  f44f71fa          MOV      r1,#0x1f4
000134  4896              LDR      r0,|L2.912|
000136  6800              LDR      r0,[r0,#0]  ; canRecieveQ
000138  f7fffffe          BL       OSQPend
00013c  4680              MOV      r8,r0
;;;608    	if(err == OS_ERR_NONE)
00013e  f89d0014          LDRB     r0,[sp,#0x14]
000142  2800              CMP      r0,#0
000144  d179              BNE      |L2.570|
;;;609    	{
;;;610    		if(CAN1_RxMsg->Data[0] == 0x10)     // 多包处理
000146  f898000b          LDRB     r0,[r8,#0xb]
00014a  2810              CMP      r0,#0x10
00014c  d177              BNE      |L2.574|
;;;611    		{
;;;612    			pidVerCmd = Mem_malloc(CAN1_RxMsg->Data[1] + 15);// 申请的内存块足够长
00014e  f898100c          LDRB     r1,[r8,#0xc]
000152  f101000f          ADD      r0,r1,#0xf
000156  f7fffffe          BL       Mem_malloc
00015a  4605              MOV      r5,r0
;;;613    			if(pidVerCmd != NULL)
00015c  2d00              CMP      r5,#0
00015e  d06b              BEQ      |L2.568|
;;;614    			{
;;;615    				pidVerCmd[0] = CAN1_RxMsg -> Data[1] + 8;
000160  f898000c          LDRB     r0,[r8,#0xc]
000164  3008              ADDS     r0,r0,#8
000166  7028              STRB     r0,[r5,#0]
;;;616    				pidVerCmd[1] = 0x50;
000168  2050              MOVS     r0,#0x50
00016a  7068              STRB     r0,[r5,#1]
;;;617    				pidVerCmd[2] = 0x17;
00016c  2017              MOVS     r0,#0x17
00016e  70a8              STRB     r0,[r5,#2]
;;;618    				
;;;619    				pidVerCmd[3] = (flowId>>24) & 0xFF;           //指令流水号
000170  0e38              LSRS     r0,r7,#24
000172  70e8              STRB     r0,[r5,#3]
;;;620    				pidVerCmd[4] = (flowId>>16) & 0xFF;
000174  0c38              LSRS     r0,r7,#16
000176  7128              STRB     r0,[r5,#4]
;;;621    				pidVerCmd[5] = (flowId>>8)  & 0xFF;
000178  0a38              LSRS     r0,r7,#8
00017a  7168              STRB     r0,[r5,#5]
;;;622    				pidVerCmd[6] = (flowId>>0)  & 0xFF;
00017c  71af              STRB     r7,[r5,#6]
;;;623    				
;;;624    				pidVerCmd[7] = CAN1_RxMsg->Data[1];           //收到的数据长度
00017e  f898000c          LDRB     r0,[r8,#0xc]
000182  71e8              STRB     r0,[r5,#7]
;;;625    				
;;;626    				memcpy(&pidVerCmd[8],&CAN1_RxMsg->Data[2],6);
000184  f8d8100d          LDR      r1,[r8,#0xd]
000188  60a9              STR      r1,[r5,#8]
00018a  f8b80011          LDRH     r0,[r8,#0x11]
00018e  81a8              STRH     r0,[r5,#0xc]
;;;627    				cmdManyPackNum = (CAN1_RxMsg->Data[1] - 6) % 7 == 0? (CAN1_RxMsg->Data[1] - 6)/7 : (CAN1_RxMsg->Data[1] - 6)/7 + 1;
000190  f898000c          LDRB     r0,[r8,#0xc]
000194  1f80              SUBS     r0,r0,#6
000196  2107              MOVS     r1,#7
000198  fb90f2f1          SDIV     r2,r0,r1
00019c  fb010012          MLS      r0,r1,r2,r0
0001a0  b928              CBNZ     r0,|L2.430|
0001a2  f898000c          LDRB     r0,[r8,#0xc]
0001a6  1f80              SUBS     r0,r0,#6
0001a8  fb90f0f1          SDIV     r0,r0,r1
0001ac  e006              B        |L2.444|
                  |L2.430|
0001ae  f898000c          LDRB     r0,[r8,#0xc]
0001b2  1f80              SUBS     r0,r0,#6
0001b4  2107              MOVS     r1,#7
0001b6  fb90f0f1          SDIV     r0,r0,r1
0001ba  1c40              ADDS     r0,r0,#1
                  |L2.444|
0001bc  b2c0              UXTB     r0,r0
0001be  9004              STR      r0,[sp,#0x10]
;;;628    				Mem_free(CAN1_RxMsg);
0001c0  4640              MOV      r0,r8
0001c2  f7fffffe          BL       Mem_free
;;;629    				dataToSend.pdat = pidManyBag;                 //发送 0x30 请求接下来的多包
0001c6  4874              LDR      r0,|L2.920|
0001c8  4972              LDR      r1,|L2.916|
0001ca  6088              STR      r0,[r1,#8]  ; dataToSend
;;;630    				OBD_CAN_SendData(dataToSend.canId,dataToSend.ide,dataToSend.pdat);
0001cc  460b              MOV      r3,r1
0001ce  689a              LDR      r2,[r3,#8]  ; dataToSend
0001d0  6859              LDR      r1,[r3,#4]  ; dataToSend
0001d2  6818              LDR      r0,[r3,#0]  ; dataToSend
0001d4  f7fffffe          BL       OBD_CAN_SendData
;;;631    				for(i=0;i<cmdManyPackNum;i++)
0001d8  f04f0900          MOV      r9,#0
0001dc  e01f              B        |L2.542|
                  |L2.478|
;;;632    				{
;;;633    					CAN1_RxMsg = OSQPend(canRecieveQ,25,&err);// 接收多包
0001de  aa05              ADD      r2,sp,#0x14
0001e0  2119              MOVS     r1,#0x19
0001e2  486b              LDR      r0,|L2.912|
0001e4  6800              LDR      r0,[r0,#0]  ; canRecieveQ
0001e6  f7fffffe          BL       OSQPend
0001ea  4680              MOV      r8,r0
;;;634    					if(err == OS_ERR_NONE)
0001ec  f89d0014          LDRB     r0,[sp,#0x14]
0001f0  b980              CBNZ     r0,|L2.532|
;;;635    					{
;;;636    						memcpy(&pidVerCmd[7*i + 14],&CAN1_RxMsg->Data[1],7);
0001f2  ebc900c9          RSB      r0,r9,r9,LSL #3
0001f6  300e              ADDS     r0,r0,#0xe
0001f8  1941              ADDS     r1,r0,r5
0001fa  f8d8200c          LDR      r2,[r8,#0xc]
0001fe  600a              STR      r2,[r1,#0]
000200  f8b82010          LDRH     r2,[r8,#0x10]
000204  808a              STRH     r2,[r1,#4]
000206  f8980012          LDRB     r0,[r8,#0x12]
00020a  7188              STRB     r0,[r1,#6]
;;;637    						Mem_free(CAN1_RxMsg);
00020c  4640              MOV      r0,r8
00020e  f7fffffe          BL       Mem_free
000212  e000              B        |L2.534|
                  |L2.532|
;;;638    					}
;;;639    					else 
;;;640    						break;
000214  e006              B        |L2.548|
                  |L2.534|
000216  f1090001          ADD      r0,r9,#1              ;631
00021a  f00009ff          AND      r9,r0,#0xff           ;631
                  |L2.542|
00021e  9804              LDR      r0,[sp,#0x10]         ;631
000220  4581              CMP      r9,r0                 ;631
000222  dbdc              BLT      |L2.478|
                  |L2.548|
000224  bf00              NOP      
;;;641    				} 
;;;642    				if(i == cmdManyPackNum)
000226  9804              LDR      r0,[sp,#0x10]
000228  4581              CMP      r9,r0
00022a  d102              BNE      |L2.562|
;;;643    				{
;;;644    					SendPidCmdData(pidVerCmd);
00022c  4628              MOV      r0,r5
00022e  f7fffffe          BL       SendPidCmdData
                  |L2.562|
;;;645    				}
;;;646    				Mem_free(pidVerCmd);
000232  4628              MOV      r0,r5
000234  f7fffffe          BL       Mem_free
                  |L2.568|
000238  e084              B        |L2.836|
                  |L2.570|
00023a  e03b              B        |L2.692|
00023c  e7ff              B        |L2.574|
                  |L2.574|
;;;647    			}
;;;648    		}
;;;649    		else  //单包处理
;;;650    		{
;;;651    			offset = 0;
00023e  2400              MOVS     r4,#0
;;;652    			pidVerCmd = Mem_malloc(16);
000240  2010              MOVS     r0,#0x10
000242  f7fffffe          BL       Mem_malloc
000246  4605              MOV      r5,r0
;;;653    			pidVerCmd[offset++] = 16;
000248  2210              MOVS     r2,#0x10
00024a  4621              MOV      r1,r4
00024c  1c64              ADDS     r4,r4,#1
00024e  546a              STRB     r2,[r5,r1]
;;;654    			pidVerCmd[offset++] = 0x50;
000250  2250              MOVS     r2,#0x50
000252  4621              MOV      r1,r4
000254  1c64              ADDS     r4,r4,#1
000256  546a              STRB     r2,[r5,r1]
;;;655    			pidVerCmd[offset++] = 0x17;
000258  2217              MOVS     r2,#0x17
00025a  4621              MOV      r1,r4
00025c  1c64              ADDS     r4,r4,#1
00025e  546a              STRB     r2,[r5,r1]
;;;656    			
;;;657    			pidVerCmd[offset++] = (flowId>>24) & 0xFF;//指令流水号
000260  0e39              LSRS     r1,r7,#24
000262  4622              MOV      r2,r4
000264  1c64              ADDS     r4,r4,#1
000266  54a9              STRB     r1,[r5,r2]
;;;658    			pidVerCmd[offset++] = (flowId>>16) & 0xFF;
000268  f3c74207          UBFX     r2,r7,#16,#8
00026c  4621              MOV      r1,r4
00026e  1c64              ADDS     r4,r4,#1
000270  546a              STRB     r2,[r5,r1]
;;;659    			pidVerCmd[offset++] = (flowId>>8)  & 0xFF;
000272  f3c72207          UBFX     r2,r7,#8,#8
000276  4621              MOV      r1,r4
000278  1c64              ADDS     r4,r4,#1
00027a  546a              STRB     r2,[r5,r1]
;;;660    			pidVerCmd[offset++] = (flowId>>0)  & 0xFF;
00027c  4621              MOV      r1,r4
00027e  1c64              ADDS     r4,r4,#1
000280  546f              STRB     r7,[r5,r1]
;;;661    			
;;;662    			pidVerCmd[offset++] = 8;//收到的数据长度
000282  2208              MOVS     r2,#8
000284  4620              MOV      r0,r4
000286  1c61              ADDS     r1,r4,#1
000288  b2cc              UXTB     r4,r1
00028a  542a              STRB     r2,[r5,r0]
;;;663    			memcpy(&pidVerCmd[offset++],CAN1_RxMsg->Data,8);
00028c  4620              MOV      r0,r4
00028e  1c61              ADDS     r1,r4,#1
000290  b2cc              UXTB     r4,r1
000292  4428              ADD      r0,r0,r5
000294  f8d8100b          LDR      r1,[r8,#0xb]
000298  6001              STR      r1,[r0,#0]
00029a  f8d8100f          LDR      r1,[r8,#0xf]
00029e  6041              STR      r1,[r0,#4]
;;;664    			SendPidCmdData(pidVerCmd);
0002a0  4628              MOV      r0,r5
0002a2  f7fffffe          BL       SendPidCmdData
;;;665    			Mem_free(pidVerCmd);
0002a6  4628              MOV      r0,r5
0002a8  f7fffffe          BL       Mem_free
;;;666    			Mem_free(CAN1_RxMsg);
0002ac  4640              MOV      r0,r8
0002ae  f7fffffe          BL       Mem_free
0002b2  e047              B        |L2.836|
                  |L2.692|
;;;667    		}
;;;668    	}else//ECU 无回复
;;;669    	{	offset = 0;
0002b4  2400              MOVS     r4,#0
;;;670    		pidVerCmd = Mem_malloc(16);
0002b6  2010              MOVS     r0,#0x10
0002b8  f7fffffe          BL       Mem_malloc
0002bc  4605              MOV      r5,r0
;;;671    		pidVerCmd[offset++] = 13;
0002be  220d              MOVS     r2,#0xd
0002c0  4621              MOV      r1,r4
0002c2  1c64              ADDS     r4,r4,#1
0002c4  546a              STRB     r2,[r5,r1]
;;;672    		pidVerCmd[offset++] = 0x50;
0002c6  2250              MOVS     r2,#0x50
0002c8  4621              MOV      r1,r4
0002ca  1c64              ADDS     r4,r4,#1
0002cc  546a              STRB     r2,[r5,r1]
;;;673    		pidVerCmd[offset++] = 0x17;
0002ce  2217              MOVS     r2,#0x17
0002d0  4621              MOV      r1,r4
0002d2  1c64              ADDS     r4,r4,#1
0002d4  546a              STRB     r2,[r5,r1]
;;;674    		
;;;675    		pidVerCmd[offset++] = (flowId>>24) & 0xFF;//指令流水号
0002d6  0e39              LSRS     r1,r7,#24
0002d8  4622              MOV      r2,r4
0002da  1c64              ADDS     r4,r4,#1
0002dc  54a9              STRB     r1,[r5,r2]
;;;676    		pidVerCmd[offset++] = (flowId>>16) & 0xFF;
0002de  f3c74207          UBFX     r2,r7,#16,#8
0002e2  4621              MOV      r1,r4
0002e4  1c64              ADDS     r4,r4,#1
0002e6  546a              STRB     r2,[r5,r1]
;;;677    		pidVerCmd[offset++] = (flowId>>8)  & 0xFF;
0002e8  f3c72207          UBFX     r2,r7,#8,#8
0002ec  4621              MOV      r1,r4
0002ee  1c64              ADDS     r4,r4,#1
0002f0  546a              STRB     r2,[r5,r1]
;;;678    		pidVerCmd[offset++] = (flowId>>0)  & 0xFF;
0002f2  4621              MOV      r1,r4
0002f4  1c64              ADDS     r4,r4,#1
0002f6  546f              STRB     r7,[r5,r1]
;;;679    		
;;;680    		pidVerCmd[offset++] = 5;      //ERROR  -  配置指令错误
0002f8  2205              MOVS     r2,#5
0002fa  4620              MOV      r0,r4
0002fc  1c61              ADDS     r1,r4,#1
0002fe  b2cc              UXTB     r4,r1
000300  542a              STRB     r2,[r5,r0]
;;;681    		pidVerCmd[offset++] = 'E';pidVerCmd[offset++] = 'R';pidVerCmd[offset++] = 'R';
000302  2245              MOVS     r2,#0x45
000304  4620              MOV      r0,r4
000306  1c61              ADDS     r1,r4,#1
000308  b2cc              UXTB     r4,r1
00030a  542a              STRB     r2,[r5,r0]
00030c  2252              MOVS     r2,#0x52
00030e  4620              MOV      r0,r4
000310  1c61              ADDS     r1,r4,#1
000312  b2cc              UXTB     r4,r1
000314  542a              STRB     r2,[r5,r0]
000316  4620              MOV      r0,r4
000318  1c61              ADDS     r1,r4,#1
00031a  b2cc              UXTB     r4,r1
00031c  542a              STRB     r2,[r5,r0]
;;;682    		pidVerCmd[offset++] = 'O';pidVerCmd[offset++] = 'R';
00031e  224f              MOVS     r2,#0x4f
000320  4620              MOV      r0,r4
000322  1c61              ADDS     r1,r4,#1
000324  b2cc              UXTB     r4,r1
000326  542a              STRB     r2,[r5,r0]
000328  2252              MOVS     r2,#0x52
00032a  4621              MOV      r1,r4
00032c  1c60              ADDS     r0,r4,#1
00032e  b2c4              UXTB     r4,r0
000330  546a              STRB     r2,[r5,r1]
;;;683    		SendPidCmdData(pidVerCmd);
000332  4628              MOV      r0,r5
000334  f7fffffe          BL       SendPidCmdData
;;;684    		Mem_free(pidVerCmd);
000338  4628              MOV      r0,r5
00033a  f7fffffe          BL       Mem_free
;;;685    		Mem_free(CAN1_RxMsg);
00033e  4640              MOV      r0,r8
000340  f7fffffe          BL       Mem_free
                  |L2.836|
;;;686    	}
;;;687    	if(varOperation.canTest == 2)
000344  480f              LDR      r0,|L2.900|
000346  f8b00091          LDRH     r0,[r0,#0x91]  ; varOperation
00034a  2802              CMP      r0,#2
00034c  d110              BNE      |L2.880|
;;;688    	{
;;;689    		CAN_DeInit(CAN1);  
00034e  480e              LDR      r0,|L2.904|
000350  f7fffffe          BL       CAN_DeInit
;;;690    		CAN_StructInit(&CAN_InitStructure);
000354  a801              ADD      r0,sp,#4
000356  f7fffffe          BL       CAN_StructInit
;;;691    		CAN1_BaudSet(canDataConfig.canBaud);  //先用flash中的CAN配置进行测试
00035a  490c              LDR      r1,|L2.908|
00035c  7c88              LDRB     r0,[r1,#0x12]  ; canDataConfig
00035e  f7fffffe          BL       CAN1_BaudSet
;;;692    		CAN1_ClearFilter();           
000362  f7fffffe          BL       CAN1_ClearFilter
;;;693    		CAN_ITConfig(CAN1,CAN_IT_FMP1,ENABLE);//重置CAN滤波器
000366  2201              MOVS     r2,#1
000368  2110              MOVS     r1,#0x10
00036a  4807              LDR      r0,|L2.904|
00036c  f7fffffe          BL       CAN_ITConfig
                  |L2.880|
;;;694    	}
;;;695    	varOperation.pidTset = 0;
000370  2000              MOVS     r0,#0
000372  4904              LDR      r1,|L2.900|
000374  f8810093          STRB     r0,[r1,#0x93]
;;;696    	Mem_free(pidVerCmd);
000378  4628              MOV      r0,r5
00037a  f7fffffe          BL       Mem_free
;;;697    }
00037e  b007              ADD      sp,sp,#0x1c
000380  e8bd8ff0          POP      {r4-r11,pc}
;;;698    
                          ENDP

                  |L2.900|
                          DCD      varOperation
                  |L2.904|
                          DCD      0x40006400
                  |L2.908|
                          DCD      canDataConfig
                  |L2.912|
                          DCD      canRecieveQ
                  |L2.916|
                          DCD      dataToSend
                  |L2.920|
                          DCD      pidManyBag

                          AREA ||i.ClearFaultCmd||, CODE, READONLY, ALIGN=2

                  ClearFaultCmd PROC
;;;807    
;;;808    void ClearFaultCmd(void)
000000  b570              PUSH     {r4-r6,lr}
;;;809    {
;;;810    
;;;811    	uint8_t * ptrOBDSend;
;;;812    	uint8_t err;
;;;813    //	static uint32_t timeCount = 0;
;;;814    	
;;;815    	ptrOBDSend = Mem_malloc(9);
000002  2009              MOVS     r0,#9
000004  f7fffffe          BL       Mem_malloc
000008  4604              MOV      r4,r0
;;;816    	ptrOBDSend[0] = 201;
00000a  20c9              MOVS     r0,#0xc9
00000c  7020              STRB     r0,[r4,#0]
;;;817    	memcpy(&ptrOBDSend[1],strengthFuelFlash.faultClear,8);
00000e  4809              LDR      r0,|L3.52|
000010  6801              LDR      r1,[r0,#0]  ; strengthFuelFlash
000012  f8c41001          STR      r1,[r4,#1]
000016  6840              LDR      r0,[r0,#4]  ; strengthFuelFlash
000018  f8c40005          STR      r0,[r4,#5]
;;;818    	err = OSQPost(canSendQ,ptrOBDSend);//向OBD推送要发送的PID指令
00001c  4621              MOV      r1,r4
00001e  4806              LDR      r0,|L3.56|
000020  6800              LDR      r0,[r0,#0]  ; canSendQ
000022  f7fffffe          BL       OSQPost
000026  4605              MOV      r5,r0
;;;819    	if(err != OS_ERR_NONE)
000028  b115              CBZ      r5,|L3.48|
;;;820    	{
;;;821    		Mem_free(ptrOBDSend);          //推送不成功，需要释放内存块
00002a  4620              MOV      r0,r4
00002c  f7fffffe          BL       Mem_free
                  |L3.48|
;;;822    	} 
;;;823    }
000030  bd70              POP      {r4-r6,pc}
;;;824    
                          ENDP

000032  0000              DCW      0x0000
                  |L3.52|
                          DCD      strengthFuelFlash+0x4b
                  |L3.56|
                          DCD      canSendQ

                          AREA ||i.ConfigUpdata||, CODE, READONLY, ALIGN=2

                  ConfigUpdata PROC
;;;335    }
;;;336    static void ConfigUpdata(uint8_t* ptrDeal )
000000  e92d47f0          PUSH     {r4-r10,lr}
;;;337    {
000004  4605              MOV      r5,r0
;;;338    	uint8_t  temp;
;;;339    	uint16_t frameLen;
;;;340    	uint16_t cmdId;
;;;341    	uint8_t* ptrMode;
;;;342    	uint16_t i = 0,offset = 0;
000006  2600              MOVS     r6,#0
000008  2400              MOVS     r4,#0
;;;343        static uint16_t currentNum = 0;//发送下一个配置请求包
;;;344    	static uint16_t frameIndex = 0;
;;;345    	static uint8_t  pidPackNum = 0;//PID 总包数
;;;346    	static uint32_t addrSavePid = 0;
;;;347    		
;;;348    	cmdId     = ptrDeal[3];
00000a  78ef              LDRB     r7,[r5,#3]
;;;349    	cmdId     = (cmdId << 8) + ptrDeal[4];
00000c  7928              LDRB     r0,[r5,#4]
00000e  eb002007          ADD      r0,r0,r7,LSL #8
000012  b287              UXTH     r7,r0
;;;350    	if(cmdId == 0x4000)
000014  f5b74f80          CMP      r7,#0x4000
000018  d17e              BNE      |L4.280|
;;;351    	{
;;;352    		offset = 5;
00001a  2405              MOVS     r4,#5
;;;353    		varOperation.busType   = ptrDeal[offset++];//总线类型  CAN总线还是K线
00001c  4621              MOV      r1,r4
00001e  1c64              ADDS     r4,r4,#1
000020  5c68              LDRB     r0,[r5,r1]
000022  49fe              LDR      r1,|L4.1052|
000024  f8810086          STRB     r0,[r1,#0x86]
;;;354    		varOperation.canIdType = ptrDeal[offset++];//CAN ID类型，扩展帧还是标准帧
000028  4621              MOV      r1,r4
00002a  1c64              ADDS     r4,r4,#1
00002c  5c68              LDRB     r0,[r5,r1]
00002e  49fb              LDR      r1,|L4.1052|
000030  f8810087          STRB     r0,[r1,#0x87]
;;;355    		
;;;356    		varOperation.canRxId = ptrDeal[offset++];  //卡路宝 CAN 接收ID
000034  4621              MOV      r1,r4
000036  1c64              ADDS     r4,r4,#1
000038  5c68              LDRB     r0,[r5,r1]
00003a  49f8              LDR      r1,|L4.1052|
00003c  f8c1008c          STR      r0,[r1,#0x8c]  ; varOperation
;;;357    		varOperation.canRxId = (varOperation.canRxId << 8) + ptrDeal[offset++];
000040  4621              MOV      r1,r4
000042  1c64              ADDS     r4,r4,#1
000044  5c68              LDRB     r0,[r5,r1]
000046  49f5              LDR      r1,|L4.1052|
000048  f8d1108c          LDR      r1,[r1,#0x8c]  ; varOperation
00004c  eb002001          ADD      r0,r0,r1,LSL #8
000050  49f2              LDR      r1,|L4.1052|
000052  f8c1008c          STR      r0,[r1,#0x8c]  ; varOperation
;;;358    		varOperation.canRxId = (varOperation.canRxId << 8) + ptrDeal[offset++];
000056  4621              MOV      r1,r4
000058  1c64              ADDS     r4,r4,#1
00005a  5c68              LDRB     r0,[r5,r1]
00005c  49ef              LDR      r1,|L4.1052|
00005e  f8d1108c          LDR      r1,[r1,#0x8c]  ; varOperation
000062  eb002001          ADD      r0,r0,r1,LSL #8
000066  49ed              LDR      r1,|L4.1052|
000068  f8c1008c          STR      r0,[r1,#0x8c]  ; varOperation
;;;359    		varOperation.canRxId = (varOperation.canRxId << 8) + ptrDeal[offset++];
00006c  4621              MOV      r1,r4
00006e  1c64              ADDS     r4,r4,#1
000070  5c68              LDRB     r0,[r5,r1]
000072  49ea              LDR      r1,|L4.1052|
000074  f8d1108c          LDR      r1,[r1,#0x8c]  ; varOperation
000078  eb002001          ADD      r0,r0,r1,LSL #8
00007c  49e7              LDR      r1,|L4.1052|
00007e  f8c1008c          STR      r0,[r1,#0x8c]  ; varOperation
;;;360    		
;;;361    		varOperation.canTxId = ptrDeal[offset++];  //卡路宝 CAN 发送ID
000082  4621              MOV      r1,r4
000084  1c64              ADDS     r4,r4,#1
000086  5c68              LDRB     r0,[r5,r1]
000088  49e4              LDR      r1,|L4.1052|
00008a  f8c10088          STR      r0,[r1,#0x88]  ; varOperation
;;;362    		varOperation.canTxId = (varOperation.canTxId << 8) + ptrDeal[offset++];
00008e  4621              MOV      r1,r4
000090  1c64              ADDS     r4,r4,#1
000092  5c68              LDRB     r0,[r5,r1]
000094  49e1              LDR      r1,|L4.1052|
000096  f8d11088          LDR      r1,[r1,#0x88]  ; varOperation
00009a  eb002001          ADD      r0,r0,r1,LSL #8
00009e  49df              LDR      r1,|L4.1052|
0000a0  f8c10088          STR      r0,[r1,#0x88]  ; varOperation
;;;363    		varOperation.canTxId = (varOperation.canTxId << 8) + ptrDeal[offset++];
0000a4  4621              MOV      r1,r4
0000a6  1c64              ADDS     r4,r4,#1
0000a8  5c68              LDRB     r0,[r5,r1]
0000aa  49dc              LDR      r1,|L4.1052|
0000ac  f8d11088          LDR      r1,[r1,#0x88]  ; varOperation
0000b0  eb002001          ADD      r0,r0,r1,LSL #8
0000b4  49d9              LDR      r1,|L4.1052|
0000b6  f8c10088          STR      r0,[r1,#0x88]  ; varOperation
;;;364    		varOperation.canTxId = (varOperation.canTxId << 8) + ptrDeal[offset++];
0000ba  4621              MOV      r1,r4
0000bc  1c64              ADDS     r4,r4,#1
0000be  5c68              LDRB     r0,[r5,r1]
0000c0  49d6              LDR      r1,|L4.1052|
0000c2  f8d11088          LDR      r1,[r1,#0x88]  ; varOperation
0000c6  eb002001          ADD      r0,r0,r1,LSL #8
0000ca  49d4              LDR      r1,|L4.1052|
0000cc  f8c10088          STR      r0,[r1,#0x88]  ; varOperation
;;;365    		
;;;366    		varOperation.newPidNum = ptrDeal[offset++];//新的PID命令个数
0000d0  4621              MOV      r1,r4
0000d2  1c64              ADDS     r4,r4,#1
0000d4  5c68              LDRB     r0,[r5,r1]
0000d6  49d1              LDR      r1,|L4.1052|
0000d8  f8a10082          STRH     r0,[r1,#0x82]
;;;367    		varOperation.newPidNum = varOperation.newPidNum * 256 + ptrDeal[offset++];//新的PID命令个数
0000dc  4621              MOV      r1,r4
0000de  1c64              ADDS     r4,r4,#1
0000e0  5c69              LDRB     r1,[r5,r1]
0000e2  48ce              LDR      r0,|L4.1052|
0000e4  f8900082          LDRB     r0,[r0,#0x82]  ; varOperation
0000e8  eb012000          ADD      r0,r1,r0,LSL #8
0000ec  49cb              LDR      r1,|L4.1052|
0000ee  f8a10082          STRH     r0,[r1,#0x82]
;;;368    		
;;;369    		pidPackNum = ptrDeal[offset++];            //一帧共有多少PID包配置项
0000f2  4621              MOV      r1,r4
0000f4  1c64              ADDS     r4,r4,#1
0000f6  5c68              LDRB     r0,[r5,r1]
0000f8  49c9              LDR      r1,|L4.1056|
0000fa  7008              STRB     r0,[r1,#0]
;;;370    		
;;;371    		varOperation.canBaud = (CANBAUD_Enum)ptrDeal[offset++];  //CAN波特率，协议中的 protocolType
0000fc  4620              MOV      r0,r4
0000fe  1c61              ADDS     r1,r4,#1
000100  b28c              UXTH     r4,r1
000102  5c28              LDRB     r0,[r5,r0]
000104  49c5              LDR      r1,|L4.1052|
000106  f8810090          STRB     r0,[r1,#0x90]
;;;372    		
;;;373    		memcpy(varOperation.pidVerCmd,&ptrDeal[offset],8);  //提取 读取ECU版本号的指令
00010a  1929              ADDS     r1,r5,r4
00010c  48c3              LDR      r0,|L4.1052|
00010e  309b              ADDS     r0,r0,#0x9b
000110  680a              LDR      r2,[r1,#0]
000112  6002              STR      r2,[r0,#0]  ; varOperation
000114  6849              LDR      r1,[r1,#4]
000116  e000              B        |L4.282|
                  |L4.280|
000118  e014              B        |L4.324|
                  |L4.282|
00011a  6041              STR      r1,[r0,#4]  ; varOperation
;;;374    		
;;;375    		currentNum = 0x4001;
00011c  f2440001          MOV      r0,#0x4001
000120  49c0              LDR      r1,|L4.1060|
000122  8008              STRH     r0,[r1,#0]
;;;376    		frameIndex = 0;
000124  2000              MOVS     r0,#0
000126  49c0              LDR      r1,|L4.1064|
000128  8008              STRH     r0,[r1,#0]
;;;377    		addrSavePid  = PID1CONFIGADDR;
00012a  48c0              LDR      r0,|L4.1068|
00012c  49c0              LDR      r1,|L4.1072|
00012e  6008              STR      r0,[r1,#0]  ; addrSavePid
;;;378    		memset(updateBuff,0,2048);
000130  f44f6100          MOV      r1,#0x800
000134  48bf              LDR      r0,|L4.1076|
000136  f7fffffe          BL       __aeabi_memclr
;;;379    		SendConfigNum(currentNum);//发送第一包程序请求帧0x4001
00013a  48ba              LDR      r0,|L4.1060|
00013c  8800              LDRH     r0,[r0,#0]  ; currentNum
00013e  f7fffffe          BL       SendConfigNum
000142  e220              B        |L4.1414|
                  |L4.324|
;;;380    		
;;;381    	}else if(cmdId > 0x4000 && cmdId < 0x5000)
000144  f5b74f80          CMP      r7,#0x4000
000148  dd6f              BLE      |L4.554|
00014a  f5b74fa0          CMP      r7,#0x5000
00014e  da6c              BGE      |L4.554|
;;;382    	{
;;;383    		if(cmdId != currentNum)       //接收到的帧序号，与所申请的帧序号不同，则放弃数据并重新申请
000150  48b4              LDR      r0,|L4.1060|
000152  8800              LDRH     r0,[r0,#0]  ; currentNum
000154  4287              CMP      r7,r0
000156  d001              BEQ      |L4.348|
                  |L4.344|
;;;384    		{
;;;385    			//SendConfigNum(currentNum);//todo：重新发送？
;;;386    			return;
;;;387    		}
;;;388    		 
;;;389    		offset = 2;
;;;390    		frameLen = ptrDeal[offset++] - 3;
;;;391    		cmdId    = ptrDeal[offset++];
;;;392    		cmdId    = (cmdId << 8) + ptrDeal[offset++]; 
;;;393    		memcpy(&updateBuff[frameIndex],&ptrDeal[offset],frameLen);
;;;394    		frameIndex += frameLen;
;;;395    		if(((cmdId - 0x4000) % 11 == 0)&&((cmdId - pidPackNum) != 0x4000))//2K 存110个PID，一个PID占17byte
;;;396    		{
;;;397    			for(i = 0;i < frameIndex;i += 17)      //更改 指令发送周期 的字节序
;;;398    			{
;;;399    				temp            = updateBuff[i];
;;;400    				updateBuff[i]   = updateBuff[i+3];
;;;401    				updateBuff[i+3] = temp;
;;;402    				temp            = updateBuff[i+1];
;;;403    				updateBuff[i+1] = updateBuff[i+2];
;;;404    				updateBuff[i+2] = temp;
;;;405    			}
;;;406    			Save2KDataToFlash(updateBuff,addrSavePid,2048);
;;;407    			addrSavePid += 0x800;
;;;408    			frameIndex = 0;
;;;409    			memset(updateBuff,0,2048);
;;;410    			currentNum = cmdId + 1;   
;;;411    			SendConfigNum(currentNum);//请求下一包数据
;;;412    		}
;;;413    		else if((cmdId - pidPackNum) == 0x4000)
;;;414    		{
;;;415    			for(i = 0;i < frameIndex;i += 17)                   //更改 指令发送周期 的字节序
;;;416    			{
;;;417    				temp            = updateBuff[i];
;;;418    				updateBuff[i]   = updateBuff[i+3];
;;;419    				updateBuff[i+3] = temp;
;;;420    				temp            = updateBuff[i+1];
;;;421    				updateBuff[i+1] = updateBuff[i+2];
;;;422    				updateBuff[i+2] = temp;
;;;423    			}
;;;424    			Save2KDataToFlash(updateBuff,addrSavePid,2048);
;;;425    			addrSavePid = PID2CONFIGADDR;
;;;426    			frameIndex = 0;
;;;427    			memset(updateBuff,0,2048);
;;;428    			SendConfigNum(0x5012);//请求第二个配置文件
;;;429    		}
;;;430    		else  
;;;431    		{
;;;432    			currentNum = cmdId + 1;   
;;;433    			SendConfigNum(currentNum);//请求下一包数据
;;;434    		}
;;;435    	}
;;;436    	else if(cmdId == 0x5012)
;;;437    	{
;;;438    		offset = 2;
;;;439    		frameLen = ptrDeal[offset++] - 3;
;;;440    		
;;;441    		canDataConfig.pidVarNum = frameLen / 14;   //得到上报 ECU 变量的个数
;;;442    		
;;;443    		cmdId    = ptrDeal[offset++];
;;;444    		cmdId    = (cmdId << 8) + ptrDeal[offset++]; 
;;;445    		memcpy(updateBuff,&ptrDeal[offset],frameLen);
;;;446    		frameIndex += frameLen;
;;;447    		
;;;448    		for(i = 0;i < 500;i += 14)      //更改系数、偏移量的字节序
;;;449    		{
;;;450    			temp            = updateBuff[i+6];
;;;451    			updateBuff[i+6] = updateBuff[i+9];
;;;452    			updateBuff[i+9] = temp;
;;;453    			temp            = updateBuff[i+7];
;;;454    			updateBuff[i+7] = updateBuff[i+8];
;;;455    			updateBuff[i+8] = temp;
;;;456    			
;;;457    			temp             = updateBuff[i+10];
;;;458    			updateBuff[i+10] = updateBuff[i+13];
;;;459    			updateBuff[i+13] = temp;
;;;460    			temp             = updateBuff[i+11];
;;;461    			updateBuff[i+11] = updateBuff[i+12];
;;;462    			updateBuff[i+12] = temp;
;;;463    		}
;;;464    		
;;;465    		Save2KDataToFlash(updateBuff,PID2CONFIGADDR,500);//将数据写入第二配置文件区，（flash:0x08061000）
;;;466    		
;;;467    		canDataConfig.pidVersion = varOperation.newPIDVersion;
;;;468    		canDataConfig.pidNum     = varOperation.newPidNum;
;;;469    		
;;;470    		canDataConfig.busType    = varOperation.busType;     //todo:CAN线和K线的切换，后期处理
;;;471    		canDataConfig.canIdType  = varOperation.canIdType;
;;;472    		canDataConfig.canTxId    = varOperation.canTxId;
;;;473    		canDataConfig.canRxId    = varOperation.canRxId;
;;;474    		canDataConfig.canBaud    = varOperation.canBaud;
;;;475    		memcpy(canDataConfig.pidVerCmd,varOperation.pidVerCmd,8);
;;;476    		Save2KDataToFlash((uint8_t *)&canDataConfig,PIDCONFIG,(sizeof(_CANDataConfig)+3)); //保存 CAN 通讯参数
;;;477    		SendConfigNum(0x5018);
;;;478    	}else if(cmdId == 0x5018)
;;;479    	{
;;;480    		offset = 5;
;;;481    		memcpy(strengthFuel.ecuVer,&ptrDeal[offset],16); //版本号
;;;482    		offset += 16;
;;;483    		memcpy(strengthFuel.fuelAddr,&ptrDeal[offset],5);//读取喷油量的地址
;;;484    		offset += 5;
;;;485    		memcpy(strengthFuel.mask,&ptrDeal[offset],4); //安全算法掩码
;;;486    		offset += 4;
;;;487    		strengthFuel.coe = ptrDeal[offset];           //提升动力的系数
;;;488    		offset ++;
;;;489    		memcpy(strengthFuel.safe1,&ptrDeal[offset],8);//安全算法cmd 1
;;;490    		offset += 8;
;;;491    		memcpy(strengthFuel.safe2,&ptrDeal[offset],8);//安全算法cmd 2
;;;492    		offset += 8;
;;;493    		memcpy(strengthFuel.mode1,&ptrDeal[offset],8);//模式 cmd 1
;;;494    		offset += 8;
;;;495    		memcpy(strengthFuel.mode2,&ptrDeal[offset],8);//模式 cmd 2
;;;496    		offset += 8;
;;;497    		strengthFuel.modeOrder = ptrDeal[offset];     //模式指令与安全算法执行的顺序
;;;498    		offset++;
;;;499    		memcpy(strengthFuel.faultCmd1,&ptrDeal[offset],8); //当前故障码
;;;500    		offset += 8;
;;;501    		memcpy(strengthFuel.faultCmd2,&ptrDeal[offset],8); //历史故障码
;;;502    		offset += 8;
;;;503    		memcpy(strengthFuel.faultClear,&ptrDeal[offset],8);//清除故障码
;;;504    		
;;;505    		ptrMode = Mem_malloc(100);
;;;506    		offset = 0;
;;;507    		
;;;508    		memcpy(&ptrMode[offset],strengthFuel.ecuVer,16);//为了拷贝代码，我就用中间数据的方法得了
;;;509    		offset += 16;
;;;510    		memcpy(&ptrMode[offset],strengthFuel.fuelAddr,5);
;;;511    		offset += 5;
;;;512    		memcpy(&ptrMode[offset],strengthFuel.mask,4);
;;;513    		offset += 4;
;;;514    		memcpy(&ptrMode[offset],strengthFuel.safe1,8);
;;;515    		offset += 8;
;;;516    		memcpy(&ptrMode[offset],strengthFuel.safe2,8);
;;;517    		offset += 8;
;;;518    		memcpy(&ptrMode[offset],strengthFuel.mode1,8);
;;;519    		offset += 8;
;;;520    		memcpy(&ptrMode[offset],strengthFuel.mode2,8);
;;;521    		offset += 8;
;;;522    		ptrMode[offset++] = strengthFuel.modeOrder;
;;;523    		offset++;
;;;524    		memcpy(&ptrMode[offset],strengthFuel.faultCmd1,8);    //当前故障码指令
;;;525    		offset += 8;
;;;526    		memcpy(&ptrMode[offset],strengthFuel.faultCmd2,8);    //历史故障码指令
;;;527    		offset += 8;
;;;528    		memcpy(&ptrMode[offset],strengthFuel.faultClear,8);   //清除故障码指令
;;;529    		
;;;530    		Save2KDataToFlash(ptrMode,PROMOTE_ADDR,100);
;;;531    		Mem_free(ptrMode);
;;;532    		
;;;533    		__disable_fault_irq();                    //重启
;;;534    		NVIC_SystemReset();
;;;535    	}
;;;536    }
000158  e8bd87f0          POP      {r4-r10,pc}
                  |L4.348|
00015c  2402              MOVS     r4,#2                 ;389
00015e  4621              MOV      r1,r4                 ;390
000160  1c64              ADDS     r4,r4,#1              ;390
000162  5c68              LDRB     r0,[r5,r1]            ;390
000164  1ec0              SUBS     r0,r0,#3              ;390
000166  fa1ffa80          UXTH     r10,r0                ;390
00016a  4621              MOV      r1,r4                 ;391
00016c  1c64              ADDS     r4,r4,#1              ;391
00016e  5c6f              LDRB     r7,[r5,r1]            ;391
000170  4621              MOV      r1,r4                 ;392
000172  1c64              ADDS     r4,r4,#1              ;392
000174  5c68              LDRB     r0,[r5,r1]            ;392
000176  eb002007          ADD      r0,r0,r7,LSL #8       ;392
00017a  b287              UXTH     r7,r0                 ;392
00017c  1929              ADDS     r1,r5,r4              ;393
00017e  4aad              LDR      r2,|L4.1076|
000180  4ba9              LDR      r3,|L4.1064|
000182  881b              LDRH     r3,[r3,#0]            ;393  ; frameIndex
000184  18d0              ADDS     r0,r2,r3              ;393
000186  4652              MOV      r2,r10                ;393
000188  f7fffffe          BL       __aeabi_memcpy
00018c  48a6              LDR      r0,|L4.1064|
00018e  8800              LDRH     r0,[r0,#0]            ;394  ; frameIndex
000190  4450              ADD      r0,r0,r10             ;394
000192  49a5              LDR      r1,|L4.1064|
000194  8008              STRH     r0,[r1,#0]            ;394
000196  f5a74080          SUB      r0,r7,#0x4000         ;395
00019a  210b              MOVS     r1,#0xb               ;395
00019c  fb90f2f1          SDIV     r2,r0,r1              ;395
0001a0  fb010012          MLS      r0,r1,r2,r0           ;395
0001a4  2800              CMP      r0,#0                 ;395
0001a6  d141              BNE      |L4.556|
0001a8  489d              LDR      r0,|L4.1056|
0001aa  7800              LDRB     r0,[r0,#0]            ;395  ; pidPackNum
0001ac  1a38              SUBS     r0,r7,r0              ;395
0001ae  f5b04f80          CMP      r0,#0x4000            ;395
0001b2  d03b              BEQ      |L4.556|
0001b4  2600              MOVS     r6,#0                 ;397
0001b6  e017              B        |L4.488|
                  |L4.440|
0001b8  489e              LDR      r0,|L4.1076|
0001ba  f8109006          LDRB     r9,[r0,r6]            ;399
0001be  4601              MOV      r1,r0                 ;400
0001c0  1cf0              ADDS     r0,r6,#3              ;400
0001c2  5c08              LDRB     r0,[r1,r0]            ;400
0001c4  5588              STRB     r0,[r1,r6]            ;400
0001c6  1cf0              ADDS     r0,r6,#3              ;401
0001c8  f8019000          STRB     r9,[r1,r0]            ;401
0001cc  1c70              ADDS     r0,r6,#1              ;402
0001ce  f8119000          LDRB     r9,[r1,r0]            ;402
0001d2  1cb0              ADDS     r0,r6,#2              ;403
0001d4  5c09              LDRB     r1,[r1,r0]            ;403
0001d6  4a97              LDR      r2,|L4.1076|
0001d8  1c70              ADDS     r0,r6,#1              ;403
0001da  5411              STRB     r1,[r2,r0]            ;403
0001dc  4611              MOV      r1,r2                 ;404
0001de  1cb0              ADDS     r0,r6,#2              ;404
0001e0  f8019000          STRB     r9,[r1,r0]            ;404
0001e4  300f              ADDS     r0,r0,#0xf            ;397
0001e6  b286              UXTH     r6,r0                 ;397
                  |L4.488|
0001e8  488f              LDR      r0,|L4.1064|
0001ea  8800              LDRH     r0,[r0,#0]            ;397  ; frameIndex
0001ec  4286              CMP      r6,r0                 ;397
0001ee  dbe3              BLT      |L4.440|
0001f0  f44f6200          MOV      r2,#0x800             ;406
0001f4  488e              LDR      r0,|L4.1072|
0001f6  6801              LDR      r1,[r0,#0]            ;406  ; addrSavePid
0001f8  488e              LDR      r0,|L4.1076|
0001fa  f7fffffe          BL       Save2KDataToFlash
0001fe  488c              LDR      r0,|L4.1072|
000200  6800              LDR      r0,[r0,#0]            ;407  ; addrSavePid
000202  f5006000          ADD      r0,r0,#0x800          ;407
000206  498a              LDR      r1,|L4.1072|
000208  6008              STR      r0,[r1,#0]            ;407  ; addrSavePid
00020a  2000              MOVS     r0,#0                 ;408
00020c  4986              LDR      r1,|L4.1064|
00020e  8008              STRH     r0,[r1,#0]            ;408
000210  f44f6100          MOV      r1,#0x800             ;409
000214  4887              LDR      r0,|L4.1076|
000216  f7fffffe          BL       __aeabi_memclr
00021a  1c78              ADDS     r0,r7,#1              ;410
00021c  4981              LDR      r1,|L4.1060|
00021e  8008              STRH     r0,[r1,#0]            ;410
000220  4608              MOV      r0,r1                 ;411
000222  8800              LDRH     r0,[r0,#0]            ;411  ; currentNum
000224  f7fffffe          BL       SendConfigNum
000228  e1ad              B        |L4.1414|
                  |L4.554|
00022a  e042              B        |L4.690|
                  |L4.556|
00022c  487c              LDR      r0,|L4.1056|
00022e  7800              LDRB     r0,[r0,#0]            ;413  ; pidPackNum
000230  1a38              SUBS     r0,r7,r0              ;413
000232  f5b04f80          CMP      r0,#0x4000            ;413
000236  d134              BNE      |L4.674|
000238  2600              MOVS     r6,#0                 ;415
00023a  e017              B        |L4.620|
                  |L4.572|
00023c  487d              LDR      r0,|L4.1076|
00023e  f8109006          LDRB     r9,[r0,r6]            ;417
000242  4601              MOV      r1,r0                 ;418
000244  1cf0              ADDS     r0,r6,#3              ;418
000246  5c08              LDRB     r0,[r1,r0]            ;418
000248  5588              STRB     r0,[r1,r6]            ;418
00024a  1cf0              ADDS     r0,r6,#3              ;419
00024c  f8019000          STRB     r9,[r1,r0]            ;419
000250  1c70              ADDS     r0,r6,#1              ;420
000252  f8119000          LDRB     r9,[r1,r0]            ;420
000256  1cb0              ADDS     r0,r6,#2              ;421
000258  5c09              LDRB     r1,[r1,r0]            ;421
00025a  4a76              LDR      r2,|L4.1076|
00025c  1c70              ADDS     r0,r6,#1              ;421
00025e  5411              STRB     r1,[r2,r0]            ;421
000260  4611              MOV      r1,r2                 ;422
000262  1cb0              ADDS     r0,r6,#2              ;422
000264  f8019000          STRB     r9,[r1,r0]            ;422
000268  300f              ADDS     r0,r0,#0xf            ;415
00026a  b286              UXTH     r6,r0                 ;415
                  |L4.620|
00026c  486e              LDR      r0,|L4.1064|
00026e  8800              LDRH     r0,[r0,#0]            ;415  ; frameIndex
000270  4286              CMP      r6,r0                 ;415
000272  dbe3              BLT      |L4.572|
000274  f44f6200          MOV      r2,#0x800             ;424
000278  486d              LDR      r0,|L4.1072|
00027a  6801              LDR      r1,[r0,#0]            ;424  ; addrSavePid
00027c  486d              LDR      r0,|L4.1076|
00027e  f7fffffe          BL       Save2KDataToFlash
000282  486d              LDR      r0,|L4.1080|
000284  496a              LDR      r1,|L4.1072|
000286  6008              STR      r0,[r1,#0]            ;425  ; addrSavePid
000288  2000              MOVS     r0,#0                 ;426
00028a  4967              LDR      r1,|L4.1064|
00028c  8008              STRH     r0,[r1,#0]            ;426
00028e  f44f6100          MOV      r1,#0x800             ;427
000292  4868              LDR      r0,|L4.1076|
000294  f7fffffe          BL       __aeabi_memclr
000298  f2450012          MOV      r0,#0x5012            ;428
00029c  f7fffffe          BL       SendConfigNum
0002a0  e171              B        |L4.1414|
                  |L4.674|
0002a2  1c78              ADDS     r0,r7,#1              ;432
0002a4  495f              LDR      r1,|L4.1060|
0002a6  8008              STRH     r0,[r1,#0]            ;432
0002a8  4608              MOV      r0,r1                 ;433
0002aa  8800              LDRH     r0,[r0,#0]            ;433  ; currentNum
0002ac  f7fffffe          BL       SendConfigNum
0002b0  e169              B        |L4.1414|
                  |L4.690|
0002b2  f2450012          MOV      r0,#0x5012            ;436
0002b6  4287              CMP      r7,r0                 ;436
0002b8  d17e              BNE      |L4.952|
0002ba  2402              MOVS     r4,#2                 ;438
0002bc  4621              MOV      r1,r4                 ;439
0002be  1c64              ADDS     r4,r4,#1              ;439
0002c0  5c68              LDRB     r0,[r5,r1]            ;439
0002c2  1ec0              SUBS     r0,r0,#3              ;439
0002c4  fa1ffa80          UXTH     r10,r0                ;439
0002c8  200e              MOVS     r0,#0xe               ;441
0002ca  fb9af0f0          SDIV     r0,r10,r0             ;441
0002ce  495b              LDR      r1,|L4.1084|
0002d0  80c8              STRH     r0,[r1,#6]            ;441
0002d2  4621              MOV      r1,r4                 ;443
0002d4  1c64              ADDS     r4,r4,#1              ;443
0002d6  5c6f              LDRB     r7,[r5,r1]            ;443
0002d8  4621              MOV      r1,r4                 ;444
0002da  1c64              ADDS     r4,r4,#1              ;444
0002dc  5c68              LDRB     r0,[r5,r1]            ;444
0002de  eb002007          ADD      r0,r0,r7,LSL #8       ;444
0002e2  b287              UXTH     r7,r0                 ;444
0002e4  1929              ADDS     r1,r5,r4              ;445
0002e6  4652              MOV      r2,r10                ;445
0002e8  4852              LDR      r0,|L4.1076|
0002ea  f7fffffe          BL       __aeabi_memcpy
0002ee  484e              LDR      r0,|L4.1064|
0002f0  8800              LDRH     r0,[r0,#0]            ;446  ; frameIndex
0002f2  4450              ADD      r0,r0,r10             ;446
0002f4  494c              LDR      r1,|L4.1064|
0002f6  8008              STRH     r0,[r1,#0]            ;446
0002f8  2600              MOVS     r6,#0                 ;448
0002fa  e02f              B        |L4.860|
                  |L4.764|
0002fc  494d              LDR      r1,|L4.1076|
0002fe  1db0              ADDS     r0,r6,#6              ;450
000300  f8119000          LDRB     r9,[r1,r0]            ;450
000304  1cc0              ADDS     r0,r0,#3              ;451
000306  5c09              LDRB     r1,[r1,r0]            ;451
000308  4a4a              LDR      r2,|L4.1076|
00030a  1db0              ADDS     r0,r6,#6              ;451
00030c  5411              STRB     r1,[r2,r0]            ;451
00030e  4611              MOV      r1,r2                 ;452
000310  1cc0              ADDS     r0,r0,#3              ;452
000312  f8019000          STRB     r9,[r1,r0]            ;452
000316  1df0              ADDS     r0,r6,#7              ;453
000318  f8119000          LDRB     r9,[r1,r0]            ;453
00031c  1c40              ADDS     r0,r0,#1              ;454
00031e  5c09              LDRB     r1,[r1,r0]            ;454
000320  1df0              ADDS     r0,r6,#7              ;454
000322  5411              STRB     r1,[r2,r0]            ;454
000324  4611              MOV      r1,r2                 ;455
000326  1c40              ADDS     r0,r0,#1              ;455
000328  f8019000          STRB     r9,[r1,r0]            ;455
00032c  1c80              ADDS     r0,r0,#2              ;457
00032e  f8119000          LDRB     r9,[r1,r0]            ;457
000332  1cc0              ADDS     r0,r0,#3              ;458
000334  5c09              LDRB     r1,[r1,r0]            ;458
000336  1ec0              SUBS     r0,r0,#3              ;458
000338  5411              STRB     r1,[r2,r0]            ;458
00033a  4611              MOV      r1,r2                 ;459
00033c  1cc0              ADDS     r0,r0,#3              ;459
00033e  f8019000          STRB     r9,[r1,r0]            ;459
000342  1e80              SUBS     r0,r0,#2              ;460
000344  f8119000          LDRB     r9,[r1,r0]            ;460
000348  1c40              ADDS     r0,r0,#1              ;461
00034a  5c09              LDRB     r1,[r1,r0]            ;461
00034c  1e40              SUBS     r0,r0,#1              ;461
00034e  5411              STRB     r1,[r2,r0]            ;461
000350  4611              MOV      r1,r2                 ;462
000352  1c40              ADDS     r0,r0,#1              ;462
000354  f8019000          STRB     r9,[r1,r0]            ;462
000358  1c80              ADDS     r0,r0,#2              ;448
00035a  b286              UXTH     r6,r0                 ;448
                  |L4.860|
00035c  f5b67ffa          CMP      r6,#0x1f4             ;448
000360  dbcc              BLT      |L4.764|
000362  f44f72fa          MOV      r2,#0x1f4             ;465
000366  4934              LDR      r1,|L4.1080|
000368  4832              LDR      r0,|L4.1076|
00036a  f7fffffe          BL       Save2KDataToFlash
00036e  482b              LDR      r0,|L4.1052|
000370  f8d0007e          LDR      r0,[r0,#0x7e]         ;467  ; varOperation
000374  4931              LDR      r1,|L4.1084|
000376  6008              STR      r0,[r1,#0]            ;467  ; canDataConfig
000378  4828              LDR      r0,|L4.1052|
00037a  f8b00082          LDRH     r0,[r0,#0x82]         ;468  ; varOperation
00037e  8088              STRH     r0,[r1,#4]            ;468
000380  4826              LDR      r0,|L4.1052|
000382  f8900086          LDRB     r0,[r0,#0x86]         ;470  ; varOperation
000386  7208              STRB     r0,[r1,#8]            ;470
000388  4824              LDR      r0,|L4.1052|
00038a  f8900087          LDRB     r0,[r0,#0x87]         ;471  ; varOperation
00038e  7248              STRB     r0,[r1,#9]            ;471
000390  4822              LDR      r0,|L4.1052|
000392  f8d00088          LDR      r0,[r0,#0x88]         ;472  ; varOperation
000396  f8c1000a          STR      r0,[r1,#0xa]          ;472  ; canDataConfig
00039a  4820              LDR      r0,|L4.1052|
00039c  f8d0008c          LDR      r0,[r0,#0x8c]         ;473  ; varOperation
0003a0  f8c1000e          STR      r0,[r1,#0xe]          ;473  ; canDataConfig
0003a4  481d              LDR      r0,|L4.1052|
0003a6  f8900090          LDRB     r0,[r0,#0x90]         ;474  ; varOperation
0003aa  7488              STRB     r0,[r1,#0x12]         ;474
0003ac  3113              ADDS     r1,r1,#0x13           ;475
0003ae  481b              LDR      r0,|L4.1052|
0003b0  309b              ADDS     r0,r0,#0x9b           ;475
0003b2  6802              LDR      r2,[r0,#0]            ;475  ; varOperation
0003b4  600a              STR      r2,[r1,#0]            ;475  ; canDataConfig
0003b6  e000              B        |L4.954|
                  |L4.952|
0003b8  e00b              B        |L4.978|
                  |L4.954|
0003ba  6840              LDR      r0,[r0,#4]            ;475  ; varOperation
0003bc  6048              STR      r0,[r1,#4]            ;475  ; canDataConfig
0003be  221e              MOVS     r2,#0x1e              ;476
0003c0  491f              LDR      r1,|L4.1088|
0003c2  481e              LDR      r0,|L4.1084|
0003c4  f7fffffe          BL       Save2KDataToFlash
0003c8  f2450018          MOV      r0,#0x5018            ;477
0003cc  f7fffffe          BL       SendConfigNum
                  |L4.976|
0003d0  e0d9              B        |L4.1414|
                  |L4.978|
0003d2  f2450018          MOV      r0,#0x5018            ;478
0003d6  4287              CMP      r7,r0                 ;478
0003d8  d1fa              BNE      |L4.976|
0003da  2405              MOVS     r4,#5                 ;480
0003dc  1929              ADDS     r1,r5,r4              ;481
0003de  2210              MOVS     r2,#0x10              ;481
0003e0  4818              LDR      r0,|L4.1092|
0003e2  f7fffffe          BL       __aeabi_memcpy
0003e6  3410              ADDS     r4,r4,#0x10           ;482
0003e8  1929              ADDS     r1,r5,r4              ;483
0003ea  4816              LDR      r0,|L4.1092|
0003ec  680a              LDR      r2,[r1,#0]            ;483
0003ee  6102              STR      r2,[r0,#0x10]         ;483  ; strengthFuel
0003f0  7909              LDRB     r1,[r1,#4]            ;483
0003f2  7501              STRB     r1,[r0,#0x14]         ;483
0003f4  1d64              ADDS     r4,r4,#5              ;484
0003f6  1929              ADDS     r1,r5,r4              ;485
0003f8  6809              LDR      r1,[r1,#0]            ;485
0003fa  f8c01015          STR      r1,[r0,#0x15]         ;485  ; strengthFuel
0003fe  1d24              ADDS     r4,r4,#4              ;486
000400  5d28              LDRB     r0,[r5,r4]            ;487
000402  b240              SXTB     r0,r0                 ;487
000404  490f              LDR      r1,|L4.1092|
000406  7648              STRB     r0,[r1,#0x19]         ;487
000408  1c64              ADDS     r4,r4,#1              ;488
00040a  1928              ADDS     r0,r5,r4              ;489
00040c  311a              ADDS     r1,r1,#0x1a           ;489
00040e  6802              LDR      r2,[r0,#0]            ;489
000410  600a              STR      r2,[r1,#0]            ;489  ; strengthFuel
000412  6840              LDR      r0,[r0,#4]            ;489
000414  6048              STR      r0,[r1,#4]            ;489  ; strengthFuel
000416  3408              ADDS     r4,r4,#8              ;490
000418  1929              ADDS     r1,r5,r4              ;491
00041a  e015              B        |L4.1096|
                  |L4.1052|
                          DCD      varOperation
                  |L4.1056|
                          DCD      pidPackNum
                  |L4.1060|
                          DCD      |symbol_number.51|
                  |L4.1064|
                          DCD      |symbol_number.52|
                  |L4.1068|
                          DCD      0x08063000
                  |L4.1072|
                          DCD      addrSavePid
                  |L4.1076|
                          DCD      updateBuff
                  |L4.1080|
                          DCD      0x08061000
                  |L4.1084|
                          DCD      canDataConfig
                  |L4.1088|
                          DCD      0x08060800
                  |L4.1092|
                          DCD      strengthFuel
                  |L4.1096|
000448  4850              LDR      r0,|L4.1420|
00044a  680a              LDR      r2,[r1,#0]            ;491
00044c  6002              STR      r2,[r0,#0]            ;491  ; strengthFuel
00044e  6849              LDR      r1,[r1,#4]            ;491
000450  6041              STR      r1,[r0,#4]            ;491  ; strengthFuel
000452  3408              ADDS     r4,r4,#8              ;492
000454  1929              ADDS     r1,r5,r4              ;493
000456  3008              ADDS     r0,r0,#8              ;493
000458  680a              LDR      r2,[r1,#0]            ;493
00045a  6002              STR      r2,[r0,#0]            ;493  ; strengthFuel
00045c  6849              LDR      r1,[r1,#4]            ;493
00045e  6041              STR      r1,[r0,#4]            ;493  ; strengthFuel
000460  3408              ADDS     r4,r4,#8              ;494
000462  1929              ADDS     r1,r5,r4              ;495
000464  3008              ADDS     r0,r0,#8              ;495
000466  680a              LDR      r2,[r1,#0]            ;495
000468  6002              STR      r2,[r0,#0]            ;495  ; strengthFuel
00046a  6849              LDR      r1,[r1,#4]            ;495
00046c  6041              STR      r1,[r0,#4]            ;495  ; strengthFuel
00046e  3408              ADDS     r4,r4,#8              ;496
000470  5d28              LDRB     r0,[r5,r4]            ;497
000472  4946              LDR      r1,|L4.1420|
000474  3922              SUBS     r1,r1,#0x22           ;497
000476  f881003a          STRB     r0,[r1,#0x3a]         ;497
00047a  1c64              ADDS     r4,r4,#1              ;498
00047c  1928              ADDS     r0,r5,r4              ;499
00047e  313b              ADDS     r1,r1,#0x3b           ;499
000480  6802              LDR      r2,[r0,#0]            ;499
000482  600a              STR      r2,[r1,#0]            ;499  ; strengthFuel
000484  6840              LDR      r0,[r0,#4]            ;499
000486  6048              STR      r0,[r1,#4]            ;499  ; strengthFuel
000488  3408              ADDS     r4,r4,#8              ;500
00048a  1929              ADDS     r1,r5,r4              ;501
00048c  483f              LDR      r0,|L4.1420|
00048e  3021              ADDS     r0,r0,#0x21           ;501
000490  680a              LDR      r2,[r1,#0]            ;501
000492  6002              STR      r2,[r0,#0]            ;501  ; strengthFuel
000494  6849              LDR      r1,[r1,#4]            ;501
000496  6041              STR      r1,[r0,#4]            ;501  ; strengthFuel
000498  3408              ADDS     r4,r4,#8              ;502
00049a  1928              ADDS     r0,r5,r4              ;503
00049c  493b              LDR      r1,|L4.1420|
00049e  3129              ADDS     r1,r1,#0x29           ;503
0004a0  6802              LDR      r2,[r0,#0]            ;503
0004a2  600a              STR      r2,[r1,#0]            ;503  ; strengthFuel
0004a4  6840              LDR      r0,[r0,#4]            ;503
0004a6  6048              STR      r0,[r1,#4]            ;503  ; strengthFuel
0004a8  2064              MOVS     r0,#0x64              ;505
0004aa  f7fffffe          BL       Mem_malloc
0004ae  4680              MOV      r8,r0                 ;505
0004b0  2400              MOVS     r4,#0                 ;506
0004b2  eb080004          ADD      r0,r8,r4              ;508
0004b6  2210              MOVS     r2,#0x10              ;508
0004b8  4934              LDR      r1,|L4.1420|
0004ba  3922              SUBS     r1,r1,#0x22           ;508
0004bc  f7fffffe          BL       __aeabi_memcpy
0004c0  3410              ADDS     r4,r4,#0x10           ;509
0004c2  eb080004          ADD      r0,r8,r4              ;510
0004c6  4931              LDR      r1,|L4.1420|
0004c8  3922              SUBS     r1,r1,#0x22           ;510
0004ca  690a              LDR      r2,[r1,#0x10]         ;510  ; strengthFuel
0004cc  6002              STR      r2,[r0,#0]            ;510
0004ce  7d09              LDRB     r1,[r1,#0x14]         ;510  ; strengthFuel
0004d0  7101              STRB     r1,[r0,#4]            ;510
0004d2  1d64              ADDS     r4,r4,#5              ;511
0004d4  eb080004          ADD      r0,r8,r4              ;512
0004d8  492c              LDR      r1,|L4.1420|
0004da  3922              SUBS     r1,r1,#0x22           ;512
0004dc  f8d11015          LDR      r1,[r1,#0x15]         ;512  ; strengthFuel
0004e0  6001              STR      r1,[r0,#0]            ;512
0004e2  1d24              ADDS     r4,r4,#4              ;513
0004e4  eb080004          ADD      r0,r8,r4              ;514
0004e8  4928              LDR      r1,|L4.1420|
0004ea  3908              SUBS     r1,r1,#8              ;514
0004ec  680a              LDR      r2,[r1,#0]            ;514  ; strengthFuel
0004ee  6002              STR      r2,[r0,#0]            ;514
0004f0  6849              LDR      r1,[r1,#4]            ;514  ; strengthFuel
0004f2  6041              STR      r1,[r0,#4]            ;514
0004f4  3408              ADDS     r4,r4,#8              ;515
0004f6  eb080004          ADD      r0,r8,r4              ;516
0004fa  4924              LDR      r1,|L4.1420|
0004fc  680a              LDR      r2,[r1,#0]            ;516  ; strengthFuel
0004fe  6002              STR      r2,[r0,#0]            ;516
000500  6849              LDR      r1,[r1,#4]            ;516  ; strengthFuel
000502  6041              STR      r1,[r0,#4]            ;516
000504  3408              ADDS     r4,r4,#8              ;517
000506  eb080004          ADD      r0,r8,r4              ;518
00050a  4920              LDR      r1,|L4.1420|
00050c  3108              ADDS     r1,r1,#8              ;518
00050e  680a              LDR      r2,[r1,#0]            ;518  ; strengthFuel
000510  6002              STR      r2,[r0,#0]            ;518
000512  6849              LDR      r1,[r1,#4]            ;518  ; strengthFuel
000514  6041              STR      r1,[r0,#4]            ;518
000516  3408              ADDS     r4,r4,#8              ;519
000518  eb080004          ADD      r0,r8,r4              ;520
00051c  491b              LDR      r1,|L4.1420|
00051e  3110              ADDS     r1,r1,#0x10           ;520
000520  680a              LDR      r2,[r1,#0]            ;520  ; strengthFuel
000522  6002              STR      r2,[r0,#0]            ;520
000524  6849              LDR      r1,[r1,#4]            ;520  ; strengthFuel
000526  6041              STR      r1,[r0,#4]            ;520
000528  3408              ADDS     r4,r4,#8              ;521
00052a  4818              LDR      r0,|L4.1420|
00052c  3822              SUBS     r0,r0,#0x22           ;522
00052e  f890203a          LDRB     r2,[r0,#0x3a]         ;522  ; strengthFuel
000532  4621              MOV      r1,r4                 ;522
000534  1c64              ADDS     r4,r4,#1              ;522
000536  f8082001          STRB     r2,[r8,r1]            ;522
00053a  1c64              ADDS     r4,r4,#1              ;523
00053c  eb080004          ADD      r0,r8,r4              ;524
000540  4912              LDR      r1,|L4.1420|
000542  3119              ADDS     r1,r1,#0x19           ;524
000544  680a              LDR      r2,[r1,#0]            ;524  ; strengthFuel
000546  6002              STR      r2,[r0,#0]            ;524
000548  6849              LDR      r1,[r1,#4]            ;524  ; strengthFuel
00054a  6041              STR      r1,[r0,#4]            ;524
00054c  3408              ADDS     r4,r4,#8              ;525
00054e  eb080004          ADD      r0,r8,r4              ;526
000552  490e              LDR      r1,|L4.1420|
000554  3121              ADDS     r1,r1,#0x21           ;526
000556  680a              LDR      r2,[r1,#0]            ;526  ; strengthFuel
000558  6002              STR      r2,[r0,#0]            ;526
00055a  6849              LDR      r1,[r1,#4]            ;526  ; strengthFuel
00055c  6041              STR      r1,[r0,#4]            ;526
00055e  3408              ADDS     r4,r4,#8              ;527
000560  eb080004          ADD      r0,r8,r4              ;528
000564  4909              LDR      r1,|L4.1420|
000566  3129              ADDS     r1,r1,#0x29           ;528
000568  680a              LDR      r2,[r1,#0]            ;528  ; strengthFuel
00056a  6002              STR      r2,[r0,#0]            ;528
00056c  6849              LDR      r1,[r1,#4]            ;528  ; strengthFuel
00056e  6041              STR      r1,[r0,#4]            ;528
000570  2264              MOVS     r2,#0x64              ;530
000572  4907              LDR      r1,|L4.1424|
000574  4640              MOV      r0,r8                 ;530
000576  f7fffffe          BL       Save2KDataToFlash
00057a  4640              MOV      r0,r8                 ;531
00057c  f7fffffe          BL       Mem_free
000580  b671              CPSID    f                     ;533
000582  f7fffffe          BL       __NVIC_SystemReset
                  |L4.1414|
000586  bf00              NOP      
000588  e5e6              B        |L4.344|
;;;537    #include "obd.h"
                          ENDP

00058a  0000              DCW      0x0000
                  |L4.1420|
                          DCD      strengthFuel+0x22
                  |L4.1424|
                          DCD      0x08065000

                          AREA ||i.FuelModeChange||, CODE, READONLY, ALIGN=2

                  FuelModeChange PROC
;;;699    extern uint8_t strengPower[300];
;;;700    static void FuelModeChange(uint8_t* ptrDeal)          //节油、强动力、普通模式 切换
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;701    {
000004  4606              MOV      r6,r0
;;;702    	uint16_t offset  = 5;
000006  2405              MOVS     r4,#5
;;;703    	uint8_t* ptrMode = NULL;
000008  2500              MOVS     r5,#0
;;;704    	uint16_t newCRC  = 0,nowCRC = 0;
00000a  2700              MOVS     r7,#0
00000c  f04f0800          MOV      r8,#0
;;;705    	
;;;706    	memcpy(strengthFuel.ecuVer,&ptrDeal[offset],16);  //版本号
000010  1931              ADDS     r1,r6,r4
000012  2210              MOVS     r2,#0x10
000014  489b              LDR      r0,|L5.644|
000016  f7fffffe          BL       __aeabi_memcpy
;;;707    	offset += 16;
00001a  3410              ADDS     r4,r4,#0x10
;;;708    	memcpy(strengthFuel.fuelAddr,&ptrDeal[offset],5); //读取喷油量的地址
00001c  1931              ADDS     r1,r6,r4
00001e  4899              LDR      r0,|L5.644|
000020  680a              LDR      r2,[r1,#0]
000022  6102              STR      r2,[r0,#0x10]  ; strengthFuel
000024  7909              LDRB     r1,[r1,#4]
000026  7501              STRB     r1,[r0,#0x14]
;;;709    	offset += 5;
000028  1d64              ADDS     r4,r4,#5
;;;710    	memcpy(strengthFuel.mask,&ptrDeal[offset],4);     //安全算法掩码
00002a  1931              ADDS     r1,r6,r4
00002c  6809              LDR      r1,[r1,#0]
00002e  f8c01015          STR      r1,[r0,#0x15]  ; strengthFuel
;;;711    	offset += 4;
000032  1d24              ADDS     r4,r4,#4
;;;712    	strengthFuel.coe = ptrDeal[offset];               //提升动力的系数
000034  5d30              LDRB     r0,[r6,r4]
000036  b240              SXTB     r0,r0
000038  4992              LDR      r1,|L5.644|
00003a  7648              STRB     r0,[r1,#0x19]
;;;713    	offset ++;
00003c  1c64              ADDS     r4,r4,#1
;;;714    	memcpy(strengthFuel.safe1,&ptrDeal[offset],8);    //安全算法cmd 1
00003e  1930              ADDS     r0,r6,r4
000040  311a              ADDS     r1,r1,#0x1a
000042  6802              LDR      r2,[r0,#0]
000044  600a              STR      r2,[r1,#0]  ; strengthFuel
000046  6840              LDR      r0,[r0,#4]
000048  6048              STR      r0,[r1,#4]  ; strengthFuel
;;;715    	offset += 8;
00004a  3408              ADDS     r4,r4,#8
;;;716    	memcpy(strengthFuel.safe2,&ptrDeal[offset],8);    //安全算法cmd 2
00004c  1930              ADDS     r0,r6,r4
00004e  3108              ADDS     r1,r1,#8
000050  6802              LDR      r2,[r0,#0]
000052  600a              STR      r2,[r1,#0]  ; strengthFuel
000054  6840              LDR      r0,[r0,#4]
000056  6048              STR      r0,[r1,#4]  ; strengthFuel
;;;717    	offset += 8;
000058  3408              ADDS     r4,r4,#8
;;;718    	memcpy(strengthFuel.mode1,&ptrDeal[offset],8);    //模式 cmd 1
00005a  1930              ADDS     r0,r6,r4
00005c  3108              ADDS     r1,r1,#8
00005e  6802              LDR      r2,[r0,#0]
000060  600a              STR      r2,[r1,#0]  ; strengthFuel
000062  6840              LDR      r0,[r0,#4]
000064  6048              STR      r0,[r1,#4]  ; strengthFuel
;;;719    	offset += 8;
000066  3408              ADDS     r4,r4,#8
;;;720    	memcpy(strengthFuel.mode2,&ptrDeal[offset],8);    //模式 cmd 2
000068  1931              ADDS     r1,r6,r4
00006a  4886              LDR      r0,|L5.644|
00006c  3032              ADDS     r0,r0,#0x32
00006e  680a              LDR      r2,[r1,#0]
000070  6002              STR      r2,[r0,#0]  ; strengthFuel
000072  6849              LDR      r1,[r1,#4]
000074  6041              STR      r1,[r0,#4]  ; strengthFuel
;;;721    	offset += 8;
000076  3408              ADDS     r4,r4,#8
;;;722    	strengthFuel.modeOrder = ptrDeal[offset];         //模式指令与安全算法执行的顺序
000078  5d30              LDRB     r0,[r6,r4]
00007a  4982              LDR      r1,|L5.644|
00007c  f881003a          STRB     r0,[r1,#0x3a]
;;;723    	offset++;
000080  1c64              ADDS     r4,r4,#1
;;;724    	memcpy(strengthFuel.faultCmd1,&ptrDeal[offset],8);    //当前故障码
000082  1930              ADDS     r0,r6,r4
000084  313b              ADDS     r1,r1,#0x3b
000086  6802              LDR      r2,[r0,#0]
000088  600a              STR      r2,[r1,#0]  ; strengthFuel
00008a  6840              LDR      r0,[r0,#4]
00008c  6048              STR      r0,[r1,#4]  ; strengthFuel
;;;725    	offset += 8;
00008e  3408              ADDS     r4,r4,#8
;;;726    	memcpy(strengthFuel.faultCmd2,&ptrDeal[offset],8);    //历史故障码
000090  1930              ADDS     r0,r6,r4
000092  3108              ADDS     r1,r1,#8
000094  6802              LDR      r2,[r0,#0]
000096  600a              STR      r2,[r1,#0]  ; strengthFuel
000098  6840              LDR      r0,[r0,#4]
00009a  6048              STR      r0,[r1,#4]  ; strengthFuel
;;;727    	offset += 8;
00009c  3408              ADDS     r4,r4,#8
;;;728    	memcpy(strengthFuel.faultClear,&ptrDeal[offset],8);   //清除故障码
00009e  1930              ADDS     r0,r6,r4
0000a0  3108              ADDS     r1,r1,#8
0000a2  6802              LDR      r2,[r0,#0]
0000a4  600a              STR      r2,[r1,#0]  ; strengthFuel
0000a6  6840              LDR      r0,[r0,#4]
0000a8  6048              STR      r0,[r1,#4]  ; strengthFuel
;;;729    
;;;730    	if(strengthFuel.coe == strengthFuelFlash.coe)
0000aa  4876              LDR      r0,|L5.644|
0000ac  f9900019          LDRSB    r0,[r0,#0x19]  ; strengthFuel
0000b0  4975              LDR      r1,|L5.648|
0000b2  f9911019          LDRSB    r1,[r1,#0x19]  ; strengthFuelFlash
0000b6  4288              CMP      r0,r1
0000b8  d10f              BNE      |L5.218|
;;;731    	{
;;;732    		ptrMode = Mem_malloc(5);  //
0000ba  2005              MOVS     r0,#5
0000bc  f7fffffe          BL       Mem_malloc
0000c0  4605              MOV      r5,r0
;;;733    		ptrMode[0] = 4;           //长度
0000c2  2004              MOVS     r0,#4
0000c4  7028              STRB     r0,[r5,#0]
;;;734    		ptrMode[1] = 0x50;
0000c6  2050              MOVS     r0,#0x50
0000c8  7068              STRB     r0,[r5,#1]
;;;735    		ptrMode[2] = 0x15;
0000ca  2015              MOVS     r0,#0x15
0000cc  70a8              STRB     r0,[r5,#2]
;;;736    		ptrMode[3] = strengthFuel.coe;
0000ce  486d              LDR      r0,|L5.644|
0000d0  7e40              LDRB     r0,[r0,#0x19]  ; strengthFuel
0000d2  70e8              STRB     r0,[r5,#3]
;;;737    		SendPidCmdData(ptrMode);
0000d4  4628              MOV      r0,r5
0000d6  f7fffffe          BL       SendPidCmdData
                  |L5.218|
;;;738    	}
;;;739    	Mem_free(ptrMode);
0000da  4628              MOV      r0,r5
0000dc  f7fffffe          BL       Mem_free
;;;740    	Mem_free(ptrDeal);
0000e0  4630              MOV      r0,r6
0000e2  f7fffffe          BL       Mem_free
;;;741    	
;;;742    	newCRC = CRC_ComputeFile(newCRC,strengthFuel.ecuVer,16);
0000e6  2210              MOVS     r2,#0x10
0000e8  4966              LDR      r1,|L5.644|
0000ea  4638              MOV      r0,r7
0000ec  f7fffffe          BL       CRC_ComputeFile
0000f0  4607              MOV      r7,r0
;;;743    	newCRC = CRC_ComputeFile(newCRC,strengthFuel.fuelAddr,5);
0000f2  2205              MOVS     r2,#5
0000f4  4963              LDR      r1,|L5.644|
0000f6  3110              ADDS     r1,r1,#0x10
0000f8  4638              MOV      r0,r7
0000fa  f7fffffe          BL       CRC_ComputeFile
0000fe  4607              MOV      r7,r0
;;;744    	newCRC = CRC_ComputeFile(newCRC,strengthFuel.mask,4);
000100  2204              MOVS     r2,#4
000102  4960              LDR      r1,|L5.644|
000104  3115              ADDS     r1,r1,#0x15
000106  4638              MOV      r0,r7
000108  f7fffffe          BL       CRC_ComputeFile
00010c  4607              MOV      r7,r0
;;;745    	newCRC = CRC_ComputeFile(newCRC,strengthFuel.safe1,8);
00010e  2208              MOVS     r2,#8
000110  495c              LDR      r1,|L5.644|
000112  311a              ADDS     r1,r1,#0x1a
000114  4638              MOV      r0,r7
000116  f7fffffe          BL       CRC_ComputeFile
00011a  4607              MOV      r7,r0
;;;746    	newCRC = CRC_ComputeFile(newCRC,strengthFuel.safe2,8);
00011c  2208              MOVS     r2,#8
00011e  4959              LDR      r1,|L5.644|
000120  3122              ADDS     r1,r1,#0x22
000122  4638              MOV      r0,r7
000124  f7fffffe          BL       CRC_ComputeFile
000128  4607              MOV      r7,r0
;;;747    	newCRC = CRC_ComputeFile(newCRC,strengthFuel.mode1,8);
00012a  2208              MOVS     r2,#8
00012c  4955              LDR      r1,|L5.644|
00012e  312a              ADDS     r1,r1,#0x2a
000130  4638              MOV      r0,r7
000132  f7fffffe          BL       CRC_ComputeFile
000136  4607              MOV      r7,r0
;;;748    	newCRC = CRC_ComputeFile(newCRC,strengthFuel.mode2,8);
000138  2208              MOVS     r2,#8
00013a  4952              LDR      r1,|L5.644|
00013c  3132              ADDS     r1,r1,#0x32
00013e  4638              MOV      r0,r7
000140  f7fffffe          BL       CRC_ComputeFile
000144  4607              MOV      r7,r0
;;;749    	
;;;750    	nowCRC = CRC_ComputeFile(nowCRC,strengthFuelFlash.ecuVer,16);
000146  2210              MOVS     r2,#0x10
000148  494f              LDR      r1,|L5.648|
00014a  4640              MOV      r0,r8
00014c  f7fffffe          BL       CRC_ComputeFile
000150  4680              MOV      r8,r0
;;;751    	nowCRC = CRC_ComputeFile(nowCRC,strengthFuelFlash.fuelAddr,5);
000152  2205              MOVS     r2,#5
000154  494c              LDR      r1,|L5.648|
000156  3110              ADDS     r1,r1,#0x10
000158  4640              MOV      r0,r8
00015a  f7fffffe          BL       CRC_ComputeFile
00015e  4680              MOV      r8,r0
;;;752    	nowCRC = CRC_ComputeFile(nowCRC,strengthFuelFlash.mask,4);
000160  2204              MOVS     r2,#4
000162  4949              LDR      r1,|L5.648|
000164  3115              ADDS     r1,r1,#0x15
000166  4640              MOV      r0,r8
000168  f7fffffe          BL       CRC_ComputeFile
00016c  4680              MOV      r8,r0
;;;753    	nowCRC = CRC_ComputeFile(nowCRC,strengthFuelFlash.safe1,8);
00016e  2208              MOVS     r2,#8
000170  4945              LDR      r1,|L5.648|
000172  311a              ADDS     r1,r1,#0x1a
000174  4640              MOV      r0,r8
000176  f7fffffe          BL       CRC_ComputeFile
00017a  4680              MOV      r8,r0
;;;754    	nowCRC = CRC_ComputeFile(nowCRC,strengthFuelFlash.safe2,8);
00017c  2208              MOVS     r2,#8
00017e  4942              LDR      r1,|L5.648|
000180  3122              ADDS     r1,r1,#0x22
000182  4640              MOV      r0,r8
000184  f7fffffe          BL       CRC_ComputeFile
000188  4680              MOV      r8,r0
;;;755    	nowCRC = CRC_ComputeFile(nowCRC,strengthFuelFlash.mode1,8);
00018a  2208              MOVS     r2,#8
00018c  493e              LDR      r1,|L5.648|
00018e  312a              ADDS     r1,r1,#0x2a
000190  4640              MOV      r0,r8
000192  f7fffffe          BL       CRC_ComputeFile
000196  4680              MOV      r8,r0
;;;756    	nowCRC = CRC_ComputeFile(nowCRC,strengthFuelFlash.mode2,8);
000198  2208              MOVS     r2,#8
00019a  493b              LDR      r1,|L5.648|
00019c  3132              ADDS     r1,r1,#0x32
00019e  4640              MOV      r0,r8
0001a0  f7fffffe          BL       CRC_ComputeFile
0001a4  4680              MOV      r8,r0
;;;757    	if(nowCRC == newCRC)
0001a6  45b8              CMP      r8,r7
0001a8  d101              BNE      |L5.430|
;;;758    		return;
;;;759    	ptrMode = Mem_malloc(100);
;;;760    	offset = 0;
;;;761    	
;;;762    	memcpy(&ptrMode[offset],strengthFuel.ecuVer,16);
;;;763    	offset += 16;
;;;764    	memcpy(&ptrMode[offset],strengthFuel.fuelAddr,5);
;;;765    	offset += 5;
;;;766    	memcpy(&ptrMode[offset],strengthFuel.mask,4);
;;;767    	offset += 4;
;;;768    	memcpy(&ptrMode[offset],strengthFuel.safe1,8);
;;;769    	offset += 8;
;;;770    	memcpy(&ptrMode[offset],strengthFuel.safe2,8);
;;;771    	offset += 8;
;;;772    	memcpy(&ptrMode[offset],strengthFuel.mode1,8);
;;;773    	offset += 8;
;;;774    	memcpy(&ptrMode[offset],strengthFuel.mode2,8);
;;;775    	offset += 8;
;;;776    	ptrMode[offset++] = strengthFuel.modeOrder;
;;;777    	offset++;
;;;778    	memcpy(&ptrMode[offset],strengthFuel.faultCmd1,8);    //当前故障码指令
;;;779    	offset += 8;
;;;780    	memcpy(&ptrMode[offset],strengthFuel.faultCmd2,8);    //历史故障码指令
;;;781    	offset += 8;
;;;782    	memcpy(&ptrMode[offset],strengthFuel.faultClear,8);   //清除故障码指令
;;;783    	
;;;784    	Save2KDataToFlash(ptrMode,PROMOTE_ADDR,100);                //将新的增强动力指令写入Flash
;;;785    	
;;;786    //	Mem_free(ptrMode);
;;;787    //	memcpy(strengthFuelFlash.ecuVer,strengthFuel.ecuVer,16);   //版本号
;;;788    //	memcpy(strengthFuelFlash.fuelAddr,strengthFuel.fuelAddr,5);//读取喷油量的地址
;;;789    //	memcpy(strengthFuelFlash.mask,strengthFuel.mask,4);        //安全算法掩码
;;;790    //	memcpy(strengthFuelFlash.safe1,strengthFuel.safe1,8);      //安全算法 cmd 1
;;;791    //	memcpy(strengthFuelFlash.safe2,strengthFuel.safe2,8);      //安全算法 cmd 2
;;;792    //	memcpy(strengthFuelFlash.mode1,strengthFuel.mode1,8);      //模式 cmd 1
;;;793    //	memcpy(strengthFuelFlash.mode2,strengthFuel.mode2,8);      //模式 cmd 2
;;;794    //	strengthFuelFlash.modeOrder = strengthFuel.modeOrder;      //模式指令与安全算法执行的顺序
;;;795    //	
;;;796    //	memcpy(strengthFuelFlash.faultCmd1,strengthFuel.faultCmd1,8);      //模式 cmd 2
;;;797    //	memcpy(strengthFuelFlash.faultCmd2,strengthFuel.faultCmd2,8);      //模式 cmd 2
;;;798    //	memcpy(strengthFuelFlash.faultClear,strengthFuel.faultClear,8);     //模式 cmd 2
;;;799    	
;;;800    	memset(strengPower,0,200);                    //清空Flash保存的喷油量的值
;;;801    	SoftErasePage(STRENGE_Q);
;;;802    	Save2KDataToFlash(strengPower,STRENGE_Q,200);
;;;803    	
;;;804    	__disable_fault_irq();                    //重启
;;;805    	NVIC_SystemReset();
;;;806    }
0001aa  e8bd81f0          POP      {r4-r8,pc}
                  |L5.430|
0001ae  2064              MOVS     r0,#0x64              ;759
0001b0  f7fffffe          BL       Mem_malloc
0001b4  4605              MOV      r5,r0                 ;759
0001b6  2400              MOVS     r4,#0                 ;760
0001b8  1928              ADDS     r0,r5,r4              ;762
0001ba  2210              MOVS     r2,#0x10              ;762
0001bc  4931              LDR      r1,|L5.644|
0001be  f7fffffe          BL       __aeabi_memcpy
0001c2  3410              ADDS     r4,r4,#0x10           ;763
0001c4  1928              ADDS     r0,r5,r4              ;764
0001c6  492f              LDR      r1,|L5.644|
0001c8  690a              LDR      r2,[r1,#0x10]         ;764  ; strengthFuel
0001ca  6002              STR      r2,[r0,#0]            ;764
0001cc  7d09              LDRB     r1,[r1,#0x14]         ;764  ; strengthFuel
0001ce  7101              STRB     r1,[r0,#4]            ;764
0001d0  1d64              ADDS     r4,r4,#5              ;765
0001d2  1928              ADDS     r0,r5,r4              ;766
0001d4  492b              LDR      r1,|L5.644|
0001d6  f8d11015          LDR      r1,[r1,#0x15]         ;766  ; strengthFuel
0001da  6001              STR      r1,[r0,#0]            ;766
0001dc  1d24              ADDS     r4,r4,#4              ;767
0001de  1928              ADDS     r0,r5,r4              ;768
0001e0  4928              LDR      r1,|L5.644|
0001e2  311a              ADDS     r1,r1,#0x1a           ;768
0001e4  680a              LDR      r2,[r1,#0]            ;768  ; strengthFuel
0001e6  6002              STR      r2,[r0,#0]            ;768
0001e8  6849              LDR      r1,[r1,#4]            ;768  ; strengthFuel
0001ea  6041              STR      r1,[r0,#4]            ;768
0001ec  3408              ADDS     r4,r4,#8              ;769
0001ee  1928              ADDS     r0,r5,r4              ;770
0001f0  4924              LDR      r1,|L5.644|
0001f2  3122              ADDS     r1,r1,#0x22           ;770
0001f4  680a              LDR      r2,[r1,#0]            ;770  ; strengthFuel
0001f6  6002              STR      r2,[r0,#0]            ;770
0001f8  6849              LDR      r1,[r1,#4]            ;770  ; strengthFuel
0001fa  6041              STR      r1,[r0,#4]            ;770
0001fc  3408              ADDS     r4,r4,#8              ;771
0001fe  1928              ADDS     r0,r5,r4              ;772
000200  4920              LDR      r1,|L5.644|
000202  312a              ADDS     r1,r1,#0x2a           ;772
000204  680a              LDR      r2,[r1,#0]            ;772  ; strengthFuel
000206  6002              STR      r2,[r0,#0]            ;772
000208  6849              LDR      r1,[r1,#4]            ;772  ; strengthFuel
00020a  6041              STR      r1,[r0,#4]            ;772
00020c  3408              ADDS     r4,r4,#8              ;773
00020e  1928              ADDS     r0,r5,r4              ;774
000210  491c              LDR      r1,|L5.644|
000212  3132              ADDS     r1,r1,#0x32           ;774
000214  680a              LDR      r2,[r1,#0]            ;774  ; strengthFuel
000216  6002              STR      r2,[r0,#0]            ;774
000218  6849              LDR      r1,[r1,#4]            ;774  ; strengthFuel
00021a  6041              STR      r1,[r0,#4]            ;774
00021c  3408              ADDS     r4,r4,#8              ;775
00021e  4819              LDR      r0,|L5.644|
000220  f890203a          LDRB     r2,[r0,#0x3a]         ;776  ; strengthFuel
000224  4621              MOV      r1,r4                 ;776
000226  1c64              ADDS     r4,r4,#1              ;776
000228  546a              STRB     r2,[r5,r1]            ;776
00022a  1c64              ADDS     r4,r4,#1              ;777
00022c  1928              ADDS     r0,r5,r4              ;778
00022e  4915              LDR      r1,|L5.644|
000230  313b              ADDS     r1,r1,#0x3b           ;778
000232  680a              LDR      r2,[r1,#0]            ;778  ; strengthFuel
000234  6002              STR      r2,[r0,#0]            ;778
000236  6849              LDR      r1,[r1,#4]            ;778  ; strengthFuel
000238  6041              STR      r1,[r0,#4]            ;778
00023a  3408              ADDS     r4,r4,#8              ;779
00023c  1928              ADDS     r0,r5,r4              ;780
00023e  4911              LDR      r1,|L5.644|
000240  3143              ADDS     r1,r1,#0x43           ;780
000242  680a              LDR      r2,[r1,#0]            ;780  ; strengthFuel
000244  6002              STR      r2,[r0,#0]            ;780
000246  6849              LDR      r1,[r1,#4]            ;780  ; strengthFuel
000248  6041              STR      r1,[r0,#4]            ;780
00024a  3408              ADDS     r4,r4,#8              ;781
00024c  1928              ADDS     r0,r5,r4              ;782
00024e  490d              LDR      r1,|L5.644|
000250  314b              ADDS     r1,r1,#0x4b           ;782
000252  680a              LDR      r2,[r1,#0]            ;782  ; strengthFuel
000254  6002              STR      r2,[r0,#0]            ;782
000256  6849              LDR      r1,[r1,#4]            ;782  ; strengthFuel
000258  6041              STR      r1,[r0,#4]            ;782
00025a  2264              MOVS     r2,#0x64              ;784
00025c  490b              LDR      r1,|L5.652|
00025e  4628              MOV      r0,r5                 ;784
000260  f7fffffe          BL       Save2KDataToFlash
000264  21c8              MOVS     r1,#0xc8              ;800
000266  480a              LDR      r0,|L5.656|
000268  f7fffffe          BL       __aeabi_memclr
00026c  4809              LDR      r0,|L5.660|
00026e  f7fffffe          BL       SoftErasePage
000272  22c8              MOVS     r2,#0xc8              ;802
000274  4907              LDR      r1,|L5.660|
000276  4806              LDR      r0,|L5.656|
000278  f7fffffe          BL       Save2KDataToFlash
00027c  b671              CPSID    f                     ;804
00027e  f7fffffe          BL       __NVIC_SystemReset
;;;807    
                          ENDP

000282  0000              DCW      0x0000
                  |L5.644|
                          DCD      strengthFuel
                  |L5.648|
                          DCD      strengthFuelFlash
                  |L5.652|
                          DCD      0x08065000
                  |L5.656|
                          DCD      strengPower
                  |L5.660|
                          DCD      0x08060000

                          AREA ||i.GetConfigInfo||, CODE, READONLY, ALIGN=2

                  GetConfigInfo PROC
;;;100    }
;;;101    static void GetConfigInfo(void)
000000  b510              PUSH     {r4,lr}
;;;102    {
;;;103    	_CDMADataToSend* otaUpdatSend;
;;;104    	otaUpdatSend = CDMNSendInfoInit(60);//升级请求帧
000002  203c              MOVS     r0,#0x3c
000004  f7fffffe          BL       CDMNSendInfoInit
000008  4604              MOV      r4,r0
;;;105    
;;;106    	otaUpdatSend->data[otaUpdatSend->datLength++] = 11;  //长度
00000a  210b              MOVS     r1,#0xb
00000c  8822              LDRH     r2,[r4,#0]
00000e  1c50              ADDS     r0,r2,#1
000010  8020              STRH     r0,[r4,#0]
000012  6860              LDR      r0,[r4,#4]
000014  5481              STRB     r1,[r0,r2]
;;;107    	otaUpdatSend->data[otaUpdatSend->datLength++] = 0x40;    
000016  2140              MOVS     r1,#0x40
000018  8822              LDRH     r2,[r4,#0]
00001a  1c50              ADDS     r0,r2,#1
00001c  8020              STRH     r0,[r4,#0]
00001e  6860              LDR      r0,[r4,#4]
000020  5481              STRB     r1,[r0,r2]
;;;108    	otaUpdatSend->data[otaUpdatSend->datLength++] = 0x00;
000022  2100              MOVS     r1,#0
000024  8822              LDRH     r2,[r4,#0]
000026  1c50              ADDS     r0,r2,#1
000028  8020              STRH     r0,[r4,#0]
00002a  6860              LDR      r0,[r4,#4]
00002c  5481              STRB     r1,[r0,r2]
;;;109    	//当前版本
;;;110    	otaUpdatSend->data[otaUpdatSend->datLength++] = (varOperation.pidVersion >> 24) & 0x00FF; 
00002e  4829              LDR      r0,|L6.212|
000030  f8d0007a          LDR      r0,[r0,#0x7a]  ; varOperation
000034  0e00              LSRS     r0,r0,#24
000036  8822              LDRH     r2,[r4,#0]
000038  1c51              ADDS     r1,r2,#1
00003a  8021              STRH     r1,[r4,#0]
00003c  6861              LDR      r1,[r4,#4]
00003e  5488              STRB     r0,[r1,r2]
;;;111    	otaUpdatSend->data[otaUpdatSend->datLength++] = (varOperation.pidVersion >> 16) & 0x00FF; 
000040  4824              LDR      r0,|L6.212|
000042  f8d0007a          LDR      r0,[r0,#0x7a]  ; varOperation
000046  f3c04107          UBFX     r1,r0,#16,#8
00004a  8822              LDRH     r2,[r4,#0]
00004c  1c50              ADDS     r0,r2,#1
00004e  8020              STRH     r0,[r4,#0]
000050  6860              LDR      r0,[r4,#4]
000052  5481              STRB     r1,[r0,r2]
;;;112    	otaUpdatSend->data[otaUpdatSend->datLength++] = (varOperation.pidVersion >> 8) & 0x00FF;   
000054  481f              LDR      r0,|L6.212|
000056  f8b0007a          LDRH     r0,[r0,#0x7a]  ; varOperation
00005a  f3c02107          UBFX     r1,r0,#8,#8
00005e  8822              LDRH     r2,[r4,#0]
000060  1c50              ADDS     r0,r2,#1
000062  8020              STRH     r0,[r4,#0]
000064  6860              LDR      r0,[r4,#4]
000066  5481              STRB     r1,[r0,r2]
;;;113    	otaUpdatSend->data[otaUpdatSend->datLength++] = varOperation.pidVersion & 0x00FF;
000068  481a              LDR      r0,|L6.212|
00006a  f890107a          LDRB     r1,[r0,#0x7a]  ; varOperation
00006e  8822              LDRH     r2,[r4,#0]
000070  1c50              ADDS     r0,r2,#1
000072  8020              STRH     r0,[r4,#0]
000074  6860              LDR      r0,[r4,#4]
000076  5481              STRB     r1,[r0,r2]
;;;114    	
;;;115    	//请求升级的版本
;;;116    	otaUpdatSend->data[otaUpdatSend->datLength++] = (varOperation.newPIDVersion >> 24) & 0x00FF;
000078  4816              LDR      r0,|L6.212|
00007a  f8d0007e          LDR      r0,[r0,#0x7e]  ; varOperation
00007e  0e00              LSRS     r0,r0,#24
000080  8822              LDRH     r2,[r4,#0]
000082  1c51              ADDS     r1,r2,#1
000084  8021              STRH     r1,[r4,#0]
000086  6861              LDR      r1,[r4,#4]
000088  5488              STRB     r0,[r1,r2]
;;;117    	otaUpdatSend->data[otaUpdatSend->datLength++] = (varOperation.newPIDVersion >> 16) & 0x00FF;
00008a  4812              LDR      r0,|L6.212|
00008c  f8d0007e          LDR      r0,[r0,#0x7e]  ; varOperation
000090  f3c04107          UBFX     r1,r0,#16,#8
000094  8822              LDRH     r2,[r4,#0]
000096  1c50              ADDS     r0,r2,#1
000098  8020              STRH     r0,[r4,#0]
00009a  6860              LDR      r0,[r4,#4]
00009c  5481              STRB     r1,[r0,r2]
;;;118    	otaUpdatSend->data[otaUpdatSend->datLength++] = (varOperation.newPIDVersion >> 8) & 0x00FF;
00009e  480d              LDR      r0,|L6.212|
0000a0  f8b0007e          LDRH     r0,[r0,#0x7e]  ; varOperation
0000a4  f3c02107          UBFX     r1,r0,#8,#8
0000a8  8822              LDRH     r2,[r4,#0]
0000aa  1c50              ADDS     r0,r2,#1
0000ac  8020              STRH     r0,[r4,#0]
0000ae  6860              LDR      r0,[r4,#4]
0000b0  5481              STRB     r1,[r0,r2]
;;;119    	otaUpdatSend->data[otaUpdatSend->datLength++] = varOperation.newPIDVersion & 0x00FF;
0000b2  4808              LDR      r0,|L6.212|
0000b4  f890107e          LDRB     r1,[r0,#0x7e]  ; varOperation
0000b8  8822              LDRH     r2,[r4,#0]
0000ba  1c50              ADDS     r0,r2,#1
0000bc  8020              STRH     r0,[r4,#0]
0000be  6860              LDR      r0,[r4,#4]
0000c0  5481              STRB     r1,[r0,r2]
;;;120    	
;;;121    	CDMASendDataPack(otaUpdatSend);             //将请求包进行封包
0000c2  4620              MOV      r0,r4
0000c4  f7fffffe          BL       CDMASendDataPack
;;;122    	
;;;123    	OSQPost(CDMASendQ,otaUpdatSend);
0000c8  4621              MOV      r1,r4
0000ca  4803              LDR      r0,|L6.216|
0000cc  6800              LDR      r0,[r0,#0]  ; CDMASendQ
0000ce  f7fffffe          BL       OSQPost
;;;124    }
0000d2  bd10              POP      {r4,pc}
;;;125    
                          ENDP

                  |L6.212|
                          DCD      varOperation
                  |L6.216|
                          DCD      CDMASendQ

                          AREA ||i.LoginDataSend||, CODE, READONLY, ALIGN=2

                  LoginDataSend PROC
;;;70     //登录报文
;;;71     void LoginDataSend(void)
000000  b570              PUSH     {r4-r6,lr}
;;;72     {
;;;73     	uint8_t err;
;;;74     	uint32_t buff;
;;;75     	_CDMADataToSend* loginData = CDMNSendInfoInit(100);    //发送登录报文
000002  2064              MOVS     r0,#0x64
000004  f7fffffe          BL       CDMNSendInfoInit
000008  4604              MOV      r4,r0
;;;76     	
;;;77     	loginData->data[loginData->datLength++] = 31;
00000a  211f              MOVS     r1,#0x1f
00000c  8822              LDRH     r2,[r4,#0]
00000e  1c50              ADDS     r0,r2,#1
000010  8020              STRH     r0,[r4,#0]
000012  6860              LDR      r0,[r4,#4]
000014  5481              STRB     r1,[r0,r2]
;;;78     	loginData->data[loginData->datLength++] = 0x50;
000016  2150              MOVS     r1,#0x50
000018  8822              LDRH     r2,[r4,#0]
00001a  1c50              ADDS     r0,r2,#1
00001c  8020              STRH     r0,[r4,#0]
00001e  6860              LDR      r0,[r4,#4]
000020  5481              STRB     r1,[r0,r2]
;;;79     	loginData->data[loginData->datLength++] = 0x01;
000022  2101              MOVS     r1,#1
000024  8822              LDRH     r2,[r4,#0]
000026  1c50              ADDS     r0,r2,#1
000028  8020              STRH     r0,[r4,#0]
00002a  6860              LDR      r0,[r4,#4]
00002c  5481              STRB     r1,[r0,r2]
;;;80     	
;;;81     	buff = sysUpdateVar.curSoftVer; 
00002e  481b              LDR      r0,|L7.156|
000030  8845              LDRH     r5,[r0,#2]  ; sysUpdateVar
;;;82     	buff =t_htonl(buff);			                       //软件固件版本  
000032  4628              MOV      r0,r5
000034  f7fffffe          BL       t_htonl
000038  4605              MOV      r5,r0
;;;83     	memcpy(&loginData->data[loginData->datLength],&buff,4);
00003a  6860              LDR      r0,[r4,#4]
00003c  8821              LDRH     r1,[r4,#0]
00003e  4408              ADD      r0,r0,r1
000040  6005              STR      r5,[r0,#0]
;;;84     	loginData->datLength += 4;
000042  8820              LDRH     r0,[r4,#0]
000044  1d00              ADDS     r0,r0,#4
000046  8020              STRH     r0,[r4,#0]
;;;85     	
;;;86     	buff = t_htonl(canDataConfig.pidVersion);
000048  4915              LDR      r1,|L7.160|
00004a  6808              LDR      r0,[r1,#0]  ; canDataConfig
00004c  f7fffffe          BL       t_htonl
000050  4605              MOV      r5,r0
;;;87     	memcpy(&loginData->data[loginData->datLength],&buff,4);
000052  6860              LDR      r0,[r4,#4]
000054  8821              LDRH     r1,[r4,#0]
000056  4408              ADD      r0,r0,r1
000058  6005              STR      r5,[r0,#0]
;;;88     	loginData->datLength += 4;
00005a  8820              LDRH     r0,[r4,#0]
00005c  1d00              ADDS     r0,r0,#4
00005e  8020              STRH     r0,[r4,#0]
;;;89     	
;;;90     	memcpy(&loginData->data[loginData->datLength],varOperation.iccID,20);
000060  6861              LDR      r1,[r4,#4]
000062  8822              LDRH     r2,[r4,#0]
000064  1888              ADDS     r0,r1,r2
000066  2214              MOVS     r2,#0x14
000068  490e              LDR      r1,|L7.164|
00006a  f7fffffe          BL       __aeabi_memcpy
;;;91     	loginData->datLength += 20;
00006e  8820              LDRH     r0,[r4,#0]
000070  3014              ADDS     r0,r0,#0x14
000072  8020              STRH     r0,[r4,#0]
;;;92     	
;;;93     	CDMASendDataPack(loginData);     //对登录报文进行打包（添加帧头、校验码、帧尾）
000074  4620              MOV      r0,r4
000076  f7fffffe          BL       CDMASendDataPack
;;;94     	err = OSQPost(CDMASendQ,loginData);
00007a  4621              MOV      r1,r4
00007c  480a              LDR      r0,|L7.168|
00007e  6800              LDR      r0,[r0,#0]  ; CDMASendQ
000080  f7fffffe          BL       OSQPost
000084  4606              MOV      r6,r0
;;;95     	if(err != OS_ERR_NONE)
000086  b116              CBZ      r6,|L7.142|
;;;96     	{
;;;97     		Mem_free(loginData);
000088  4620              MOV      r0,r4
00008a  f7fffffe          BL       Mem_free
                  |L7.142|
;;;98     	}
;;;99     	varOperation.isLoginDeal = 0;     //正在处理登录报文
00008e  2000              MOVS     r0,#0
000090  4904              LDR      r1,|L7.164|
000092  3919              SUBS     r1,r1,#0x19
000094  f8810030          STRB     r0,[r1,#0x30]
;;;100    }
000098  bd70              POP      {r4-r6,pc}
;;;101    static void GetConfigInfo(void)
                          ENDP

00009a  0000              DCW      0x0000
                  |L7.156|
                          DCD      sysUpdateVar
                  |L7.160|
                          DCD      canDataConfig
                  |L7.164|
                          DCD      varOperation+0x19
                  |L7.168|
                          DCD      CDMASendQ

                          AREA ||i.OTA_Updata||, CODE, READONLY, ALIGN=2

                  OTA_Updata PROC
;;;218    uint8_t updateBuff[2048];       //升级用
;;;219    static void OTA_Updata(uint8_t* ptrDeal)
000000  e92d47f0          PUSH     {r4-r10,lr}
;;;220    {
000004  4604              MOV      r4,r0
;;;221    	uint16_t cmdId;
;;;222    	uint16_t datLength = 0;
000006  f04f0800          MOV      r8,#0
;;;223    	uint16_t i = 0;
00000a  46c1              MOV      r9,r8
;;;224    	uint8_t  frameNum;           //此次一共接收到128字节的包数
;;;225    	uint8_t  frameLen;           //每一帧的每一小包到底有多少个字节
;;;226    	uint16_t offset;
;;;227    	
;;;228    	static uint16_t currentNum = 0;      //发送下一个请求包
;;;229    	static uint16_t fileCRC    = 0;      //文件CRC校验
;;;230    	static uint32_t flashAddr  = 0;      //地址信息，写2K便自增0x800,向Flash一次写2K字节
;;;231    	static uint8_t  frameIndex = 0;      //要保存的帧索引
;;;232    	
;;;233    	
;;;234    	datLength = ptrDeal[0];
00000c  f8948000          LDRB     r8,[r4,#0]
;;;235    	datLength = (datLength << 8) + ptrDeal[1];
000010  7860              LDRB     r0,[r4,#1]
000012  eb002008          ADD      r0,r0,r8,LSL #8
000016  fa1ff880          UXTH     r8,r0
;;;236    	
;;;237    	cmdId     = ptrDeal[3];
00001a  78e6              LDRB     r6,[r4,#3]
;;;238    	cmdId     = (cmdId << 8) + ptrDeal[4];
00001c  7920              LDRB     r0,[r4,#4]
00001e  eb002006          ADD      r0,r0,r6,LSL #8
000022  b286              UXTH     r6,r0
;;;239    	if(cmdId == 0x8000)
000024  f5b64f00          CMP      r6,#0x8000
000028  d132              BNE      |L8.144|
;;;240    	{
;;;241    		offset = 5;
00002a  2505              MOVS     r5,#5
;;;242    		varOperation.frameNum = ptrDeal[offset++] + 0x80;//得到新程序的128字节的包数
00002c  4629              MOV      r1,r5
00002e  1c6d              ADDS     r5,r5,#1
000030  5c60              LDRB     r0,[r4,r1]
000032  3080              ADDS     r0,r0,#0x80
000034  4981              LDR      r1,|L8.572|
000036  80c8              STRH     r0,[r1,#6]
;;;243    		varOperation.frameNum = (varOperation.frameNum << 8) + ptrDeal[offset++];
000038  4629              MOV      r1,r5
00003a  1c6d              ADDS     r5,r5,#1
00003c  5c60              LDRB     r0,[r4,r1]
00003e  497f              LDR      r1,|L8.572|
000040  7989              LDRB     r1,[r1,#6]  ; varOperation
000042  eb002001          ADD      r0,r0,r1,LSL #8
000046  497d              LDR      r1,|L8.572|
000048  80c8              STRH     r0,[r1,#6]
;;;244    		varOperation.newSoftCRC = ptrDeal[offset++];//得到文件校验码
00004a  4629              MOV      r1,r5
00004c  1c6d              ADDS     r5,r5,#1
00004e  5c60              LDRB     r0,[r4,r1]
000050  497a              LDR      r1,|L8.572|
000052  8088              STRH     r0,[r1,#4]
;;;245    		varOperation.newSoftCRC = (varOperation.newSoftCRC << 8) + ptrDeal[offset++];
000054  4629              MOV      r1,r5
000056  1c6d              ADDS     r5,r5,#1
000058  5c60              LDRB     r0,[r4,r1]
00005a  4978              LDR      r1,|L8.572|
00005c  7909              LDRB     r1,[r1,#4]  ; varOperation
00005e  eb002001          ADD      r0,r0,r1,LSL #8
000062  4976              LDR      r1,|L8.572|
000064  8088              STRH     r0,[r1,#4]
;;;246    		
;;;247    		currentNum = 0x8001;
000066  f2480001          MOV      r0,#0x8001
00006a  4975              LDR      r1,|L8.576|
00006c  8008              STRH     r0,[r1,#0]
;;;248    		fileCRC    = 0;
00006e  2000              MOVS     r0,#0
000070  4974              LDR      r1,|L8.580|
000072  8008              STRH     r0,[r1,#0]
;;;249    		flashAddr  = 0;
000074  4974              LDR      r1,|L8.584|
000076  6008              STR      r0,[r1,#0]  ; flashAddr
;;;250    		frameIndex = 0;
000078  4974              LDR      r1,|L8.588|
00007a  7008              STRB     r0,[r1,#0]
;;;251    		SendFrameNum(currentNum);//发送第一包程序请求帧0x8001
00007c  4870              LDR      r0,|L8.576|
00007e  8800              LDRH     r0,[r0,#0]  ; currentNum
000080  f7fffffe          BL       SendFrameNum
;;;252    		memset(updateBuff,0,2048);
000084  f44f6100          MOV      r1,#0x800
000088  4871              LDR      r0,|L8.592|
00008a  f7fffffe          BL       __aeabi_memclr
                  |L8.142|
00008e  e0d2              B        |L8.566|
                  |L8.144|
;;;253    	}
;;;254    	else if(cmdId>0x8000)        //程序代码
000090  f5b64f00          CMP      r6,#0x8000
000094  ddfb              BLE      |L8.142|
;;;255    	{
;;;256    		if(cmdId != currentNum)  //接收到的帧序号，与所申请的帧序号不同，则放弃数据并重新申请
000096  486a              LDR      r0,|L8.576|
000098  8800              LDRH     r0,[r0,#0]  ; currentNum
00009a  4286              CMP      r6,r0
00009c  d001              BEQ      |L8.162|
                  |L8.158|
;;;257    		{
;;;258    //			SendFrameNum(currentNum);//todo：重新接收数据？
;;;259    			return;
;;;260    		}
;;;261    			
;;;262    		frameNum = (datLength%131) == 0? (datLength/131) : (datLength/131) + 1;//得到此帧数据一共有多少包128字节的程序代码
;;;263    		
;;;264    		offset = 2;
;;;265    		for(i=0;i<frameNum;i++)                //
;;;266    		{
;;;267    			frameLen = ptrDeal[offset++] - 3;  //实际的小包程序的字节数
;;;268    			cmdId    = ptrDeal[offset++];
;;;269    			cmdId    = (cmdId << 8) + ptrDeal[offset++]; 
;;;270    			memcpy(&updateBuff[frameIndex*128],&ptrDeal[offset],frameLen);
;;;271    			offset += 128;
;;;272    			frameIndex ++;
;;;273    			if((frameIndex >= 16) && (cmdId != varOperation.frameNum))
;;;274    			{
;;;275    				frameIndex = 0;
;;;276    				SoftErasePage(flashAddr);
;;;277    				SoftProgramUpdate(flashAddr,updateBuff,2048);
;;;278    				//计算CRC校验
;;;279    				fileCRC = CRC_ComputeFile(fileCRC,updateBuff,2048);
;;;280    				memset(updateBuff,0,2048);//清空数据区
;;;281    				flashAddr += 0x800;
;;;282    			}
;;;283    			else if(cmdId == varOperation.frameNum)
;;;284    			{
;;;285    				SoftErasePage(flashAddr);
;;;286    				SoftProgramUpdate(flashAddr,updateBuff,((frameIndex - 1)*128 + frameLen));
;;;287    				//计算CRC校验
;;;288    				fileCRC = CRC_ComputeFile(fileCRC,updateBuff,((frameIndex - 1)*128 + frameLen));
;;;289    				memset(updateBuff,0,2048);
;;;290    				flashAddr += ((frameIndex - 1)*128 + frameLen);
;;;291    			}
;;;292    		}
;;;293    		if(cmdId == varOperation.frameNum)
;;;294    		{
;;;295    			if(fileCRC != varOperation.newSoftCRC)//CRC校验错误，程序升级失败
;;;296    			{
;;;297    				Mem_free(ptrDeal);
;;;298    				varOperation.isDataFlow     = 0;
;;;299    //				SendFrameNum(0x8000);      //todo:重新升级？
;;;300    				return;	
;;;301    			}
;;;302    			Mem_free(ptrDeal);
;;;303    			sysUpdateVar.isSoftUpdate = 1;      //告诉Sboot,程序需要升级
;;;304    			sysUpdateVar.pageNum      = flashAddr / 0x800 + 1;
;;;305    			sysUpdateVar.softByteSize = flashAddr;
;;;306    			sysUpdateVar.newSoftCRC   = fileCRC;
;;;307    			sysUpdateVar.newSoftVer   = varOperation.newSoftVersion;
;;;308    			
;;;309    			SbootParameterSaveToFlash(&sysUpdateVar);//将升级参数保存到Flash中
;;;310    			
;;;311    			__disable_fault_irq();          //重启
;;;312    			NVIC_SystemReset();
;;;313    		}
;;;314    		currentNum = cmdId + 1;
;;;315    		SendFrameNum(currentNum);//请求下一帧数据；
;;;316    	}
;;;317    }
00009e  e8bd87f0          POP      {r4-r10,pc}
                  |L8.162|
0000a2  2083              MOVS     r0,#0x83              ;262
0000a4  fb98f1f0          SDIV     r1,r8,r0              ;262
0000a8  fb008011          MLS      r0,r0,r1,r8           ;262
0000ac  b918              CBNZ     r0,|L8.182|
0000ae  2083              MOVS     r0,#0x83              ;262
0000b0  fb98f0f0          SDIV     r0,r8,r0              ;262
0000b4  e003              B        |L8.190|
                  |L8.182|
0000b6  2083              MOVS     r0,#0x83              ;262
0000b8  fb98f0f0          SDIV     r0,r8,r0              ;262
0000bc  1c40              ADDS     r0,r0,#1              ;262
                  |L8.190|
0000be  f0000aff          AND      r10,r0,#0xff          ;262
0000c2  2502              MOVS     r5,#2                 ;264
0000c4  f04f0900          MOV      r9,#0                 ;265
0000c8  e07d              B        |L8.454|
                  |L8.202|
0000ca  4628              MOV      r0,r5                 ;267
0000cc  1c69              ADDS     r1,r5,#1              ;267
0000ce  b28d              UXTH     r5,r1                 ;267
0000d0  5c20              LDRB     r0,[r4,r0]            ;267
0000d2  1ec0              SUBS     r0,r0,#3              ;267
0000d4  b2c7              UXTB     r7,r0                 ;267
0000d6  4628              MOV      r0,r5                 ;268
0000d8  1c69              ADDS     r1,r5,#1              ;268
0000da  b28d              UXTH     r5,r1                 ;268
0000dc  5c26              LDRB     r6,[r4,r0]            ;268
0000de  4628              MOV      r0,r5                 ;269
0000e0  1c69              ADDS     r1,r5,#1              ;269
0000e2  b28d              UXTH     r5,r1                 ;269
0000e4  5c20              LDRB     r0,[r4,r0]            ;269
0000e6  eb002006          ADD      r0,r0,r6,LSL #8       ;269
0000ea  b286              UXTH     r6,r0                 ;269
0000ec  1961              ADDS     r1,r4,r5              ;270
0000ee  4a57              LDR      r2,|L8.588|
0000f0  7812              LDRB     r2,[r2,#0]            ;270  ; frameIndex
0000f2  4b57              LDR      r3,|L8.592|
0000f4  eb0310c2          ADD      r0,r3,r2,LSL #7       ;270
0000f8  463a              MOV      r2,r7                 ;270
0000fa  f7fffffe          BL       __aeabi_memcpy
0000fe  f1050080          ADD      r0,r5,#0x80           ;271
000102  b285              UXTH     r5,r0                 ;271
000104  4851              LDR      r0,|L8.588|
000106  7800              LDRB     r0,[r0,#0]            ;272  ; frameIndex
000108  1c40              ADDS     r0,r0,#1              ;272
00010a  4950              LDR      r1,|L8.588|
00010c  7008              STRB     r0,[r1,#0]            ;272
00010e  4608              MOV      r0,r1                 ;273
000110  7800              LDRB     r0,[r0,#0]            ;273  ; frameIndex
000112  2810              CMP      r0,#0x10              ;273
000114  db25              BLT      |L8.354|
000116  4849              LDR      r0,|L8.572|
000118  88c0              LDRH     r0,[r0,#6]            ;273  ; varOperation
00011a  42b0              CMP      r0,r6                 ;273
00011c  d021              BEQ      |L8.354|
00011e  2000              MOVS     r0,#0                 ;275
000120  7008              STRB     r0,[r1,#0]            ;275
000122  4849              LDR      r0,|L8.584|
000124  6800              LDR      r0,[r0,#0]            ;276  ; flashAddr
000126  f7fffffe          BL       SoftErasePage
00012a  f44f6200          MOV      r2,#0x800             ;277
00012e  4948              LDR      r1,|L8.592|
000130  4845              LDR      r0,|L8.584|
000132  6800              LDR      r0,[r0,#0]            ;277  ; flashAddr
000134  f7fffffe          BL       SoftProgramUpdate
000138  f44f6200          MOV      r2,#0x800             ;279
00013c  4944              LDR      r1,|L8.592|
00013e  4841              LDR      r0,|L8.580|
000140  8800              LDRH     r0,[r0,#0]            ;279  ; fileCRC
000142  f7fffffe          BL       CRC_ComputeFile
000146  493f              LDR      r1,|L8.580|
000148  8008              STRH     r0,[r1,#0]            ;279
00014a  f44f6100          MOV      r1,#0x800             ;280
00014e  4840              LDR      r0,|L8.592|
000150  f7fffffe          BL       __aeabi_memclr
000154  483c              LDR      r0,|L8.584|
000156  6800              LDR      r0,[r0,#0]            ;281  ; flashAddr
000158  f5006000          ADD      r0,r0,#0x800          ;281
00015c  493a              LDR      r1,|L8.584|
00015e  6008              STR      r0,[r1,#0]            ;281  ; flashAddr
000160  e02d              B        |L8.446|
                  |L8.354|
000162  4836              LDR      r0,|L8.572|
000164  88c0              LDRH     r0,[r0,#6]            ;283  ; varOperation
000166  42b0              CMP      r0,r6                 ;283
000168  d129              BNE      |L8.446|
00016a  4837              LDR      r0,|L8.584|
00016c  6800              LDR      r0,[r0,#0]            ;285  ; flashAddr
00016e  f7fffffe          BL       SoftErasePage
000172  4836              LDR      r0,|L8.588|
000174  7800              LDRB     r0,[r0,#0]            ;286  ; frameIndex
000176  1e40              SUBS     r0,r0,#1              ;286
000178  eb0710c0          ADD      r0,r7,r0,LSL #7       ;286
00017c  b282              UXTH     r2,r0                 ;286
00017e  4934              LDR      r1,|L8.592|
000180  4831              LDR      r0,|L8.584|
000182  6800              LDR      r0,[r0,#0]            ;286  ; flashAddr
000184  f7fffffe          BL       SoftProgramUpdate
000188  4830              LDR      r0,|L8.588|
00018a  7800              LDRB     r0,[r0,#0]            ;288  ; frameIndex
00018c  1e40              SUBS     r0,r0,#1              ;288
00018e  eb0712c0          ADD      r2,r7,r0,LSL #7       ;288
000192  492f              LDR      r1,|L8.592|
000194  482b              LDR      r0,|L8.580|
000196  8800              LDRH     r0,[r0,#0]            ;288  ; fileCRC
000198  f7fffffe          BL       CRC_ComputeFile
00019c  4929              LDR      r1,|L8.580|
00019e  8008              STRH     r0,[r1,#0]            ;288
0001a0  f44f6100          MOV      r1,#0x800             ;289
0001a4  482a              LDR      r0,|L8.592|
0001a6  f7fffffe          BL       __aeabi_memclr
0001aa  4828              LDR      r0,|L8.588|
0001ac  7800              LDRB     r0,[r0,#0]            ;290  ; frameIndex
0001ae  1e40              SUBS     r0,r0,#1              ;290
0001b0  eb0710c0          ADD      r0,r7,r0,LSL #7       ;290
0001b4  4924              LDR      r1,|L8.584|
0001b6  6809              LDR      r1,[r1,#0]            ;290  ; flashAddr
0001b8  4408              ADD      r0,r0,r1              ;290
0001ba  4923              LDR      r1,|L8.584|
0001bc  6008              STR      r0,[r1,#0]            ;290  ; flashAddr
                  |L8.446|
0001be  f1090001          ADD      r0,r9,#1              ;265
0001c2  fa1ff980          UXTH     r9,r0                 ;265
                  |L8.454|
0001c6  45d1              CMP      r9,r10                ;265
0001c8  f6ffaf7f          BLT      |L8.202|
0001cc  481b              LDR      r0,|L8.572|
0001ce  88c0              LDRH     r0,[r0,#6]            ;293  ; varOperation
0001d0  42b0              CMP      r0,r6                 ;293
0001d2  d129              BNE      |L8.552|
0001d4  4819              LDR      r0,|L8.572|
0001d6  8880              LDRH     r0,[r0,#4]            ;295  ; varOperation
0001d8  491a              LDR      r1,|L8.580|
0001da  8809              LDRH     r1,[r1,#0]            ;295  ; fileCRC
0001dc  4288              CMP      r0,r1                 ;295
0001de  d007              BEQ      |L8.496|
0001e0  4620              MOV      r0,r4                 ;297
0001e2  f7fffffe          BL       Mem_free
0001e6  2000              MOVS     r0,#0                 ;298
0001e8  4914              LDR      r1,|L8.572|
0001ea  f881002d          STRB     r0,[r1,#0x2d]         ;298
0001ee  e756              B        |L8.158|
                  |L8.496|
0001f0  4620              MOV      r0,r4                 ;302
0001f2  f7fffffe          BL       Mem_free
0001f6  2001              MOVS     r0,#1                 ;303
0001f8  4916              LDR      r1,|L8.596|
0001fa  7008              STRB     r0,[r1,#0]            ;303
0001fc  4812              LDR      r0,|L8.584|
0001fe  6800              LDR      r0,[r0,#0]            ;304  ; flashAddr
000200  2101              MOVS     r1,#1                 ;304
000202  eb0120d0          ADD      r0,r1,r0,LSR #11      ;304
000206  4913              LDR      r1,|L8.596|
000208  80c8              STRH     r0,[r1,#6]            ;304
00020a  480f              LDR      r0,|L8.584|
00020c  6800              LDR      r0,[r0,#0]            ;305  ; flashAddr
00020e  60c8              STR      r0,[r1,#0xc]          ;305  ; sysUpdateVar
000210  480c              LDR      r0,|L8.580|
000212  8800              LDRH     r0,[r0,#0]            ;306  ; fileCRC
000214  8108              STRH     r0,[r1,#8]            ;306
000216  4809              LDR      r0,|L8.572|
000218  8800              LDRH     r0,[r0,#0]            ;307  ; varOperation
00021a  8088              STRH     r0,[r1,#4]            ;307
00021c  4608              MOV      r0,r1                 ;309
00021e  f7fffffe          BL       SbootParameterSaveToFlash
000222  b671              CPSID    f                     ;311
000224  f7fffffe          BL       __NVIC_SystemReset
                  |L8.552|
000228  1c70              ADDS     r0,r6,#1              ;314
00022a  4905              LDR      r1,|L8.576|
00022c  8008              STRH     r0,[r1,#0]            ;314
00022e  4608              MOV      r0,r1                 ;315
000230  8800              LDRH     r0,[r0,#0]            ;315  ; currentNum
000232  f7fffffe          BL       SendFrameNum
                  |L8.566|
000236  bf00              NOP      
000238  e731              B        |L8.158|
;;;318    static void SendConfigNum(uint16_t cmd)
                          ENDP

00023a  0000              DCW      0x0000
                  |L8.572|
                          DCD      varOperation
                  |L8.576|
                          DCD      currentNum
                  |L8.580|
                          DCD      fileCRC
                  |L8.584|
                          DCD      flashAddr
                  |L8.588|
                          DCD      frameIndex
                  |L8.592|
                          DCD      updateBuff
                  |L8.596|
                          DCD      sysUpdateVar

                          AREA ||i.RecvLoginDatDeal||, CODE, READONLY, ALIGN=2

                  RecvLoginDatDeal PROC
;;;125    
;;;126    static void RecvLoginDatDeal(uint8_t* ptr)      //对服务器回复的登录报文进行解析
000000  e92d43f8          PUSH     {r3-r9,lr}
;;;127    {
000004  4604              MOV      r4,r0
;;;128    	uint16_t cmdId = 0;
000006  f04f0900          MOV      r9,#0
;;;129    	uint8_t  ipLen = 0;
00000a  2000              MOVS     r0,#0
00000c  9000              STR      r0,[sp,#0]
;;;130    	uint32_t ecuId = 0;
00000e  2600              MOVS     r6,#0
;;;131    	uint32_t serverTime  = 0;
000010  2700              MOVS     r7,#0
;;;132    	uint32_t softVersion = 0;
000012  4680              MOV      r8,r0
;;;133    	uint16_t offset = 3;
000014  2503              MOVS     r5,#3
;;;134    	static uint8_t timetemp = 0;
;;;135    	cmdId = ptr[offset++];
000016  4629              MOV      r1,r5
000018  1c6d              ADDS     r5,r5,#1
00001a  f8149001          LDRB     r9,[r4,r1]
;;;136    	cmdId = (cmdId<<8) + ptr[offset++];
00001e  4629              MOV      r1,r5
000020  1c6d              ADDS     r5,r5,#1
000022  5c60              LDRB     r0,[r4,r1]
000024  eb002009          ADD      r0,r0,r9,LSL #8
000028  fa1ff980          UXTH     r9,r0
;;;137    
;;;138    	serverTime = ptr[offset++];                //得到服务器时间
00002c  4629              MOV      r1,r5
00002e  1c6d              ADDS     r5,r5,#1
000030  5c67              LDRB     r7,[r4,r1]
;;;139    	serverTime = (serverTime << 8) + ptr[offset++];
000032  4629              MOV      r1,r5
000034  1c6d              ADDS     r5,r5,#1
000036  5c60              LDRB     r0,[r4,r1]
000038  eb002707          ADD      r7,r0,r7,LSL #8
;;;140    	serverTime = (serverTime << 8) + ptr[offset++];
00003c  4629              MOV      r1,r5
00003e  1c6d              ADDS     r5,r5,#1
000040  5c60              LDRB     r0,[r4,r1]
000042  eb002707          ADD      r7,r0,r7,LSL #8
;;;141    	serverTime = (serverTime << 8) + ptr[offset++];
000046  4629              MOV      r1,r5
000048  1c6d              ADDS     r5,r5,#1
00004a  5c60              LDRB     r0,[r4,r1]
00004c  eb002707          ADD      r7,r0,r7,LSL #8
;;;142    	
;;;143    	if(timetemp == 0)
000050  4856              LDR      r0,|L9.428|
000052  7800              LDRB     r0,[r0,#0]  ; timetemp
000054  b920              CBNZ     r0,|L9.96|
;;;144    	{
;;;145    		carAllRecord.startTime = serverTime;   //行程起始时间
000056  4856              LDR      r0,|L9.432|
000058  6007              STR      r7,[r0,#0]  ; carAllRecord
;;;146    		timetemp = 1;
00005a  2001              MOVS     r0,#1
00005c  4953              LDR      r1,|L9.428|
00005e  7008              STRB     r0,[r1,#0]
                  |L9.96|
;;;147    	}
;;;148    	
;;;149    	RTC_Time_Adjust(serverTime);   //登录的时候，跟服务器时间进行校时。
000060  4638              MOV      r0,r7
000062  f7fffffe          BL       RTC_Time_Adjust
;;;150    	
;;;151    	softVersion = ptr[offset++];   //得到软件版本号
000066  4628              MOV      r0,r5
000068  1c69              ADDS     r1,r5,#1
00006a  b28d              UXTH     r5,r1
00006c  f8148000          LDRB     r8,[r4,r0]
;;;152    	softVersion = (softVersion << 8) + ptr[offset++];
000070  4628              MOV      r0,r5
000072  1c69              ADDS     r1,r5,#1
000074  b28d              UXTH     r5,r1
000076  5c20              LDRB     r0,[r4,r0]
000078  eb002808          ADD      r8,r0,r8,LSL #8
;;;153    	softVersion = (softVersion << 8) + ptr[offset++];
00007c  4628              MOV      r0,r5
00007e  1c69              ADDS     r1,r5,#1
000080  b28d              UXTH     r5,r1
000082  5c20              LDRB     r0,[r4,r0]
000084  eb002808          ADD      r8,r0,r8,LSL #8
;;;154    	softVersion = (softVersion << 8) + ptr[offset++];
000088  4628              MOV      r0,r5
00008a  1c69              ADDS     r1,r5,#1
00008c  b28d              UXTH     r5,r1
00008e  5c20              LDRB     r0,[r4,r0]
000090  eb002808          ADD      r8,r0,r8,LSL #8
;;;155    	
;;;156    	ecuId = ptr[offset++];          //得到ECU ID
000094  4628              MOV      r0,r5
000096  1c69              ADDS     r1,r5,#1
000098  b28d              UXTH     r5,r1
00009a  5c26              LDRB     r6,[r4,r0]
;;;157    	ecuId = (ecuId << 8) + ptr[offset++];
00009c  4628              MOV      r0,r5
00009e  1c69              ADDS     r1,r5,#1
0000a0  b28d              UXTH     r5,r1
0000a2  5c20              LDRB     r0,[r4,r0]
0000a4  eb002606          ADD      r6,r0,r6,LSL #8
;;;158    	ecuId = (ecuId << 8) + ptr[offset++];
0000a8  4628              MOV      r0,r5
0000aa  1c69              ADDS     r1,r5,#1
0000ac  b28d              UXTH     r5,r1
0000ae  5c20              LDRB     r0,[r4,r0]
0000b0  eb002606          ADD      r6,r0,r6,LSL #8
;;;159    	ecuId = (ecuId << 8) + ptr[offset++];
0000b4  4628              MOV      r0,r5
0000b6  1c69              ADDS     r1,r5,#1
0000b8  b28d              UXTH     r5,r1
0000ba  5c20              LDRB     r0,[r4,r0]
0000bc  eb002606          ADD      r6,r0,r6,LSL #8
;;;160    	
;;;161    	ipLen = ptr[offset++];               //得到IP长度
0000c0  4628              MOV      r0,r5
0000c2  1c69              ADDS     r1,r5,#1
0000c4  b28d              UXTH     r5,r1
0000c6  5c20              LDRB     r0,[r4,r0]
0000c8  9000              STR      r0,[sp,#0]
;;;162    	memset(varOperation.newIP_Addr,0,18);//清零
0000ca  2112              MOVS     r1,#0x12
0000cc  4839              LDR      r0,|L9.436|
0000ce  f7fffffe          BL       __aeabi_memclr
;;;163    	memcpy(varOperation.newIP_Addr,&ptr[offset],ipLen); //得到IP地址
0000d2  1961              ADDS     r1,r4,r5
0000d4  f89d2000          LDRB     r2,[sp,#0]
0000d8  4836              LDR      r0,|L9.436|
0000da  f7fffffe          BL       __aeabi_memcpy
;;;164    	
;;;165    	varOperation.newIP_Potr = ptr[offset + ipLen];      //得到端口号
0000de  f89d0000          LDRB     r0,[sp,#0]
0000e2  4428              ADD      r0,r0,r5
0000e4  5c20              LDRB     r0,[r4,r0]
0000e6  4933              LDR      r1,|L9.436|
0000e8  3946              SUBS     r1,r1,#0x46
0000ea  f8a10058          STRH     r0,[r1,#0x58]
;;;166    	varOperation.newIP_Potr = (varOperation.newIP_Potr << 8) + ptr[offset + ipLen + 1];
0000ee  f89d0000          LDRB     r0,[sp,#0]
0000f2  4428              ADD      r0,r0,r5
0000f4  1c40              ADDS     r0,r0,#1
0000f6  5c20              LDRB     r0,[r4,r0]
0000f8  f8911058          LDRB     r1,[r1,#0x58]  ; varOperation
0000fc  eb002001          ADD      r0,r0,r1,LSL #8
000100  492c              LDR      r1,|L9.436|
000102  3946              SUBS     r1,r1,#0x46
000104  f8a10058          STRH     r0,[r1,#0x58]
;;;167    	
;;;168    	varOperation.oilMode = ptr[offset + ipLen + 2];
000108  f89d0000          LDRB     r0,[sp,#0]
00010c  4428              ADD      r0,r0,r5
00010e  1c80              ADDS     r0,r0,#2
000110  5c20              LDRB     r0,[r4,r0]
000112  b240              SXTB     r0,r0
000114  f8810098          STRB     r0,[r1,#0x98]
;;;169    	strengthFuel.coe = ptr[offset + ipLen + 2];
000118  f89d0000          LDRB     r0,[sp,#0]
00011c  4428              ADD      r0,r0,r5
00011e  1c80              ADDS     r0,r0,#2
000120  5c20              LDRB     r0,[r4,r0]
000122  b240              SXTB     r0,r0
000124  4924              LDR      r1,|L9.440|
000126  7648              STRB     r0,[r1,#0x19]
;;;170    	if(softVersion != sysUpdateVar.curSoftVer) //先考虑OTA升级
000128  4824              LDR      r0,|L9.444|
00012a  8840              LDRH     r0,[r0,#2]  ; sysUpdateVar
00012c  4540              CMP      r0,r8
00012e  d014              BEQ      |L9.346|
;;;171    	{
;;;172    		varOperation.newSoftVersion = softVersion;
000130  4820              LDR      r0,|L9.436|
000132  3846              SUBS     r0,r0,#0x46
000134  f8c08000          STR      r8,[r0,#0]  ; varOperation
;;;173    		OSSemPend(sendMsg,100,&ipLen);         //等待200ms  确保CDMA当前没有发送数据
000138  466a              MOV      r2,sp
00013a  2164              MOVS     r1,#0x64
00013c  4820              LDR      r0,|L9.448|
00013e  6800              LDR      r0,[r0,#0]  ; sendMsg
000140  f7fffffe          BL       OSSemPend
;;;174    		varOperation.isDataFlow     = 1;       // OTA进行升级 停止数据流，一心只为OTA升级
000144  2001              MOVS     r0,#1
000146  491b              LDR      r1,|L9.436|
000148  3946              SUBS     r1,r1,#0x46
00014a  f881002d          STRB     r0,[r1,#0x2d]
;;;175    		sysUpdateVar.isSoftUpdate   = 1;  
00014e  491b              LDR      r1,|L9.444|
000150  7008              STRB     r0,[r1,#0]
;;;176    		
;;;177    		SendFrameNum(0x8000);                  //发送0x8000以请求程序文件大小以及CRC校验
000152  03c0              LSLS     r0,r0,#15
000154  f7fffffe          BL       SendFrameNum
000158  e026              B        |L9.424|
                  |L9.346|
;;;178    	}
;;;179    	else if(ecuId != canDataConfig.pidVersion && sysUpdateVar.isSoftUpdate ==0)  //再考虑配置文件升级
00015a  481a              LDR      r0,|L9.452|
00015c  6800              LDR      r0,[r0,#0]  ; canDataConfig
00015e  42b0              CMP      r0,r6
000160  d014              BEQ      |L9.396|
000162  4816              LDR      r0,|L9.444|
000164  7800              LDRB     r0,[r0,#0]  ; sysUpdateVar
000166  b988              CBNZ     r0,|L9.396|
;;;180    	{
;;;181    		varOperation.newPIDVersion = ecuId;
000168  4812              LDR      r0,|L9.436|
00016a  3846              SUBS     r0,r0,#0x46
00016c  f8c0607e          STR      r6,[r0,#0x7e]  ; varOperation
;;;182    		OSSemPend(sendMsg,100,&ipLen);    //等待200ms  确保 CDMA 当前没有发送数据
000170  466a              MOV      r2,sp
000172  2164              MOVS     r1,#0x64
000174  4812              LDR      r0,|L9.448|
000176  6800              LDR      r0,[r0,#0]  ; sendMsg
000178  f7fffffe          BL       OSSemPend
;;;183    		varOperation.isDataFlow     = 1;  //配置文件升级，停止数据流，一心只为配置
00017c  2001              MOVS     r0,#1
00017e  490d              LDR      r1,|L9.436|
000180  3946              SUBS     r1,r1,#0x46
000182  f881002d          STRB     r0,[r1,#0x2d]
;;;184    		
;;;185    		GetConfigInfo();                  //请求配置文件 - 发送 0x4000 及版本信息
000186  f7fffffe          BL       GetConfigInfo
00018a  e00d              B        |L9.424|
                  |L9.396|
;;;186    	}
;;;187    	else 
;;;188    	{
;;;189    		varOperation.isLoginDeal = 1;     //没有登录报文需要处理
00018c  2001              MOVS     r0,#1
00018e  4909              LDR      r1,|L9.436|
000190  3946              SUBS     r1,r1,#0x46
000192  f8810030          STRB     r0,[r1,#0x30]
;;;190    		if(OSSemAccept(LoginMes) == 0)
000196  480c              LDR      r0,|L9.456|
000198  6800              LDR      r0,[r0,#0]  ; LoginMes
00019a  f7fffffe          BL       OSSemAccept
00019e  b918              CBNZ     r0,|L9.424|
;;;191    			OSSemPost(LoginMes);
0001a0  4809              LDR      r0,|L9.456|
0001a2  6800              LDR      r0,[r0,#0]  ; LoginMes
0001a4  f7fffffe          BL       OSSemPost
                  |L9.424|
;;;192    	}
;;;193    //	todo:IP更改，后期会有需要
;;;194    //	isIpEqual = strcmp(varOperation.ipAddr,varOperation.newIP_Addr);//比较IP是否相等  = 0 - 相等
;;;195    //	if((varOperation.newIP_Potr != varOperation.ipPotr) || (isIpEqual != 0))//端口号不相等或者IP地址不相等
;;;196    //	{
;;;197    //		memset(varOperation.ipAddr,0,18);//将原始IP清零
;;;198    //		memcpy(varOperation.ipAddr,varOperation.newIP_Addr,18);//新IP
;;;199    //		varOperation.ipPotr = varOperation.newIP_Potr;         //新端口
;;;200    //		varOperation.isDataFlow = 1; //停止数据流
;;;201    //		OSSemPend(sendMsg,0,&ipLen);//等待CDMA发送空闲，不能在其发送数据的时候，重新TCP连接
;;;202    //		
;;;203    //		CDMASendCmd((const uint8_t*)"AT+ZIPCLOSE=0\r","ZIPCLOSE",sizeof("AT+ZIPCLOSE=0\r"));//关闭TCP连接
;;;204    //	}
;;;205    }
0001a8  e8bd83f8          POP      {r3-r9,pc}
;;;206    static void SendFrameNum(uint16_t frameNum)
                          ENDP

                  |L9.428|
                          DCD      timetemp
                  |L9.432|
                          DCD      carAllRecord
                  |L9.436|
                          DCD      varOperation+0x46
                  |L9.440|
                          DCD      strengthFuel
                  |L9.444|
                          DCD      sysUpdateVar
                  |L9.448|
                          DCD      sendMsg
                  |L9.452|
                          DCD      canDataConfig
                  |L9.456|
                          DCD      LoginMes

                          AREA ||i.SendConfigNum||, CODE, READONLY, ALIGN=2

                  SendConfigNum PROC
;;;317    }
;;;318    static void SendConfigNum(uint16_t cmd)
000000  b570              PUSH     {r4-r6,lr}
;;;319    {
000002  4605              MOV      r5,r0
;;;320    	_CDMADataToSend* otaUpdatSend;
;;;321    	otaUpdatSend = CDMNSendInfoInit(60);//升级请求帧
000004  203c              MOVS     r0,#0x3c
000006  f7fffffe          BL       CDMNSendInfoInit
00000a  4604              MOV      r4,r0
;;;322    
;;;323    	otaUpdatSend->data[otaUpdatSend->datLength++] = 7;   //长度
00000c  2107              MOVS     r1,#7
00000e  8822              LDRH     r2,[r4,#0]
000010  1c50              ADDS     r0,r2,#1
000012  8020              STRH     r0,[r4,#0]
000014  6860              LDR      r0,[r4,#4]
000016  5481              STRB     r1,[r0,r2]
;;;324    	otaUpdatSend->data[otaUpdatSend->datLength++] = (cmd>>8) &0x00FF;
000018  0a29              LSRS     r1,r5,#8
00001a  8822              LDRH     r2,[r4,#0]
00001c  1c50              ADDS     r0,r2,#1
00001e  8020              STRH     r0,[r4,#0]
000020  6860              LDR      r0,[r4,#4]
000022  5481              STRB     r1,[r0,r2]
;;;325    	otaUpdatSend->data[otaUpdatSend->datLength++] = cmd &0x00FF;
000024  8822              LDRH     r2,[r4,#0]
000026  1c50              ADDS     r0,r2,#1
000028  8020              STRH     r0,[r4,#0]
00002a  6860              LDR      r0,[r4,#4]
00002c  5485              STRB     r5,[r0,r2]
;;;326    	//请求升级的版本
;;;327    	otaUpdatSend->data[otaUpdatSend->datLength++] = (varOperation.newPIDVersion >> 24) & 0x00FF;
00002e  4817              LDR      r0,|L10.140|
000030  f8d0007e          LDR      r0,[r0,#0x7e]  ; varOperation
000034  0e00              LSRS     r0,r0,#24
000036  8822              LDRH     r2,[r4,#0]
000038  1c51              ADDS     r1,r2,#1
00003a  8021              STRH     r1,[r4,#0]
00003c  6861              LDR      r1,[r4,#4]
00003e  5488              STRB     r0,[r1,r2]
;;;328    	otaUpdatSend->data[otaUpdatSend->datLength++] = (varOperation.newPIDVersion >> 16) & 0x00FF;
000040  4812              LDR      r0,|L10.140|
000042  f8d0007e          LDR      r0,[r0,#0x7e]  ; varOperation
000046  f3c04107          UBFX     r1,r0,#16,#8
00004a  8822              LDRH     r2,[r4,#0]
00004c  1c50              ADDS     r0,r2,#1
00004e  8020              STRH     r0,[r4,#0]
000050  6860              LDR      r0,[r4,#4]
000052  5481              STRB     r1,[r0,r2]
;;;329    	otaUpdatSend->data[otaUpdatSend->datLength++] = (varOperation.newPIDVersion >> 8) & 0x00FF;
000054  480d              LDR      r0,|L10.140|
000056  f8b0007e          LDRH     r0,[r0,#0x7e]  ; varOperation
00005a  f3c02107          UBFX     r1,r0,#8,#8
00005e  8822              LDRH     r2,[r4,#0]
000060  1c50              ADDS     r0,r2,#1
000062  8020              STRH     r0,[r4,#0]
000064  6860              LDR      r0,[r4,#4]
000066  5481              STRB     r1,[r0,r2]
;;;330    	otaUpdatSend->data[otaUpdatSend->datLength++] = varOperation.newPIDVersion & 0x00FF;
000068  4808              LDR      r0,|L10.140|
00006a  f890107e          LDRB     r1,[r0,#0x7e]  ; varOperation
00006e  8822              LDRH     r2,[r4,#0]
000070  1c50              ADDS     r0,r2,#1
000072  8020              STRH     r0,[r4,#0]
000074  6860              LDR      r0,[r4,#4]
000076  5481              STRB     r1,[r0,r2]
;;;331    	
;;;332    	CDMASendDataPack(otaUpdatSend);//将请求包进行封包
000078  4620              MOV      r0,r4
00007a  f7fffffe          BL       CDMASendDataPack
;;;333    	
;;;334    	OSQPost(CDMASendQ,otaUpdatSend);
00007e  4621              MOV      r1,r4
000080  4803              LDR      r0,|L10.144|
000082  6800              LDR      r0,[r0,#0]  ; CDMASendQ
000084  f7fffffe          BL       OSQPost
;;;335    }
000088  bd70              POP      {r4-r6,pc}
;;;336    static void ConfigUpdata(uint8_t* ptrDeal )
                          ENDP

00008a  0000              DCW      0x0000
                  |L10.140|
                          DCD      varOperation
                  |L10.144|
                          DCD      CDMASendQ

                          AREA ||i.SendFrameNum||, CODE, READONLY, ALIGN=2

                  SendFrameNum PROC
;;;205    }
;;;206    static void SendFrameNum(uint16_t frameNum)
000000  b570              PUSH     {r4-r6,lr}
;;;207    {
000002  4605              MOV      r5,r0
;;;208    	_CDMADataToSend* otaUpdatSend;
;;;209    	otaUpdatSend = CDMNSendInfoInit(60);//
000004  203c              MOVS     r0,#0x3c
000006  f7fffffe          BL       CDMNSendInfoInit
00000a  4604              MOV      r4,r0
;;;210    	otaUpdatSend->data[otaUpdatSend->datLength++] =  3;     //长度
00000c  2103              MOVS     r1,#3
00000e  8822              LDRH     r2,[r4,#0]
000010  1c50              ADDS     r0,r2,#1
000012  8020              STRH     r0,[r4,#0]
000014  6860              LDR      r0,[r4,#4]
000016  5481              STRB     r1,[r0,r2]
;;;211    	otaUpdatSend->data[otaUpdatSend->datLength++] = (frameNum >> 8) &0x00FF;
000018  0a29              LSRS     r1,r5,#8
00001a  8822              LDRH     r2,[r4,#0]
00001c  1c50              ADDS     r0,r2,#1
00001e  8020              STRH     r0,[r4,#0]
000020  6860              LDR      r0,[r4,#4]
000022  5481              STRB     r1,[r0,r2]
;;;212    	otaUpdatSend->data[otaUpdatSend->datLength++] = frameNum & 0x00FF;
000024  8822              LDRH     r2,[r4,#0]
000026  1c50              ADDS     r0,r2,#1
000028  8020              STRH     r0,[r4,#0]
00002a  6860              LDR      r0,[r4,#4]
00002c  5485              STRB     r5,[r0,r2]
;;;213    	
;;;214    	CDMASendDataPack(otaUpdatSend);//将程序请求帧进行封包
00002e  4620              MOV      r0,r4
000030  f7fffffe          BL       CDMASendDataPack
;;;215    	
;;;216    	OSQPost(CDMASendQ,otaUpdatSend);
000034  4621              MOV      r1,r4
000036  4802              LDR      r0,|L11.64|
000038  6800              LDR      r0,[r0,#0]  ; CDMASendQ
00003a  f7fffffe          BL       OSQPost
;;;217    }
00003e  bd70              POP      {r4-r6,pc}
;;;218    uint8_t updateBuff[2048];       //升级用
                          ENDP

                  |L11.64|
                          DCD      CDMASendQ

                          AREA ||i.SendPidCmdData||, CODE, READONLY, ALIGN=2

                  SendPidCmdData PROC
;;;110    
;;;538    void SendPidCmdData(uint8_t* cmdData)
000000  b570              PUSH     {r4-r6,lr}
;;;539    {
000002  4605              MOV      r5,r0
;;;540    	_CDMADataToSend* cmdPidSend;
;;;541    	cmdPidSend = CDMNSendInfoInit(60);//
000004  203c              MOVS     r0,#0x3c
000006  f7fffffe          BL       CDMNSendInfoInit
00000a  4604              MOV      r4,r0
;;;542    	memcpy(&cmdPidSend->data[cmdPidSend->datLength],cmdData,cmdData[0]);
00000c  6861              LDR      r1,[r4,#4]
00000e  8823              LDRH     r3,[r4,#0]
000010  18c8              ADDS     r0,r1,r3
000012  782a              LDRB     r2,[r5,#0]
000014  4629              MOV      r1,r5
000016  f7fffffe          BL       __aeabi_memcpy
;;;543    	cmdPidSend->datLength += cmdData[0];
00001a  8820              LDRH     r0,[r4,#0]
00001c  7829              LDRB     r1,[r5,#0]
00001e  4408              ADD      r0,r0,r1
000020  8020              STRH     r0,[r4,#0]
;;;544    
;;;545    	CDMASendDataPack(cmdPidSend);     //将程序请求帧进行封包
000022  4620              MOV      r0,r4
000024  f7fffffe          BL       CDMASendDataPack
;;;546    	
;;;547    	OSQPost(CDMASendQ,cmdPidSend);
000028  4621              MOV      r1,r4
00002a  4804              LDR      r0,|L12.60|
00002c  6800              LDR      r0,[r0,#0]  ; CDMASendQ
00002e  f7fffffe          BL       OSQPost
;;;548    	Mem_free(cmdData);
000032  4628              MOV      r0,r5
000034  f7fffffe          BL       Mem_free
;;;549    }
000038  bd70              POP      {r4-r6,pc}
;;;550    extern uint8_t pidManyBag[8];
                          ENDP

00003a  0000              DCW      0x0000
                  |L12.60|
                          DCD      CDMASendQ

                          AREA ||i.__NVIC_SystemReset||, CODE, READONLY, ALIGN=2

                  __NVIC_SystemReset PROC
;;;1750    */
;;;1751   __STATIC_INLINE void __NVIC_SystemReset(void)
000000  bf00              NOP      
;;;1752   {
;;;1753     __DSB();                                                          /* Ensure all outstanding memory accesses included
000002  bf00              NOP      
000004  bf00              NOP      
000006  f3bf8f4f          DSB      
00000a  bf00              NOP      
00000c  bf00              NOP      
00000e  bf00              NOP      
;;;1754                                                                          buffered write are completed before reset */
;;;1755     SCB->AIRCR  = (uint32_t)((0x5FAUL << SCB_AIRCR_VECTKEY_Pos)    |
000010  4809              LDR      r0,|L13.56|
000012  6800              LDR      r0,[r0,#0]
000014  f40060e0          AND      r0,r0,#0x700
000018  4908              LDR      r1,|L13.60|
00001a  4308              ORRS     r0,r0,r1
00001c  1d00              ADDS     r0,r0,#4
00001e  4906              LDR      r1,|L13.56|
000020  6008              STR      r0,[r1,#0]
;;;1756                              (SCB->AIRCR & SCB_AIRCR_PRIGROUP_Msk) |
;;;1757                               SCB_AIRCR_SYSRESETREQ_Msk    );         /* Keep priority group unchanged */
;;;1758     __DSB();                                                          /* Ensure completion of memory access */
000022  bf00              NOP      
000024  bf00              NOP      
000026  bf00              NOP      
000028  f3bf8f4f          DSB      
00002c  bf00              NOP      
00002e  bf00              NOP      
000030  bf00              NOP      
;;;1759   
;;;1760     for(;;)                                                           /* wait until reset */
000032  bf00              NOP      
                  |L13.52|
;;;1761     {
;;;1762       __NOP();
000034  bf00              NOP      
000036  e7fd              B        |L13.52|
;;;1763     }
;;;1764   }
;;;1765   
                          ENDP

                  |L13.56|
                          DCD      0xe000ed0c
                  |L13.60|
                          DCD      0x05fa0000

                          AREA ||.bss||, DATA, NOINIT, ALIGN=0

                  updateBuff
                          %        2048

                          AREA ||.data||, DATA, ALIGN=2

                  timetemp
000000  0000              DCB      0x00,0x00
                  currentNum
000002  0000              DCW      0x0000
                  fileCRC
000004  0000              DCW      0x0000
000006  0000              DCB      0x00,0x00
                  flashAddr
                          DCD      0x00000000
                  frameIndex
00000c  0000              DCB      0x00,0x00
                  |symbol_number.51|
00000e  0000              DCW      0x0000
                  |symbol_number.52|
000010  0000              DCW      0x0000
                  pidPackNum
000012  0000              DCB      0x00,0x00
                  addrSavePid
                          DCD      0x00000000

;*** Start embedded assembler ***

#line 1 "..\\CDMA\\CDMARecvTask.c"
	AREA ||.rev16_text||, CODE
	THUMB
	EXPORT |__asm___14_CDMARecvTask_c_1d630633____REV16|
#line 465 "D:\\Keil_v5\\ARM\\PACK\\ARM\\CMSIS\\5.2.0\\CMSIS\\Include\\cmsis_armcc.h"
|__asm___14_CDMARecvTask_c_1d630633____REV16| PROC
#line 466

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE
	THUMB
	EXPORT |__asm___14_CDMARecvTask_c_1d630633____REVSH|
#line 480
|__asm___14_CDMARecvTask_c_1d630633____REVSH| PROC
#line 481

 revsh r0, r0
 bx lr
	ENDP
	AREA ||.rrx_text||, CODE
	THUMB
	EXPORT |__asm___14_CDMARecvTask_c_1d630633____RRX|
#line 667
|__asm___14_CDMARecvTask_c_1d630633____RRX| PROC
#line 668

 rrx r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
